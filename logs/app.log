2025-03-21 03:24:10,438 - app.main - INFO - Application startup: initializing services and connections
2025-03-21 03:29:32,147 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-21 03:29:59,538 - app.main - INFO - Application startup: initializing services and connections
2025-03-21 03:35:22,749 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-21 03:35:50,336 - app.main - INFO - Application startup: initializing services and connections
2025-03-21 03:35:50,399 - app.api.endpoints.embed - INFO - Received embedding request for text: This is a test embedding...
2025-03-21 03:35:51,279 - app.api.endpoints.embed - INFO - Embedding generated successfully
2025-03-21 06:27:15,458 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-21 06:27:42,039 - app.main - INFO - Application startup: initializing services and connections
2025-03-21 06:27:42,044 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-21 06:29:16,560 - app.main - INFO - Application startup: initializing services and connections
2025-03-21 06:29:37,863 - app.api.endpoints.rag_query - INFO - Received RAG query: test question...
2025-03-21 06:29:37,869 - app.core.rag - INFO - Processing RAG query: test question...
2025-03-21 06:29:38,290 - app.core.retrieval - INFO - Generated embedding for query: 'test question...'
2025-03-21 06:29:38,293 - app.core.clients - INFO - Initializing Pinecone client
2025-03-21 06:29:38,297 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-21 06:29:40,557 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-21 06:29:40,560 - app.core.rag - INFO - Reranking results (placeholder)
2025-03-21 06:29:40,565 - app.core.rag - INFO - RAG response generated successfully
2025-03-21 06:30:12,461 - app.api.endpoints.rag_query - INFO - Received RAG query: hey...
2025-03-21 06:30:12,471 - app.core.rag - INFO - Processing RAG query: hey...
2025-03-21 06:30:12,813 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-21 06:30:12,815 - app.core.clients - INFO - Initializing Pinecone client
2025-03-21 06:30:12,819 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-21 06:30:14,000 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-21 06:30:14,006 - app.core.rag - INFO - Reranking results (placeholder)
2025-03-21 06:30:14,010 - app.core.rag - INFO - RAG response generated successfully
2025-03-21 06:30:56,878 - app.api.endpoints.rag_query - INFO - Received RAG query: how are you...
2025-03-21 06:30:56,886 - app.core.rag - INFO - Processing RAG query: how are you...
2025-03-21 06:30:57,081 - app.core.retrieval - INFO - Generated embedding for query: 'how are you...'
2025-03-21 06:30:57,082 - app.core.clients - INFO - Initializing Pinecone client
2025-03-21 06:30:57,086 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-21 06:30:57,987 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-21 06:30:57,993 - app.core.rag - INFO - Reranking results (placeholder)
2025-03-21 06:30:57,997 - app.core.rag - INFO - RAG response generated successfully
2025-03-21 23:20:08,259 - app.main - INFO - Application startup: initializing services and connections
2025-03-21 23:20:50,515 - app.api.endpoints.embed - INFO - Received embedding request for text: This is a test embedding...
2025-03-21 23:20:50,890 - app.api.endpoints.embed - INFO - Embedding generated successfully
2025-03-21 23:22:09,091 - app.api.endpoints.embed - INFO - Received embedding request for text: This is a test embedding...
2025-03-21 23:22:09,488 - app.api.endpoints.embed - INFO - Embedding generated successfully
2025-03-21 23:22:26,070 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-21 23:24:17,157 - app.main - INFO - Application startup: initializing services and connections
2025-03-21 23:46:47,781 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:17:48,457 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:18:00,175 - app.main - ERROR - Request failed: object dict can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 59, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/auth.py", line 28, in register
    result = await appwrite_users.create(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
TypeError: object dict can't be used in 'await' expression

2025-03-25 00:18:26,957 - app.main - ERROR - Request failed: 'Account' object has no attribute 'create_email_session'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 59, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/auth.py", line 41, in login
    session = await appwrite_account.create_email_session(user.email, user.password)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Account' object has no attribute 'create_email_session'. Did you mean: 'create_email_token'?

2025-03-25 00:18:33,437 - app.main - ERROR - Request failed: 'Account' object has no attribute 'create_email_session'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 59, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/auth.py", line 41, in login
    session = await appwrite_account.create_email_session(user.email, user.password)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Account' object has no attribute 'create_email_session'. Did you mean: 'create_email_token'?

2025-03-25 00:19:19,320 - app.main - ERROR - Request failed: object dict can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 59, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/auth.py", line 28, in register
    result = await appwrite_users.create(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
TypeError: object dict can't be used in 'await' expression

2025-03-25 00:21:36,788 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:21:58,072 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:23:32,249 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:23:52,888 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:26:44,913 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:26:59,188 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:34:05,693 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:34:49,049 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:35:16,490 - app.api.endpoints.auth - ERROR - Unexpected login error: 'Account' object has no attribute 'create_email_session'
2025-03-25 00:35:31,856 - app.api.endpoints.auth - ERROR - Appwrite registration error: A user with the same id, email, or phone already exists in this project.
2025-03-25 00:35:39,695 - app.api.endpoints.auth - ERROR - Unexpected login error: 'Account' object has no attribute 'create_email_session'
2025-03-25 00:37:52,589 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:42:30,752 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:43:56,911 - app.api.endpoints.auth - ERROR - Unexpected login error: Account.create_session() got an unexpected keyword argument 'email'
2025-03-25 00:46:08,998 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:46:23,573 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:48:01,288 - app.api.endpoints.auth - INFO - create_session signature: (user_id: str, secret: str)
2025-03-25 00:48:01,532 - app.api.endpoints.auth - ERROR - Login error: Invalid `userId` param: Parameter must contain at most 36 chars. Valid chars are a-z, A-Z, 0-9, period, hyphen, and underscore. Can't start with a special char
2025-03-25 00:49:58,840 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:50:15,113 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:50:37,886 - app.api.endpoints.auth - ERROR - Appwrite login error: Invalid `queries` param: Invalid query: Invalid query: Syntax error
2025-03-25 00:51:41,387 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:51:55,702 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:53:10,255 - app.api.endpoints.auth - ERROR - Appwrite login error: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-03-25 00:53:22,586 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:53:51,715 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:55:59,962 - app.api.endpoints.auth - ERROR - Login error: 'Settings' object has no attribute 'SECRET_KEY'
2025-03-25 00:56:16,926 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:56:32,142 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 00:56:45,540 - app.api.endpoints.auth - ERROR - Appwrite login error: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-03-25 00:56:47,364 - app.api.endpoints.auth - ERROR - Fallback login error: 'Settings' object has no attribute 'SECRET_KEY'
2025-03-25 00:56:54,303 - app.api.endpoints.auth - ERROR - Appwrite login error: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-03-25 00:56:54,581 - app.api.endpoints.auth - ERROR - Fallback login error: 'Settings' object has no attribute 'SECRET_KEY'
2025-03-25 00:57:47,144 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 00:58:04,671 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:12:53,634 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:13:09,011 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:16:51,078 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:17:06,158 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:18:50,038 - app.api.dependencies - INFO - Attempting to get session with token: 67e20...
2025-03-25 01:18:50,039 - app.api.dependencies - ERROR - Failed to get session: Account.get_session() got an unexpected keyword argument 'sessionId'. Did you mean 'session_id'?
2025-03-25 01:18:50,242 - app.api.dependencies - ERROR - Authentication failed: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-03-25 01:18:18,834 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:18:36,443 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:19:47,820 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:20:03,557 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:29:30,710 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:29:48,042 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:30:02,575 - app.api.endpoints.auth - ERROR - Login error: Invalid `queries` param: Invalid query: Invalid query: Syntax error
2025-03-25 01:30:02,576 - app.api.endpoints.auth - ERROR - Login error: 401: Invalid credentials
2025-03-25 01:32:53,117 - app.api.endpoints.auth - ERROR - Login error: Invalid `queries` param: Invalid query: Invalid query: Syntax error
2025-03-25 01:32:53,118 - app.api.endpoints.auth - ERROR - Login error: 401: Invalid credentials
2025-03-25 01:33:02,507 - app.api.endpoints.auth - ERROR - Login error: Invalid `queries` param: Invalid query: Invalid query: Syntax error
2025-03-25 01:33:02,508 - app.api.endpoints.auth - ERROR - Login error: 401: Invalid credentials
2025-03-25 01:33:17,462 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:34:15,325 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:34:23,718 - app.api.endpoints.auth - ERROR - Login error: Invalid `queries` param: Invalid query: Invalid query: Syntax error
2025-03-25 01:34:23,719 - app.api.endpoints.auth - ERROR - Login error: 401: Invalid credentials
2025-03-25 01:35:10,065 - app.api.endpoints.auth - ERROR - Login error: Invalid `queries` param: Invalid query: Invalid query: Syntax error
2025-03-25 01:35:10,065 - app.api.endpoints.auth - ERROR - Login error: 401: Invalid credentials
2025-03-25 01:35:37,913 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:35:54,298 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:41:36,217 - app.core.chat_service - ERROR - Failed to create conversation: object dict can't be used in 'await' expression
2025-03-25 01:42:47,237 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:43:01,406 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:44:12,958 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:47:36,939 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:48:38,218 - app.core.chat_service - ERROR - Failed to create conversation: Invalid document structure: Unknown attribute: "updated_at"
2025-03-25 01:53:15,104 - app.core.chat_service - ERROR - Failed to create conversation: Invalid document structure: Unknown attribute: "updated_at"
2025-03-25 01:53:20,334 - app.core.chat_service - ERROR - Failed to create conversation: Invalid document structure: Unknown attribute: "updated_at"
2025-03-25 01:53:21,931 - app.core.chat_service - ERROR - Failed to create conversation: Invalid document structure: Unknown attribute: "updated_at"
2025-03-25 01:53:56,936 - app.core.chat_service - ERROR - Failed to create conversation: Invalid document structure: Unknown attribute: "updated_at"
2025-03-25 01:55:09,051 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 01:54:23,534 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 01:57:03,209 - app.core.rag - INFO - Processing RAG query: Tell me about Arabia...
2025-03-25 01:57:03,853 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Arabia...'
2025-03-25 01:57:03,853 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 01:57:03,857 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 01:57:06,065 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 01:57:06,066 - app.core.rag - INFO - Reranking results (placeholder)
2025-03-25 01:57:06,067 - app.core.rag - INFO - RAG response generated successfully
2025-03-25 02:02:31,973 - app.core.rag - INFO - Processing RAG query: Tell me about Arabia...
2025-03-25 02:02:32,518 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Arabia...'
2025-03-25 02:02:32,519 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 02:02:32,522 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 02:02:33,617 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 02:02:33,619 - app.core.rag - INFO - Reranking results (placeholder)
2025-03-25 02:02:33,620 - app.core.rag - INFO - RAG response generated successfully
2025-03-25 02:08:35,319 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 03:10:33,012 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 03:12:28,977 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Arabia...'
2025-03-25 03:12:28,978 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 03:12:28,981 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 03:12:29,965 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 03:12:29,966 - app.core.chat_service - ERROR - Error in RAG pipeline: 'DocumentMatch' object has no attribute 'text_snippet'
2025-03-25 03:15:31,596 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 03:15:46,958 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 03:20:57,343 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 03:21:12,273 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 03:29:07,355 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 03:28:33,433 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 03:29:59,730 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 03:30:17,750 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 03:31:19,238 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 03:31:34,430 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 03:36:38,281 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 05:44:09,591 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 05:46:31,189 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Arabia...'
2025-03-25 05:46:31,191 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 05:46:31,194 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 05:46:32,809 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 05:50:27,313 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about fiqh...'
2025-03-25 05:50:27,314 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 05:50:27,316 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 05:50:28,230 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 05:49:37,561 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 05:49:54,361 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 05:52:08,983 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:10:38,181 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:29:09,074 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:29:27,849 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:30:34,658 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:30:48,524 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:33:06,496 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:39:10,078 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:41:21,443 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:40:37,049 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:42:51,213 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:45:09,556 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:47:54,419 - app.api.endpoints.auth - INFO - Created anonymous session: anon_327a7ded651e328c
2025-03-25 17:49:45,510 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Arabia...'
2025-03-25 17:49:45,512 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 17:49:45,515 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 17:49:49,119 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 17:49:49,343 - app.core.chat_service - ERROR - API Error: 400 - {"object":"error","message":"Invalid model: mistral-sabaa","type":"invalid_model","param":null,"code":"1500"}
2025-03-25 17:49:19,861 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about fiqh...'
2025-03-25 17:49:19,862 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 17:49:19,866 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 17:49:20,369 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 17:49:20,580 - app.core.chat_service - ERROR - API Error: 400 - {"object":"error","message":"Invalid model: mistral-sabaa","type":"invalid_model","param":null,"code":"1500"}
2025-03-25 17:51:55,392 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:52:09,476 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:53:15,279 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:53:39,493 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:55:17,155 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:56:36,577 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:57:52,259 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:58:08,072 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:58:26,692 - app.api.endpoints.auth - INFO - Created anonymous session: anon_fb2d05c34cb684a5
2025-03-25 17:59:00,336 - app.main - ERROR - Request failed: 'coroutine' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 63, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 21, in send_message
    is_anonymous = user.get("is_anonymous", False)
                   ^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'

2025-03-25 17:59:13,175 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 17:59:27,516 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 17:59:27,642 - app.main - ERROR - Request failed: 'coroutine' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 63, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 21, in send_message
    is_anonymous = user.get("is_anonymous", False)
                   ^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'

2025-03-25 18:02:03,948 - app.main - ERROR - Request failed: 'coroutine' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 63, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 21, in send_message
    is_anonymous = user.get("is_anonymous", False)
                   ^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'

2025-03-25 18:02:34,579 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 18:02:49,967 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 18:02:50,093 - app.main - ERROR - Request failed: 'coroutine' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 63, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 21, in send_message
    is_anonymous = user.get("is_anonymous", False)
                   ^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'

2025-03-25 18:05:17,386 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-25 18:05:31,557 - app.main - INFO - Application startup: initializing services and connections
2025-03-25 18:09:52,588 - app.core.chat_service - INFO - Anonymous user message, not storing in database
2025-03-25 18:09:53,037 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about fiqh...'
2025-03-25 18:09:53,037 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 18:09:53,040 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 18:09:54,753 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 18:08:56,770 - app.core.chat_service - INFO - Anonymous user message, not storing in database
2025-03-25 22:28:22,049 - app.core.chat_service - INFO - Anonymous user message, not storing in database
2025-03-25 22:28:22,659 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about fiqh...'
2025-03-25 22:28:22,661 - app.core.clients - INFO - Initializing Pinecone client
2025-03-25 22:28:22,698 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-25 22:28:23,862 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-25 22:28:26,989 - app.core.chat_service - INFO - Anonymous user message, not storing in database
2025-03-26 00:58:47,233 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 00:58:47,240 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 00:58:47,297 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 00:58:48,206 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 00:58:48,403 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 00:58:48,578 - app.core.chat_service - ERROR - Failed to store message: Invalid document structure: Unknown attribute: "sources"
2025-03-26 00:58:57,387 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 00:58:57,388 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 00:58:57,391 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 00:58:58,230 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 00:59:06,053 - app.core.chat_service - ERROR - Failed to store message: Invalid document structure: Unknown attribute: "sources"
2025-03-26 01:10:31,962 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 01:10:49,405 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 01:35:55,979 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 01:36:14,441 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 01:36:14,921 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 01:36:14,923 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 01:36:14,926 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 01:36:16,815 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 01:38:34,203 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 01:38:50,705 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 01:38:50,753 - app.api.endpoints.auth - INFO - Created anonymous session: anon_d387e7430af1e011
2025-03-26 01:39:45,033 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence (fiqh)...'
2025-03-26 01:39:45,034 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 01:39:45,038 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 01:39:46,385 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 01:40:58,549 - app.core.retrieval - INFO - Generated embedding for query: 'What are the schools of Islamic thought?...'
2025-03-26 01:40:58,549 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 01:40:58,554 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 01:40:59,343 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 01:42:29,794 - app.api.endpoints.auth - ERROR - Registration error: A user with the same id, email, or phone already exists in this project.
2025-03-26 01:45:53,562 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 01:47:10,061 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 01:54:05,825 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 01:56:46,900 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 01:57:26,285 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 01:57:26,285 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 01:57:26,290 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 01:57:27,878 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 01:57:37,109 - app.core.retrieval - INFO - Generated embedding for query: 'what was my last message...'
2025-03-26 01:57:37,109 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 01:57:37,113 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 01:57:37,893 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 01:57:49,077 - app.core.retrieval - INFO - Generated embedding for query: 'are you sure...'
2025-03-26 01:57:49,077 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 01:57:49,082 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 01:57:49,723 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 01:58:24,810 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:27,092 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:25,748 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:26,313 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:26,842 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:27,294 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:27,757 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:28,290 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:28,730 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:29,241 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:29,755 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:32,103 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:31,128 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 01:58:31,129 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 01:58:31,132 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 01:58:31,939 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 01:58:33,125 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 01:58:33,380 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:33,918 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:34,433 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:34,865 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:35,400 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:36,141 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 01:58:36,142 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 01:58:36,145 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 01:58:37,043 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 01:58:38,146 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 01:58:38,335 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:38,672 - app.core.embeddings - ERROR - Error generating embedding: API error occurred: Status 429
{"message":"Requests rate limit exceeded"}
2025-03-26 01:58:38,672 - app.core.retrieval - ERROR - Failed to generate embedding for query: 'hey'
2025-03-26 01:58:38,673 - app.core.chat_service - WARNING - No relevant documents found for query
2025-03-26 01:58:39,363 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:41,004 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:41,486 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:41,954 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:42,386 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:42,856 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:43,521 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:43,990 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:44,491 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:47,234 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:45,904 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:46,397 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:46,923 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:47,467 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:47,985 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:48,383 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:48,881 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:49,380 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:51,013 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:51,529 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:52,062 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:52,630 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:53,060 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:53,558 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:54,071 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:54,590 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:55,108 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:55,631 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:56,157 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:56,681 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:57,139 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:57,652 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:58,169 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:58,623 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:59,034 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:58:59,594 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:00,101 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:00,538 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:01,052 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:01,611 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:02,065 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:02,634 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:03,172 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:03,739 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:04,364 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:04,850 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 02:00:07,206 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:05,903 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:06,450 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:06,920 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:07,393 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:07,909 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:08,451 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:08,909 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:09,457 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:09,971 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 02:00:12,267 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:10,974 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:11,494 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:12,014 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:12,534 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:13,069 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:13,568 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:14,068 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:14,592 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:15,059 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:15,529 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:16,054 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:17,565 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:18,156 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:19,115 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:19,560 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:19,993 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:20,510 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:21,010 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:21,447 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:21,941 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:22,426 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:22,965 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:23,495 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:24,113 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:24,489 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:25,066 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:25,718 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:26,219 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:26,747 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:27,357 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:27,831 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:28,324 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:28,899 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:29,351 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:29,843 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:30,327 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:30,759 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:31,184 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:31,746 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:32,291 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:32,822 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:33,792 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:34,310 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:34,816 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:35,340 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:35,930 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:36,942 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:37,770 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:38,620 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:39,373 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:41,711 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:42,385 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:43,744 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:44,604 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:45,207 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:45,833 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:46,114 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:46,686 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:47,246 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:47,845 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:48,444 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:48,960 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:49,713 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:49,911 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:50,536 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:50,696 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:52,138 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:53,818 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:53,952 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:54,148 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:54,346 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:55,667 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:55,883 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:56,332 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:56,667 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:57,585 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:57,926 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 01:59:58,381 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 02:00:03,336 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 02:00:03,768 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 02:00:04,342 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 02:00:04,587 - app.core.chat_service - ERROR - Failed to list conversations: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (documents.read)
2025-03-26 02:06:26,317 - app.core.retrieval - INFO - Generated embedding for query: 'What are the schools of Islamic thought?...'
2025-03-26 02:06:26,318 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:06:26,332 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:06:27,645 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:08:00,539 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:01,820 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:02,742 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:03,366 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:08:03,367 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:08:03,417 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:08:08,113 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:08:09,325 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 02:08:09,793 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:10,358 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:10,854 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:11,375 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:11,952 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:12,445 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:13,118 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:13,562 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:14,594 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:15,157 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:15,603 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:16,122 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:16,688 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:17,207 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:17,640 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:18,156 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:18,693 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:19,188 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:19,655 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:20,137 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:20,654 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:21,165 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:21,705 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:22,217 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:22,742 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:23,314 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:24,186 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:24,893 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:25,401 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:25,914 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:26,440 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:27,041 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:27,566 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:28,152 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:28,756 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:29,379 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:29,985 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:30,555 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:31,121 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:31,717 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:32,202 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:32,855 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:33,451 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:34,037 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:35,585 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:36,172 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:36,697 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:37,357 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:38,110 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:38,680 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:39,235 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:39,802 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:40,340 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:08:41,017 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:32,130 - app.core.retrieval - INFO - Generated embedding for query: 'What are the schools of Islamic thought?...'
2025-03-26 02:12:32,132 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:12:32,140 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:12:33,077 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:12:33,355 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:11:46,067 - app.core.retrieval - INFO - Generated embedding for query: 'What are the schools of Islamic thought?...'
2025-03-26 02:11:46,080 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:11:46,112 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:11:50,052 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:12:37,214 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:38,055 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:39,362 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:40,681 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:41,310 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:42,432 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:12:42,447 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:12:42,569 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:12:43,634 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:12:43,830 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:12:44,139 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 02:12:44,653 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:45,129 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:13:47,480 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:46,287 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:46,895 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:47,346 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:47,882 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:48,377 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:48,911 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:49,592 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:50,193 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:51,652 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:52,162 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:52,685 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:53,100 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:53,584 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:54,096 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:54,710 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:55,261 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:55,812 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:56,371 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:56,894 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:57,372 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:57,929 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:58,349 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:58,884 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:59,438 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:12:59,987 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:13:00,561 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:13:01,209 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:13:01,770 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:13:02,333 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:13:02,968 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:13:03,963 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:13:04,583 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:17:05,603 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:16:23,387 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:17:44,713 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:17:59,373 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:19:12,017 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:20:30,249 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:20:30,579 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:31,070 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:31,269 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:31,875 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:32,069 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:32,624 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:32,806 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:33,325 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:33,515 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:34,084 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:34,224 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:33,193 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:33,440 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:34,047 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:34,293 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:34,876 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:35,098 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:35,751 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:35,915 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:36,486 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:36,659 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:37,232 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:37,428 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:38,020 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:38,210 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:38,852 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:39,049 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:39,635 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:19:39,635 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:19:39,638 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:19:40,970 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:19:42,245 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 02:19:43,265 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:43,418 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:44,039 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:44,243 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:44,880 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:45,082 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:45,644 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:45,836 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:46,432 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:46,627 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:47,197 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:47,350 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:49,027 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:50,339 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:50,830 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:53,966 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:54,434 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:54,930 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:55,555 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:56,093 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:19:56,610 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:00,036 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:00,492 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:01,026 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:01,716 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:02,383 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:02,823 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:03,352 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:03,839 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:04,520 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:04,989 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:05,512 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:05,946 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:06,496 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:07,077 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:07,589 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:08,086 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:08,534 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:09,053 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:09,746 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:10,164 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:10,734 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:11,390 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:11,872 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:12,409 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:12,827 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:13,347 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:13,815 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:14,318 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:14,832 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:13,525 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:14,077 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:14,614 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:15,128 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:15,655 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:16,135 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:16,647 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:17,105 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:17,604 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:21:19,808 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:18,432 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:19,214 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:19,728 - app.core.chat_service - ERROR - Failed to list conversations: Invalid query: Syntax error
2025-03-26 02:20:20,992 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:22:33,819 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:22:36,626 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:22:36,627 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:22:36,629 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:22:38,477 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:22:53,326 - app.core.retrieval - INFO - Generated embedding for query: 'nice to meet you...'
2025-03-26 02:22:53,326 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:22:53,329 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:22:53,990 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:22:54,170 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:24:09,834 - app.core.retrieval - INFO - Generated embedding for query: 'nice to meet you...'
2025-03-26 02:24:09,835 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:24:09,837 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:24:10,557 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:24:14,538 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:24:14,539 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:24:14,541 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:24:15,189 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:24:18,377 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:24:18,378 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:24:18,381 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:24:18,995 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:24:19,184 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:23:19,699 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:23:19,700 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:23:19,703 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:23:20,363 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:23:23,941 - app.core.retrieval - INFO - Generated embedding for query: ';nice...'
2025-03-26 02:23:23,942 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:23:23,945 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:23:24,583 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:23:24,846 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:23:27,160 - app.core.retrieval - INFO - Generated embedding for query: 'nice...'
2025-03-26 02:23:27,160 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:23:27,164 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:23:27,855 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:23:35,376 - app.core.retrieval - INFO - Generated embedding for query: 'fiqh...'
2025-03-26 02:23:35,376 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:23:35,379 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:23:36,039 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:23:36,331 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:24:59,851 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:24:59,851 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:24:59,857 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:25:00,838 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:24:05,614 - app.core.retrieval - INFO - Generated embedding for query: 'nice...'
2025-03-26 02:24:05,615 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:24:05,620 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:24:06,397 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:24:20,260 - app.api.endpoints.auth - INFO - Created anonymous session: anon_5ce3a1db32bab5c2
2025-03-26 02:24:25,576 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:24:25,576 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:24:25,579 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:24:26,235 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:24:52,915 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:24:52,915 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:24:52,918 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:24:53,633 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:24:54,762 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 02:25:19,897 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:25:19,897 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:25:19,900 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:25:20,615 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:25:21,753 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 02:25:56,055 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:25:56,055 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:25:56,059 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:25:56,862 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:25:57,935 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 02:26:31,612 - app.core.retrieval - INFO - Generated embedding for query: 'nice...'
2025-03-26 02:26:31,613 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:26:31,623 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:26:32,407 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:27:36,632 - app.core.chat_service - ERROR - Failed to store message: Collection with the requested ID could not be found.
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/message_sources/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 108, in store_message
    appwrite_db.create_document(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        database_id="arabia_db",
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        ]
        ^
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Collection with the requested ID could not be found.
2025-03-26 02:29:50,635 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:30:09,966 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:32:30,514 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:32:46,853 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:35:40,938 - app.api.endpoints.auth - INFO - Created anonymous session: anon_5075459d7c504eb2
2025-03-26 02:35:42,017 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Al-Ghazali...'
2025-03-26 02:35:42,018 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:35:42,022 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:35:43,267 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:36:19,925 - app.api.endpoints.auth - INFO - Created anonymous session: anon_351e12bb901f360b
2025-03-26 02:36:20,930 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Al-Ghazali...'
2025-03-26 02:36:20,931 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:36:20,935 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:36:21,589 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:39:31,087 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:39:31,088 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:39:31,091 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:39:31,956 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:39:33,129 - app.core.chat_service - WARNING - Could not store sources: Invalid document structure: Unknown attribute: "sources_json"
2025-03-26 02:43:57,254 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:47:27,266 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:48:45,390 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:50:01,753 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:50:07,458 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:50:07,460 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:50:07,464 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:50:09,089 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:49:12,300 - app.core.retrieval - INFO - Generated embedding for query: 'wxhy thisd...'
2025-03-26 02:49:12,301 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:49:12,303 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:49:13,473 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:49:47,263 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:49:47,264 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:49:47,270 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:49:49,782 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:50:09,022 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:50:09,023 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:50:09,028 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:50:09,808 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:51:11,770 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:50:13,575 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:50:13,575 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:50:13,578 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:50:14,210 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:50:21,635 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 02:50:39,010 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 02:51:41,796 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:51:41,796 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:51:41,799 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:50:41,146 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:50:45,445 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:50:45,487 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:50:45,509 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:50:46,391 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:50:46,544 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:50:53,534 - app.core.retrieval - INFO - Generated embedding for query: 'nice...'
2025-03-26 02:50:53,535 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:50:53,538 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:50:54,196 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:51:07,341 - app.core.retrieval - INFO - Generated embedding for query: 'kjigj...'
2025-03-26 02:51:07,342 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:51:07,346 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:51:08,093 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:52:10,933 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 02:52:11,045 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:52:11,159 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:52:12,166 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:52:13,421 - app.core.chat_service - WARNING - Could not store sources: Invalid document structure: Unknown attribute: "sources_json"
2025-03-26 02:53:26,589 - app.core.retrieval - INFO - Generated embedding for query: 'how are you...'
2025-03-26 02:53:26,590 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:53:26,593 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:53:27,294 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:53:27,500 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:53:28,010 - app.core.chat_service - WARNING - Could not store sources: Invalid document structure: Unknown attribute: "sources_json"
2025-03-26 02:53:44,638 - app.core.retrieval - INFO - Generated embedding for query: 'why i can upgrade the rate limit of this...'
2025-03-26 02:53:44,638 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:53:44,641 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:53:45,311 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:53:45,576 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 02:53:45,988 - app.core.chat_service - WARNING - Could not store sources: Invalid document structure: Unknown attribute: "sources_json"
2025-03-26 02:52:57,292 - app.core.retrieval - INFO - Generated embedding for query: 'i am starting to find this shit wait...'
2025-03-26 02:52:57,296 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 02:52:57,299 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 02:52:57,966 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 02:52:59,346 - app.core.chat_service - WARNING - Could not store sources: Invalid document structure: Unknown attribute: "sources_json"
2025-03-26 03:02:24,433 - app.api.endpoints.auth - ERROR - Registration error: Invalid `email` param: Value must be a valid email address
2025-03-26 03:03:39,929 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 03:03:39,930 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:03:39,948 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:02:39,113 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:02:40,352 - app.core.chat_service - WARNING - Could not store sources: Invalid document structure: Unknown attribute: "sources_json"
2025-03-26 03:03:19,004 - app.core.retrieval - INFO - Generated embedding for query: 'nice...'
2025-03-26 03:03:19,008 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:03:19,113 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:03:19,865 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:03:21,348 - app.core.chat_service - WARNING - Could not store sources: Invalid document structure: Unknown attribute: "sources_json"
2025-03-26 03:03:42,328 - app.core.retrieval - INFO - Generated embedding for query: 'What are the schools of Islamic thought?...'
2025-03-26 03:03:42,330 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:03:42,335 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:03:43,241 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:13:22,430 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 03:13:39,416 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 03:19:52,752 - app.api.endpoints.auth - ERROR - Registration error: Invalid `email` param: Value must be a valid email address
2025-03-26 03:20:34,782 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 03:20:34,783 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:20:34,798 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:20:36,421 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:20:45,064 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 03:20:45,065 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:20:45,067 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:20:45,835 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:20:46,027 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 03:21:44,365 - app.core.retrieval - INFO - Generated embedding for query: 'nice...'
2025-03-26 03:21:44,383 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:21:44,603 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:21:46,068 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:21:56,110 - app.core.retrieval - INFO - Generated embedding for query: 'nice...'
2025-03-26 03:21:56,122 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:21:56,533 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:22:00,188 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:22:28,670 - app.core.retrieval - INFO - Generated embedding for query: 'jdfhbgufh...'
2025-03-26 03:22:28,672 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:22:28,676 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:22:29,507 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:31:05,128 - app.api.endpoints.auth - ERROR - Registration error: Invalid `password` param: Password must be between 8 and 265 characters long, and should not be one of the commonly used password.
2025-03-26 03:31:33,501 - app.core.retrieval - INFO - Generated embedding for query: 'hey...'
2025-03-26 03:31:33,512 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:31:33,610 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:31:34,624 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 03:31:45,788 - app.core.retrieval - INFO - Generated embedding for query: 'nice...'
2025-03-26 03:32:47,667 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 03:31:45,992 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 03:31:46,900 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 05:57:19,080 - app.api.endpoints.auth - INFO - Created anonymous session: anon_9dfa84b9d6460483
2025-03-26 05:57:21,201 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 05:57:21,203 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 05:57:21,255 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 05:57:22,489 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 05:56:31,473 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 05:56:31,473 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 05:56:31,476 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 05:56:35,359 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:01:42,293 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 06:01:42,296 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:01:42,327 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:01:44,071 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:01:54,236 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 06:01:54,236 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:01:54,255 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:01:55,398 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:02:04,816 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 06:02:04,817 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:02:04,822 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:02:06,783 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:02:13,418 - app.core.retrieval - INFO - Generated embedding for query: 'What did Ibn Sina contribute to medicine?...'
2025-03-26 06:02:13,421 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:02:13,431 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:02:14,189 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:14:18,384 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 06:14:18,388 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:14:18,422 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:14:19,671 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:14:32,050 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 06:14:32,050 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:14:32,287 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:14:36,478 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:14:57,153 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 06:14:57,154 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:14:57,159 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:14:58,477 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:15:07,600 - app.core.retrieval - INFO - Generated embedding for query: 'What did Ibn Sina contribute to medicine?...'
2025-03-26 06:15:07,600 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:15:07,605 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:15:08,298 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:16:57,790 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 06:17:18,259 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 06:18:31,921 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 06:18:47,642 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 06:18:51,067 - app.core.chat_service - INFO - Getting conversations for user: user_test8338
2025-03-26 06:18:51,234 - app.core.chat_service - ERROR - Failed to list conversations: object dict can't be used in 'await' expression
2025-03-26 06:18:52,408 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 06:18:52,409 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:18:52,414 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:18:56,230 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:19:04,337 - app.api.endpoints.chat - INFO - Looking for conversation: 67e39c4a173cc85f2bad for user: user_test8338
2025-03-26 06:19:04,539 - app.api.endpoints.chat - ERROR - Error getting conversation: object dict can't be used in 'await' expression
2025-03-26 06:19:05,865 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 06:19:05,866 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:19:05,869 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:19:06,836 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:19:21,497 - app.core.chat_service - INFO - Getting conversations for user: user_test8338
2025-03-26 06:19:21,706 - app.core.chat_service - ERROR - Failed to list conversations: object dict can't be used in 'await' expression
2025-03-26 06:19:22,795 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 06:19:22,795 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:19:22,799 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:19:23,862 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:19:31,204 - app.core.retrieval - INFO - Generated embedding for query: 'What did Ibn Sina contribute to medicine?...'
2025-03-26 06:19:31,205 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:19:31,208 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:19:32,203 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:21:42,921 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 06:22:03,557 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 06:24:39,339 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 06:24:59,199 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 06:25:05,716 - app.core.chat_service - INFO - Getting conversations for user: user_test2196
2025-03-26 06:25:05,923 - app.core.chat_service - ERROR - Failed to list conversations: object dict can't be used in 'await' expression
2025-03-26 06:25:06,950 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 06:25:06,951 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:25:06,955 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:25:12,683 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:25:21,357 - app.api.endpoints.chat - INFO - Looking for conversation: 67e39dc0b6bf8561f32d for user: user_test2196
2025-03-26 06:25:21,537 - app.api.endpoints.chat - INFO - Found conversation with user_id: user_test2196
2025-03-26 06:25:21,693 - app.api.endpoints.chat - ERROR - Error getting conversation: Invalid query: Syntax error
2025-03-26 06:25:22,674 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 06:25:22,674 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:25:22,678 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:25:24,044 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:26:40,641 - app.core.chat_service - INFO - Getting conversations for user: user_test2196
2025-03-26 06:25:39,829 - app.core.chat_service - ERROR - Failed to list conversations: object dict can't be used in 'await' expression
2025-03-26 06:25:40,667 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 06:25:40,669 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:25:40,672 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:25:41,933 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:25:50,338 - app.core.retrieval - INFO - Generated embedding for query: 'What did Ibn Sina contribute to medicine?...'
2025-03-26 06:25:50,338 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:25:50,341 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:25:51,291 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:26:30,795 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 06:27:03,180 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 06:34:41,379 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 06:35:04,690 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 06:37:05,668 - app.core.chat_service - INFO - Getting conversations for user: user_test28160
2025-03-26 06:37:05,893 - app.core.chat_service - ERROR - Failed to list conversations: object dict can't be used in 'await' expression
2025-03-26 06:37:07,011 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 06:37:07,012 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:37:07,016 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:37:10,883 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:37:19,123 - app.api.endpoints.chat - INFO - Found conversation: 67e3a09098296e783a48 for user: user_test28160
2025-03-26 06:37:20,260 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 06:37:20,260 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:37:20,263 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:37:21,380 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:37:35,320 - app.core.chat_service - INFO - Getting conversations for user: user_test28160
2025-03-26 06:37:35,583 - app.core.chat_service - ERROR - Failed to list conversations: object dict can't be used in 'await' expression
2025-03-26 06:37:36,365 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 06:37:36,365 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:37:36,368 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:37:37,811 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:37:38,034 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 06:37:40,768 - app.core.retrieval - INFO - Generated embedding for query: 'What did Ibn Sina contribute to medicine?...'
2025-03-26 06:37:40,769 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:37:40,772 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:37:41,716 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:38:59,411 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 06:38:14,304 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 06:38:20,333 - app.core.chat_service - INFO - Getting conversations for user: user_test29012
2025-03-26 06:38:20,499 - app.core.chat_service - ERROR - Failed to list conversations: object dict can't be used in 'await' expression
2025-03-26 06:38:22,156 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 06:38:22,157 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:38:22,160 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 06:38:25,192 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 06:47:25,451 - app.core.chat_service - INFO - Getting conversations for user: user_test10560
2025-03-26 06:47:25,669 - app.core.chat_service - ERROR - Failed to list conversations: object dict can't be used in 'await' expression
2025-03-26 06:47:27,289 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 06:47:27,289 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 06:47:27,302 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:35:50,895 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 17:38:23,466 - app.main - ERROR - Request failed: object dict can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 54, in create_conversation
    return await create_new_conversation(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object dict can't be used in 'await' expression

2025-03-26 17:38:24,418 - app.core.chat_service - INFO - Getting conversations for user: user_test7035
2025-03-26 17:38:24,628 - app.core.chat_service - INFO - Got 25 total conversations
2025-03-26 17:38:24,629 - app.core.chat_service - INFO - Checking conversation: 67e20992e4a9ccf3980f with user: user_test
2025-03-26 17:38:24,629 - app.core.chat_service - INFO - Checking conversation: 67e20cf759a7e3e0797f with user: user_test
2025-03-26 17:38:24,630 - app.core.chat_service - INFO - Checking conversation: 67e20e95286137d70962 with user: user_test
2025-03-26 17:38:24,630 - app.core.chat_service - INFO - Checking conversation: 67e21efb2e0c820f3ff3 with user: user_test
2025-03-26 17:38:24,631 - app.core.chat_service - INFO - Checking conversation: 67e24311342bd0d8d7e0 with user: user_test
2025-03-26 17:38:24,631 - app.core.chat_service - INFO - Checking conversation: 67e3513396ff4ff88972 with user: user_test
2025-03-26 17:38:24,632 - app.core.chat_service - INFO - Checking conversation: 67e35ac34f0ae09325a4 with user: anon_d387e7430af1e011
2025-03-26 17:38:24,635 - app.core.chat_service - INFO - Checking conversation: 67e35f0275edae84daf8 with user: anon_8a8de7db14bec1ad
2025-03-26 17:38:24,636 - app.core.chat_service - INFO - Checking conversation: 67e35f31733aa9cae4eb with user: anon_9d3322d358e4ea48
2025-03-26 17:38:24,637 - app.core.chat_service - INFO - Checking conversation: 67e35f31b4506633a1c4 with user: anon_3bcd8615f647df01
2025-03-26 17:38:24,638 - app.core.chat_service - INFO - Checking conversation: 67e35f31e811f6db7ce0 with user: anon_a979daf531748451
2025-03-26 17:38:24,639 - app.core.chat_service - INFO - Checking conversation: 67e35f41092689b251ad with user: user_walidaboulaakoul
2025-03-26 17:38:24,639 - app.core.chat_service - INFO - Checking conversation: 67e35f4173482db5112a with user: user_walidaboulaakoul
2025-03-26 17:38:24,640 - app.core.chat_service - INFO - Checking conversation: 67e35f41f17590b4af58 with user: user_walidaboulaakoul
2025-03-26 17:38:24,641 - app.core.chat_service - INFO - Checking conversation: 67e35f428c0b7580fbd9 with user: user_walidaboulaakoul
2025-03-26 17:38:24,641 - app.core.chat_service - INFO - Checking conversation: 67e35f430c559ac50191 with user: user_walidaboulaakoul
2025-03-26 17:38:24,642 - app.core.chat_service - INFO - Checking conversation: 67e35f437d04d2890942 with user: user_walidaboulaakoul
2025-03-26 17:38:24,642 - app.core.chat_service - INFO - Checking conversation: 67e35f43f2207daedea2 with user: user_walidaboulaakoul
2025-03-26 17:38:24,643 - app.core.chat_service - INFO - Checking conversation: 67e35f4470dcb03a2f01 with user: user_walidaboulaakoul
2025-03-26 17:38:24,643 - app.core.chat_service - INFO - Checking conversation: 67e35f44ecb48507a79a with user: user_walidaboulaakoul
2025-03-26 17:38:24,644 - app.core.chat_service - INFO - Checking conversation: 67e35f4572b4d7bfe4cb with user: user_walidaboulaakoul
2025-03-26 17:38:24,645 - app.core.chat_service - INFO - Checking conversation: 67e35f45f1fef455dfed with user: user_walidaboulaakoul
2025-03-26 17:38:24,648 - app.core.chat_service - INFO - Checking conversation: 67e35f4671f7b44c9a7e with user: user_walidaboulaakoul
2025-03-26 17:38:24,648 - app.core.chat_service - INFO - Checking conversation: 67e35f4997b461cc1f27 with user: user_walidaboulaakoul
2025-03-26 17:38:24,651 - app.core.chat_service - INFO - Checking conversation: 67e35f4a20c4da6b350f with user: user_walidaboulaakoul
2025-03-26 17:38:24,655 - app.core.chat_service - INFO - Returning 0 conversations for user user_test7035
2025-03-26 17:38:24,692 - app.main - ERROR - Request failed: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 59, in list_conversations
    return await get_user_conversations(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression

2025-03-26 17:38:25,540 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 17:38:25,540 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:38:25,543 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:38:29,475 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:38:38,736 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 17:38:38,736 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:38:38,739 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:38:39,416 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:38:51,029 - app.main - ERROR - Request failed: object dict can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 54, in create_conversation
    return await create_new_conversation(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object dict can't be used in 'await' expression

2025-03-26 17:38:51,942 - app.core.chat_service - INFO - Getting conversations for user: user_test7035
2025-03-26 17:38:52,142 - app.core.chat_service - INFO - Got 25 total conversations
2025-03-26 17:38:52,143 - app.core.chat_service - INFO - Checking conversation: 67e20992e4a9ccf3980f with user: user_test
2025-03-26 17:38:52,144 - app.core.chat_service - INFO - Checking conversation: 67e20cf759a7e3e0797f with user: user_test
2025-03-26 17:38:52,144 - app.core.chat_service - INFO - Checking conversation: 67e20e95286137d70962 with user: user_test
2025-03-26 17:38:52,144 - app.core.chat_service - INFO - Checking conversation: 67e21efb2e0c820f3ff3 with user: user_test
2025-03-26 17:38:52,145 - app.core.chat_service - INFO - Checking conversation: 67e24311342bd0d8d7e0 with user: user_test
2025-03-26 17:38:52,145 - app.core.chat_service - INFO - Checking conversation: 67e3513396ff4ff88972 with user: user_test
2025-03-26 17:38:52,146 - app.core.chat_service - INFO - Checking conversation: 67e35ac34f0ae09325a4 with user: anon_d387e7430af1e011
2025-03-26 17:38:52,146 - app.core.chat_service - INFO - Checking conversation: 67e35f0275edae84daf8 with user: anon_8a8de7db14bec1ad
2025-03-26 17:38:52,147 - app.core.chat_service - INFO - Checking conversation: 67e35f31733aa9cae4eb with user: anon_9d3322d358e4ea48
2025-03-26 17:38:52,150 - app.core.chat_service - INFO - Checking conversation: 67e35f31b4506633a1c4 with user: anon_3bcd8615f647df01
2025-03-26 17:38:52,152 - app.core.chat_service - INFO - Checking conversation: 67e35f31e811f6db7ce0 with user: anon_a979daf531748451
2025-03-26 17:38:52,153 - app.core.chat_service - INFO - Checking conversation: 67e35f41092689b251ad with user: user_walidaboulaakoul
2025-03-26 17:38:52,156 - app.core.chat_service - INFO - Checking conversation: 67e35f4173482db5112a with user: user_walidaboulaakoul
2025-03-26 17:38:52,157 - app.core.chat_service - INFO - Checking conversation: 67e35f41f17590b4af58 with user: user_walidaboulaakoul
2025-03-26 17:38:52,159 - app.core.chat_service - INFO - Checking conversation: 67e35f428c0b7580fbd9 with user: user_walidaboulaakoul
2025-03-26 17:38:52,159 - app.core.chat_service - INFO - Checking conversation: 67e35f430c559ac50191 with user: user_walidaboulaakoul
2025-03-26 17:38:52,162 - app.core.chat_service - INFO - Checking conversation: 67e35f437d04d2890942 with user: user_walidaboulaakoul
2025-03-26 17:38:52,164 - app.core.chat_service - INFO - Checking conversation: 67e35f43f2207daedea2 with user: user_walidaboulaakoul
2025-03-26 17:38:52,165 - app.core.chat_service - INFO - Checking conversation: 67e35f4470dcb03a2f01 with user: user_walidaboulaakoul
2025-03-26 17:38:52,166 - app.core.chat_service - INFO - Checking conversation: 67e35f44ecb48507a79a with user: user_walidaboulaakoul
2025-03-26 17:38:52,167 - app.core.chat_service - INFO - Checking conversation: 67e35f4572b4d7bfe4cb with user: user_walidaboulaakoul
2025-03-26 17:38:52,167 - app.core.chat_service - INFO - Checking conversation: 67e35f45f1fef455dfed with user: user_walidaboulaakoul
2025-03-26 17:38:52,168 - app.core.chat_service - INFO - Checking conversation: 67e35f4671f7b44c9a7e with user: user_walidaboulaakoul
2025-03-26 17:38:52,169 - app.core.chat_service - INFO - Checking conversation: 67e35f4997b461cc1f27 with user: user_walidaboulaakoul
2025-03-26 17:38:52,170 - app.core.chat_service - INFO - Checking conversation: 67e35f4a20c4da6b350f with user: user_walidaboulaakoul
2025-03-26 17:38:52,171 - app.core.chat_service - INFO - Returning 0 conversations for user user_test7035
2025-03-26 17:38:52,203 - app.main - ERROR - Request failed: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 59, in list_conversations
    return await get_user_conversations(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression

2025-03-26 17:38:53,040 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 17:38:53,040 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:38:53,043 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:38:53,766 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:40:14,474 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 17:40:29,733 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 17:40:32,291 - app.main - ERROR - Request failed: object dict can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 54, in create_conversation
    return await create_new_conversation(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object dict can't be used in 'await' expression

2025-03-26 17:40:32,789 - app.core.chat_service - INFO - Getting conversations for user: user_test5267
2025-03-26 17:40:32,966 - app.core.chat_service - INFO - Got 25 total conversations
2025-03-26 17:40:32,967 - app.core.chat_service - INFO - Checking conversation: 67e20992e4a9ccf3980f with user: user_test
2025-03-26 17:40:32,968 - app.core.chat_service - INFO - Checking conversation: 67e20cf759a7e3e0797f with user: user_test
2025-03-26 17:40:32,968 - app.core.chat_service - INFO - Checking conversation: 67e20e95286137d70962 with user: user_test
2025-03-26 17:40:32,969 - app.core.chat_service - INFO - Checking conversation: 67e21efb2e0c820f3ff3 with user: user_test
2025-03-26 17:40:32,969 - app.core.chat_service - INFO - Checking conversation: 67e24311342bd0d8d7e0 with user: user_test
2025-03-26 17:40:32,970 - app.core.chat_service - INFO - Checking conversation: 67e3513396ff4ff88972 with user: user_test
2025-03-26 17:40:32,970 - app.core.chat_service - INFO - Checking conversation: 67e35ac34f0ae09325a4 with user: anon_d387e7430af1e011
2025-03-26 17:40:32,971 - app.core.chat_service - INFO - Checking conversation: 67e35f0275edae84daf8 with user: anon_8a8de7db14bec1ad
2025-03-26 17:40:32,971 - app.core.chat_service - INFO - Checking conversation: 67e35f31733aa9cae4eb with user: anon_9d3322d358e4ea48
2025-03-26 17:40:32,972 - app.core.chat_service - INFO - Checking conversation: 67e35f31b4506633a1c4 with user: anon_3bcd8615f647df01
2025-03-26 17:40:32,972 - app.core.chat_service - INFO - Checking conversation: 67e35f31e811f6db7ce0 with user: anon_a979daf531748451
2025-03-26 17:40:32,973 - app.core.chat_service - INFO - Checking conversation: 67e35f41092689b251ad with user: user_walidaboulaakoul
2025-03-26 17:40:32,973 - app.core.chat_service - INFO - Checking conversation: 67e35f4173482db5112a with user: user_walidaboulaakoul
2025-03-26 17:40:32,974 - app.core.chat_service - INFO - Checking conversation: 67e35f41f17590b4af58 with user: user_walidaboulaakoul
2025-03-26 17:40:32,975 - app.core.chat_service - INFO - Checking conversation: 67e35f428c0b7580fbd9 with user: user_walidaboulaakoul
2025-03-26 17:40:32,976 - app.core.chat_service - INFO - Checking conversation: 67e35f430c559ac50191 with user: user_walidaboulaakoul
2025-03-26 17:40:32,977 - app.core.chat_service - INFO - Checking conversation: 67e35f437d04d2890942 with user: user_walidaboulaakoul
2025-03-26 17:40:32,977 - app.core.chat_service - INFO - Checking conversation: 67e35f43f2207daedea2 with user: user_walidaboulaakoul
2025-03-26 17:40:32,978 - app.core.chat_service - INFO - Checking conversation: 67e35f4470dcb03a2f01 with user: user_walidaboulaakoul
2025-03-26 17:40:32,979 - app.core.chat_service - INFO - Checking conversation: 67e35f44ecb48507a79a with user: user_walidaboulaakoul
2025-03-26 17:40:32,980 - app.core.chat_service - INFO - Checking conversation: 67e35f4572b4d7bfe4cb with user: user_walidaboulaakoul
2025-03-26 17:40:32,982 - app.core.chat_service - INFO - Checking conversation: 67e35f45f1fef455dfed with user: user_walidaboulaakoul
2025-03-26 17:40:32,983 - app.core.chat_service - INFO - Checking conversation: 67e35f4671f7b44c9a7e with user: user_walidaboulaakoul
2025-03-26 17:40:32,984 - app.core.chat_service - INFO - Checking conversation: 67e35f4997b461cc1f27 with user: user_walidaboulaakoul
2025-03-26 17:40:32,984 - app.core.chat_service - INFO - Checking conversation: 67e35f4a20c4da6b350f with user: user_walidaboulaakoul
2025-03-26 17:40:32,985 - app.core.chat_service - INFO - Returning 0 conversations for user user_test5267
2025-03-26 17:40:33,022 - app.main - ERROR - Request failed: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 59, in list_conversations
    return await get_user_conversations(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression

2025-03-26 17:40:33,878 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 17:40:33,879 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:40:33,882 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:40:35,256 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:40:40,961 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 17:40:41,005 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:40:41,053 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:40:41,831 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:40:53,145 - app.main - ERROR - Request failed: object dict can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 54, in create_conversation
    return await create_new_conversation(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object dict can't be used in 'await' expression

2025-03-26 17:40:54,001 - app.core.chat_service - INFO - Getting conversations for user: user_test5267
2025-03-26 17:40:54,258 - app.core.chat_service - INFO - Got 25 total conversations
2025-03-26 17:40:54,259 - app.core.chat_service - INFO - Checking conversation: 67e20992e4a9ccf3980f with user: user_test
2025-03-26 17:40:54,259 - app.core.chat_service - INFO - Checking conversation: 67e20cf759a7e3e0797f with user: user_test
2025-03-26 17:40:54,260 - app.core.chat_service - INFO - Checking conversation: 67e20e95286137d70962 with user: user_test
2025-03-26 17:40:54,261 - app.core.chat_service - INFO - Checking conversation: 67e21efb2e0c820f3ff3 with user: user_test
2025-03-26 17:40:54,261 - app.core.chat_service - INFO - Checking conversation: 67e24311342bd0d8d7e0 with user: user_test
2025-03-26 17:40:54,262 - app.core.chat_service - INFO - Checking conversation: 67e3513396ff4ff88972 with user: user_test
2025-03-26 17:40:54,262 - app.core.chat_service - INFO - Checking conversation: 67e35ac34f0ae09325a4 with user: anon_d387e7430af1e011
2025-03-26 17:40:54,262 - app.core.chat_service - INFO - Checking conversation: 67e35f0275edae84daf8 with user: anon_8a8de7db14bec1ad
2025-03-26 17:40:54,263 - app.core.chat_service - INFO - Checking conversation: 67e35f31733aa9cae4eb with user: anon_9d3322d358e4ea48
2025-03-26 17:40:54,266 - app.core.chat_service - INFO - Checking conversation: 67e35f31b4506633a1c4 with user: anon_3bcd8615f647df01
2025-03-26 17:40:54,266 - app.core.chat_service - INFO - Checking conversation: 67e35f31e811f6db7ce0 with user: anon_a979daf531748451
2025-03-26 17:40:54,267 - app.core.chat_service - INFO - Checking conversation: 67e35f41092689b251ad with user: user_walidaboulaakoul
2025-03-26 17:40:54,268 - app.core.chat_service - INFO - Checking conversation: 67e35f4173482db5112a with user: user_walidaboulaakoul
2025-03-26 17:40:54,269 - app.core.chat_service - INFO - Checking conversation: 67e35f41f17590b4af58 with user: user_walidaboulaakoul
2025-03-26 17:40:54,270 - app.core.chat_service - INFO - Checking conversation: 67e35f428c0b7580fbd9 with user: user_walidaboulaakoul
2025-03-26 17:40:54,270 - app.core.chat_service - INFO - Checking conversation: 67e35f430c559ac50191 with user: user_walidaboulaakoul
2025-03-26 17:40:54,271 - app.core.chat_service - INFO - Checking conversation: 67e35f437d04d2890942 with user: user_walidaboulaakoul
2025-03-26 17:40:54,271 - app.core.chat_service - INFO - Checking conversation: 67e35f43f2207daedea2 with user: user_walidaboulaakoul
2025-03-26 17:40:54,272 - app.core.chat_service - INFO - Checking conversation: 67e35f4470dcb03a2f01 with user: user_walidaboulaakoul
2025-03-26 17:40:54,272 - app.core.chat_service - INFO - Checking conversation: 67e35f44ecb48507a79a with user: user_walidaboulaakoul
2025-03-26 17:40:54,273 - app.core.chat_service - INFO - Checking conversation: 67e35f4572b4d7bfe4cb with user: user_walidaboulaakoul
2025-03-26 17:40:54,274 - app.core.chat_service - INFO - Checking conversation: 67e35f45f1fef455dfed with user: user_walidaboulaakoul
2025-03-26 17:40:54,275 - app.core.chat_service - INFO - Checking conversation: 67e35f4671f7b44c9a7e with user: user_walidaboulaakoul
2025-03-26 17:40:54,276 - app.core.chat_service - INFO - Checking conversation: 67e35f4997b461cc1f27 with user: user_walidaboulaakoul
2025-03-26 17:40:54,276 - app.core.chat_service - INFO - Checking conversation: 67e35f4a20c4da6b350f with user: user_walidaboulaakoul
2025-03-26 17:40:54,277 - app.core.chat_service - INFO - Returning 0 conversations for user user_test5267
2025-03-26 17:40:54,312 - app.main - ERROR - Request failed: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 59, in list_conversations
    return await get_user_conversations(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression

2025-03-26 17:40:55,441 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 17:40:55,442 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:40:55,445 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:40:56,168 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:42:14,169 - app.main - ERROR - Request failed: object dict can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 54, in create_conversation
    return await create_new_conversation(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object dict can't be used in 'await' expression

2025-03-26 17:42:15,029 - app.core.chat_service - INFO - Getting conversations for user: user_test4639
2025-03-26 17:42:15,295 - app.core.chat_service - INFO - Got 25 total conversations
2025-03-26 17:42:15,441 - app.core.chat_service - INFO - Checking conversation: 67e20992e4a9ccf3980f with user: user_test
2025-03-26 17:42:15,456 - app.core.chat_service - INFO - Checking conversation: 67e20cf759a7e3e0797f with user: user_test
2025-03-26 17:42:15,469 - app.core.chat_service - INFO - Checking conversation: 67e20e95286137d70962 with user: user_test
2025-03-26 17:42:15,527 - app.core.chat_service - INFO - Checking conversation: 67e21efb2e0c820f3ff3 with user: user_test
2025-03-26 17:42:15,538 - app.core.chat_service - INFO - Checking conversation: 67e24311342bd0d8d7e0 with user: user_test
2025-03-26 17:42:15,548 - app.core.chat_service - INFO - Checking conversation: 67e3513396ff4ff88972 with user: user_test
2025-03-26 17:42:15,551 - app.core.chat_service - INFO - Checking conversation: 67e35ac34f0ae09325a4 with user: anon_d387e7430af1e011
2025-03-26 17:42:15,553 - app.core.chat_service - INFO - Checking conversation: 67e35f0275edae84daf8 with user: anon_8a8de7db14bec1ad
2025-03-26 17:42:15,561 - app.core.chat_service - INFO - Checking conversation: 67e35f31733aa9cae4eb with user: anon_9d3322d358e4ea48
2025-03-26 17:42:15,566 - app.core.chat_service - INFO - Checking conversation: 67e35f31b4506633a1c4 with user: anon_3bcd8615f647df01
2025-03-26 17:42:15,572 - app.core.chat_service - INFO - Checking conversation: 67e35f31e811f6db7ce0 with user: anon_a979daf531748451
2025-03-26 17:42:15,573 - app.core.chat_service - INFO - Checking conversation: 67e35f41092689b251ad with user: user_walidaboulaakoul
2025-03-26 17:42:15,575 - app.core.chat_service - INFO - Checking conversation: 67e35f4173482db5112a with user: user_walidaboulaakoul
2025-03-26 17:42:15,576 - app.core.chat_service - INFO - Checking conversation: 67e35f41f17590b4af58 with user: user_walidaboulaakoul
2025-03-26 17:42:15,578 - app.core.chat_service - INFO - Checking conversation: 67e35f428c0b7580fbd9 with user: user_walidaboulaakoul
2025-03-26 17:42:15,580 - app.core.chat_service - INFO - Checking conversation: 67e35f430c559ac50191 with user: user_walidaboulaakoul
2025-03-26 17:42:15,584 - app.core.chat_service - INFO - Checking conversation: 67e35f437d04d2890942 with user: user_walidaboulaakoul
2025-03-26 17:42:15,590 - app.core.chat_service - INFO - Checking conversation: 67e35f43f2207daedea2 with user: user_walidaboulaakoul
2025-03-26 17:42:15,600 - app.core.chat_service - INFO - Checking conversation: 67e35f4470dcb03a2f01 with user: user_walidaboulaakoul
2025-03-26 17:42:15,602 - app.core.chat_service - INFO - Checking conversation: 67e35f44ecb48507a79a with user: user_walidaboulaakoul
2025-03-26 17:42:15,646 - app.core.chat_service - INFO - Checking conversation: 67e35f4572b4d7bfe4cb with user: user_walidaboulaakoul
2025-03-26 17:42:15,661 - app.core.chat_service - INFO - Checking conversation: 67e35f45f1fef455dfed with user: user_walidaboulaakoul
2025-03-26 17:42:15,670 - app.core.chat_service - INFO - Checking conversation: 67e35f4671f7b44c9a7e with user: user_walidaboulaakoul
2025-03-26 17:42:15,672 - app.core.chat_service - INFO - Checking conversation: 67e35f4997b461cc1f27 with user: user_walidaboulaakoul
2025-03-26 17:42:15,673 - app.core.chat_service - INFO - Checking conversation: 67e35f4a20c4da6b350f with user: user_walidaboulaakoul
2025-03-26 17:42:15,675 - app.core.chat_service - INFO - Returning 0 conversations for user user_test4639
2025-03-26 17:42:15,723 - app.main - ERROR - Request failed: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 59, in list_conversations
    return await get_user_conversations(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression

2025-03-26 17:42:16,524 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 17:42:16,524 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:42:16,528 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:42:17,273 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:42:17,481 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 17:42:19,977 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 17:42:19,978 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:42:19,980 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:42:20,621 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:42:27,022 - app.main - ERROR - Request failed: object dict can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 54, in create_conversation
    return await create_new_conversation(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object dict can't be used in 'await' expression

2025-03-26 17:42:27,968 - app.core.chat_service - INFO - Getting conversations for user: user_test4639
2025-03-26 17:42:28,166 - app.core.chat_service - INFO - Got 25 total conversations
2025-03-26 17:42:28,167 - app.core.chat_service - INFO - Checking conversation: 67e20992e4a9ccf3980f with user: user_test
2025-03-26 17:42:28,167 - app.core.chat_service - INFO - Checking conversation: 67e20cf759a7e3e0797f with user: user_test
2025-03-26 17:42:28,168 - app.core.chat_service - INFO - Checking conversation: 67e20e95286137d70962 with user: user_test
2025-03-26 17:42:28,168 - app.core.chat_service - INFO - Checking conversation: 67e21efb2e0c820f3ff3 with user: user_test
2025-03-26 17:42:28,168 - app.core.chat_service - INFO - Checking conversation: 67e24311342bd0d8d7e0 with user: user_test
2025-03-26 17:42:28,169 - app.core.chat_service - INFO - Checking conversation: 67e3513396ff4ff88972 with user: user_test
2025-03-26 17:42:28,169 - app.core.chat_service - INFO - Checking conversation: 67e35ac34f0ae09325a4 with user: anon_d387e7430af1e011
2025-03-26 17:42:28,169 - app.core.chat_service - INFO - Checking conversation: 67e35f0275edae84daf8 with user: anon_8a8de7db14bec1ad
2025-03-26 17:42:28,171 - app.core.chat_service - INFO - Checking conversation: 67e35f31733aa9cae4eb with user: anon_9d3322d358e4ea48
2025-03-26 17:42:28,172 - app.core.chat_service - INFO - Checking conversation: 67e35f31b4506633a1c4 with user: anon_3bcd8615f647df01
2025-03-26 17:42:28,175 - app.core.chat_service - INFO - Checking conversation: 67e35f31e811f6db7ce0 with user: anon_a979daf531748451
2025-03-26 17:42:28,176 - app.core.chat_service - INFO - Checking conversation: 67e35f41092689b251ad with user: user_walidaboulaakoul
2025-03-26 17:42:28,177 - app.core.chat_service - INFO - Checking conversation: 67e35f4173482db5112a with user: user_walidaboulaakoul
2025-03-26 17:42:28,178 - app.core.chat_service - INFO - Checking conversation: 67e35f41f17590b4af58 with user: user_walidaboulaakoul
2025-03-26 17:42:28,179 - app.core.chat_service - INFO - Checking conversation: 67e35f428c0b7580fbd9 with user: user_walidaboulaakoul
2025-03-26 17:42:28,179 - app.core.chat_service - INFO - Checking conversation: 67e35f430c559ac50191 with user: user_walidaboulaakoul
2025-03-26 17:42:28,179 - app.core.chat_service - INFO - Checking conversation: 67e35f437d04d2890942 with user: user_walidaboulaakoul
2025-03-26 17:42:28,180 - app.core.chat_service - INFO - Checking conversation: 67e35f43f2207daedea2 with user: user_walidaboulaakoul
2025-03-26 17:42:28,180 - app.core.chat_service - INFO - Checking conversation: 67e35f4470dcb03a2f01 with user: user_walidaboulaakoul
2025-03-26 17:42:28,181 - app.core.chat_service - INFO - Checking conversation: 67e35f44ecb48507a79a with user: user_walidaboulaakoul
2025-03-26 17:42:28,181 - app.core.chat_service - INFO - Checking conversation: 67e35f4572b4d7bfe4cb with user: user_walidaboulaakoul
2025-03-26 17:42:28,181 - app.core.chat_service - INFO - Checking conversation: 67e35f45f1fef455dfed with user: user_walidaboulaakoul
2025-03-26 17:42:28,182 - app.core.chat_service - INFO - Checking conversation: 67e35f4671f7b44c9a7e with user: user_walidaboulaakoul
2025-03-26 17:42:28,183 - app.core.chat_service - INFO - Checking conversation: 67e35f4997b461cc1f27 with user: user_walidaboulaakoul
2025-03-26 17:42:28,184 - app.core.chat_service - INFO - Checking conversation: 67e35f4a20c4da6b350f with user: user_walidaboulaakoul
2025-03-26 17:42:28,184 - app.core.chat_service - INFO - Returning 0 conversations for user user_test4639
2025-03-26 17:42:28,219 - app.main - ERROR - Request failed: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 104, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 61, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 59, in list_conversations
    return await get_user_conversations(user["user_id"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression

2025-03-26 17:42:28,995 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 17:42:28,996 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:42:28,999 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:42:29,713 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:42:29,902 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 17:50:45,156 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 17:51:01,890 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 17:51:13,658 - app.core.chat_service - INFO - Getting conversations for user: user_test12718
2025-03-26 17:51:13,840 - app.core.chat_service - INFO - Got 1 conversations for user: user_test12718
2025-03-26 17:51:14,771 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 17:51:14,772 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:51:14,775 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:51:17,777 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:51:24,312 - app.api.endpoints.chat - INFO - Found conversation: 67e43e9086a88c3a8eee for user: user_test12718
2025-03-26 17:51:24,976 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 17:51:24,977 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:51:24,989 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:51:25,737 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:51:34,758 - app.core.chat_service - INFO - Getting conversations for user: user_test12718
2025-03-26 17:51:34,985 - app.core.chat_service - INFO - Got 2 conversations for user: user_test12718
2025-03-26 17:51:35,420 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 17:51:35,422 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:51:35,424 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:51:36,166 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:51:36,367 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 17:51:39,355 - app.core.retrieval - INFO - Generated embedding for query: 'What did Ibn Sina contribute to medicine?...'
2025-03-26 17:51:39,356 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:51:39,358 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:51:40,128 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:52:29,614 - app.core.chat_service - INFO - Getting conversations for user: user_test21086
2025-03-26 17:52:29,850 - app.core.chat_service - INFO - Got 1 conversations for user: user_test21086
2025-03-26 17:52:31,100 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 17:52:31,104 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:52:31,108 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:52:32,035 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:52:39,394 - app.api.endpoints.chat - INFO - Found conversation: 67e43edc5eea71f6f753 for user: user_test21086
2025-03-26 17:52:40,239 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 17:52:40,240 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:52:40,246 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:52:41,427 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:52:57,142 - app.core.chat_service - INFO - Getting conversations for user: user_test21086
2025-03-26 17:52:57,412 - app.core.chat_service - INFO - Got 2 conversations for user: user_test21086
2025-03-26 17:52:58,446 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 17:52:58,446 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:52:58,459 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:52:59,270 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 17:53:04,048 - app.core.retrieval - INFO - Generated embedding for query: 'What did Ibn Sina contribute to medicine?...'
2025-03-26 17:53:04,051 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 17:53:04,065 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 17:53:04,905 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 18:02:38,468 - app.core.chat_service - INFO - Getting conversations for user: user_test23144
2025-03-26 18:02:38,697 - app.core.chat_service - INFO - Got 1 conversations for user: user_test23144
2025-03-26 18:02:39,659 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 18:02:39,660 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 18:02:39,664 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 18:02:40,692 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 18:02:48,503 - app.api.endpoints.chat - INFO - Found conversation: 67e4413d8aa1929d2a27 for user: user_test23144
2025-03-26 18:02:49,805 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 18:02:49,806 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 18:02:49,810 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 18:02:50,821 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 18:03:00,858 - app.core.chat_service - INFO - Getting conversations for user: user_test23144
2025-03-26 18:03:01,073 - app.core.chat_service - INFO - Got 2 conversations for user: user_test23144
2025-03-26 18:03:01,968 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Ibn Sina...'
2025-03-26 18:03:01,969 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 18:03:01,972 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 18:03:02,216 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 18:03:10,180 - app.core.retrieval - INFO - Generated embedding for query: 'What did Ibn Sina contribute to medicine?...'
2025-03-26 18:03:10,181 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 18:03:10,186 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 18:03:10,994 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 18:17:32,663 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 18:17:32,666 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 18:17:32,681 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 18:17:33,581 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 18:17:42,075 - app.api.endpoints.chat - INFO - Found conversation: 67e444bac2abf581dcf5 for user: user_test2920
2025-03-26 18:17:43,478 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 18:17:43,479 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 18:17:43,489 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 18:17:43,995 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 18:17:54,847 - app.api.endpoints.chat - INFO - Found conversation: 67e444bac2abf581dcf5 for user: user_test2920
2025-03-26 18:17:55,920 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Imam al-Shafi'i's contributions to I...'
2025-03-26 18:17:55,921 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 18:17:55,926 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 18:17:56,635 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 18:17:56,834 - app.core.chat_service - ERROR - API Error: 429 - {"message":"Requests rate limit exceeded"}
2025-03-26 18:17:59,041 - app.api.endpoints.chat - INFO - Found conversation: 67e444bac2abf581dcf5 for user: user_test2920
2025-03-26 18:30:51,500 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 20:01:51,601 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app']
2025-03-26 20:01:51,633 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 20:02:36,158 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 20:02:36,159 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 20:02:36,163 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 20:02:37,588 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 20:02:37,591 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 20:02:42,878 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 20:02:44,722 - app.api.endpoints.chat - INFO - Found conversation: 67e45d5a8abef43f23ff for user: user_test18110
2025-03-26 20:02:45,750 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 20:02:45,751 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 20:02:45,753 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 20:02:46,599 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 20:02:46,601 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 20:02:46,760 - app.core.chat_service - WARNING - Rate limit (429) hit. Retrying in 1.58 seconds...
2025-03-26 20:04:00,005 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 20:04:01,894 - app.api.endpoints.chat - INFO - Found conversation: 67e45d5a8abef43f23ff for user: user_test18110
2025-03-26 20:04:03,223 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Imam al-Shafi'i's contributions to I...'
2025-03-26 20:04:03,224 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 20:04:03,227 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 20:04:03,950 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 20:04:03,953 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 20:04:04,152 - app.core.chat_service - WARNING - Rate limit (429) hit. Retrying in 1.22 seconds...
2025-03-26 20:04:11,220 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 20:04:12,969 - app.api.endpoints.chat - INFO - Found conversation: 67e45d5a8abef43f23ff for user: user_test18110
2025-03-26 20:18:12,208 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 20:18:12,210 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 20:18:12,236 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 20:18:13,555 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 20:18:13,559 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 20:18:19,565 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 20:18:21,321 - app.api.endpoints.chat - INFO - Found conversation: 67e46102a7c7d2999657 for user: user_test27823
2025-03-26 20:18:22,396 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 20:18:22,397 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 20:18:22,400 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 20:18:23,207 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 20:18:23,210 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 20:18:33,914 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 20:18:35,336 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 20:18:51,977 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app']
2025-03-26 20:18:52,006 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 20:18:52,243 - app.api.endpoints.chat - INFO - Found conversation: 67e46102a7c7d2999657 for user: user_test27823
2025-03-26 20:18:53,124 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Imam al-Shafi'i's contributions to I...'
2025-03-26 20:18:53,124 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 20:18:53,131 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 20:18:54,246 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 20:18:54,249 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 20:19:00,845 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 20:19:00,846 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 20:19:01,363 - app.api.endpoints.chat - INFO - Found conversation: 67e46102a7c7d2999657 for user: user_test27823
2025-03-26 22:57:46,382 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 22:57:46,384 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:57:46,407 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:57:47,399 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:57:47,402 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:57:55,699 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:57:55,700 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:57:57,106 - app.api.endpoints.chat - INFO - Found conversation: 67e48668d21e4f735404 for user: user_test27185
2025-03-26 22:57:58,064 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 22:57:58,065 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:57:58,068 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:57:58,696 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:57:58,698 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:58:06,046 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:58:06,046 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:58:07,813 - app.api.endpoints.chat - INFO - Found conversation: 67e48668d21e4f735404 for user: user_test27185
2025-03-26 22:58:09,146 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Imam al-Shafi'i's contributions to I...'
2025-03-26 22:58:09,146 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:58:09,150 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:58:10,124 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:58:10,127 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:58:16,507 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:58:16,508 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:58:17,999 - app.api.endpoints.chat - INFO - Found conversation: 67e48668d21e4f735404 for user: user_test27185
2025-03-26 22:58:26,942 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 22:58:26,942 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:58:26,945 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:58:27,585 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:58:27,588 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:58:33,052 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:58:33,053 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:58:34,580 - app.api.endpoints.chat - INFO - Found conversation: 67e48691748603c81a62 for user: user_test32287
2025-03-26 22:58:35,476 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 22:58:35,476 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:58:35,480 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:58:35,996 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:58:35,998 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:58:44,439 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:58:44,440 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:58:46,261 - app.api.endpoints.chat - INFO - Found conversation: 67e48691748603c81a62 for user: user_test32287
2025-03-26 22:58:47,282 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Imam al-Shafi'i's contributions to I...'
2025-03-26 22:58:47,283 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:58:47,287 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:58:48,088 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:58:48,091 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:58:54,645 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:58:54,647 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:58:56,050 - app.api.endpoints.chat - INFO - Found conversation: 67e48691748603c81a62 for user: user_test32287
2025-03-26 22:58:57,127 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 22:58:57,128 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:58:57,131 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:58:58,059 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:58:58,062 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:59:04,759 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:59:04,759 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:59:06,284 - app.api.endpoints.chat - INFO - Found conversation: 67e486afb54dd50b63d1 for user: user_test4286
2025-03-26 22:59:07,245 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 22:59:07,246 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:59:07,249 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:59:07,905 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:59:07,907 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:59:17,475 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:59:17,476 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:59:20,293 - app.api.endpoints.chat - INFO - Found conversation: 67e486afb54dd50b63d1 for user: user_test4286
2025-03-26 22:59:20,998 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Imam al-Shafi'i's contributions to I...'
2025-03-26 22:59:20,999 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 22:59:21,011 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 22:59:22,131 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 22:59:22,133 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 22:59:28,940 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 22:59:28,941 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 22:59:30,538 - app.api.endpoints.chat - INFO - Found conversation: 67e486afb54dd50b63d1 for user: user_test4286
2025-03-26 23:41:02,387 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app']
2025-03-26 23:41:02,423 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 23:46:00,726 - app.main - INFO - Application shutdown: cleaning up resources
2025-03-26 23:46:17,352 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app']
2025-03-26 23:46:17,381 - app.main - INFO - Application startup: initializing services and connections
2025-03-26 23:46:45,538 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Islamic jurisprudence...'
2025-03-26 23:46:45,539 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 23:46:45,550 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 23:46:48,943 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 23:46:48,945 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 23:46:52,946 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 23:46:52,947 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 23:46:55,627 - app.api.endpoints.chat - INFO - Found conversation: 67e491e3d1d481871771 for user: user_test13711
2025-03-26 23:46:58,224 - app.core.retrieval - INFO - Generated embedding for query: 'Explain the differences between the schools of tho...'
2025-03-26 23:46:58,226 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 23:46:58,290 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 23:46:59,184 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 23:46:59,186 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 23:47:05,621 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 23:47:05,621 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 23:47:07,372 - app.api.endpoints.chat - INFO - Found conversation: 67e491e3d1d481871771 for user: user_test13711
2025-03-26 23:47:08,329 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about Imam al-Shafi'i's contributions to I...'
2025-03-26 23:47:08,329 - app.core.clients - INFO - Initializing Pinecone client
2025-03-26 23:47:08,339 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-03-26 23:47:08,989 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-03-26 23:47:08,991 - app.core.chat_service - INFO - Calling Mistral API with retry (max attempts: 3)
2025-03-26 23:47:14,496 - app.core.chat_service - INFO - Mistral API call successful
2025-03-26 23:47:14,498 - app.core.chat_service - INFO - Using Mistral response
2025-03-26 23:48:17,729 - app.api.endpoints.chat - INFO - Found conversation: 67e491e3d1d481871771 for user: user_test13711
2025-03-26 23:49:09,800 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-25 20:11:44,273 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-25 20:11:44,320 - app.main - INFO - Application startup: initializing services and connections
2025-04-25 20:13:46,216 - app.api.endpoints.auth - ERROR - Appwrite login error for test26768@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 20:13:47,688 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:13:47,865 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:13:59,838 - app.api.endpoints.auth - ERROR - Appwrite login error for test13741@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 20:15:17,878 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:14:00,846 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:14:01,635 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:14:01,848 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:14:02,113 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:14:02,252 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:14:02,519 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:14:02,677 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:14:02,932 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:14:03,071 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:14:03,344 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:14:03,501 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:17:31,352 - app.api.endpoints.auth - ERROR - Appwrite login error for test16779@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 20:17:32,299 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:17:32,461 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:17:33,157 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:17:33,315 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:17:33,569 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:17:33,725 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:17:33,979 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:17:34,127 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:17:34,387 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:17:34,571 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:17:34,827 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:17:34,976 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:22:32,080 - app.api.endpoints.auth - ERROR - Appwrite login error for test26626@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 20:22:33,042 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:22:33,189 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 20:23:05,221 - app.api.endpoints.auth - ERROR - Appwrite login error for test27484@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 20:23:06,617 - app.core.clients - INFO - Initializing Appwrite client
2025-04-25 20:23:06,763 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-25 21:08:47,638 - app.api.endpoints.auth - ERROR - Appwrite login error for test15937@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 21:11:45,413 - app.api.endpoints.auth - ERROR - Appwrite login error for test32365@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 21:13:49,124 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-25 21:15:20,929 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-25 21:15:20,993 - app.main - INFO - Application startup: initializing services and connections
2025-04-25 21:16:54,710 - app.api.endpoints.auth - ERROR - Appwrite login error for test5793@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 21:16:44,373 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-25 21:16:58,568 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-25 21:16:58,612 - app.main - INFO - Application startup: initializing services and connections
2025-04-25 21:24:33,909 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-25 21:30:45,777 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-25 21:30:45,817 - app.main - INFO - Application startup: initializing services and connections
2025-04-25 21:31:44,131 - app.api.endpoints.auth - ERROR - Appwrite login error for test14359@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 21:32:01,558 - app.api.endpoints.auth - ERROR - Appwrite login error for test29938@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 21:40:15,699 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-25 21:44:03,196 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-25 21:44:03,236 - app.main - INFO - Application startup: initializing services and connections
2025-04-25 21:44:09,180 - app.api.endpoints.auth - ERROR - Appwrite login error for test31835@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account)
2025-04-25 23:27:52,901 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 00:27:46,179 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 00:27:46,223 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 00:30:04,117 - app.api.endpoints.auth - INFO - Successfully registered user: test1825@example.com (ID: 680c1afbe031baa78ccc)
2025-04-26 00:30:04,896 - app.api.endpoints.auth - ERROR - Appwrite login error for test1825@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 00:37:45,629 - app.api.endpoints.auth - INFO - Successfully registered user: test13049@example.com (ID: 680c1cc94a105d7fe0fc)
2025-04-26 00:37:46,502 - app.api.endpoints.auth - ERROR - Appwrite login error for test13049@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 01:32:46,179 - app.api.endpoints.auth - INFO - Successfully registered user: test11793@example.com (ID: 680c29adb91a88ff4bb9)
2025-04-26 01:32:47,038 - app.api.endpoints.auth - ERROR - Appwrite login error for test11793@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 02:21:17,271 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 02:21:34,331 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 02:21:34,376 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 02:26:47,042 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 02:27:01,300 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 02:27:01,341 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 02:28:26,276 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 02:28:41,929 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 02:28:41,971 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 02:38:53,681 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 02:39:10,269 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 02:39:10,315 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 02:54:43,150 - app.api.endpoints.auth - INFO - Successfully registered user: test_end_to_end_1@example.com (ID: 680c3ce28c15a24e3ad1)
2025-04-26 02:55:08,623 - app.api.endpoints.auth - ERROR - Appwrite login error for test_end_to_end_1@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 02:55:46,666 - app.api.endpoints.auth - ERROR - Appwrite registration error for test_end_to_end_1@example.com: A user with the same id, email, or phone already exists in this project. (Code: 409, Type: user_already_exists)
2025-04-26 02:56:03,897 - app.api.endpoints.auth - ERROR - Appwrite login error for test_end_to_end_1@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 03:08:47,415 - app.api.endpoints.auth - ERROR - Appwrite login error for test_end_to_end_1@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 03:08:50,593 - app.api.endpoints.auth - ERROR - Appwrite registration error for test_end_to_end_1@example.com: A user with the same id, email, or phone already exists in this project. (Code: 409, Type: user_already_exists)
2025-04-26 03:08:53,199 - app.api.endpoints.auth - ERROR - Appwrite registration error for test_end_to_end_1@example.com: A user with the same id, email, or phone already exists in this project. (Code: 409, Type: user_already_exists)
2025-04-26 03:08:55,485 - app.api.endpoints.auth - ERROR - Appwrite login error for test_end_to_end_1@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 03:18:57,984 - app.api.endpoints.auth - ERROR - Appwrite login error for test_end_to_end_1@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 03:19:00,536 - app.api.endpoints.auth - ERROR - Appwrite registration error for test_end_to_end_1@example.com: A user with the same id, email, or phone already exists in this project. (Code: 409, Type: user_already_exists)
2025-04-26 03:19:03,552 - app.api.endpoints.auth - ERROR - Appwrite login error for test_end_to_end_1@example.com: app.67df69ef0039756850bd@service.cloud.appwrite.io (role: applications) missing scope (account) (Code: 401, Type: general_unauthorized_scope)
2025-04-26 03:19:11,241 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 15:26:18,530 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 15:26:18,607 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 15:38:30,657 - app.api.endpoints.auth - INFO - User registered successfully: test4208@example.com, ID: 680cef99631dd3b57638
2025-04-26 15:37:14,956 - app.api.endpoints.auth - INFO - Password verified for user: test4208@example.com, User ID: 680cef99631dd3b57638
2025-04-26 15:37:15,898 - app.api.endpoints.auth - INFO - JWT created successfully for user: test4208@example.com
2025-04-26 15:37:18,387 - app.main - ERROR - Request failed: 'UserResponse' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 173, in check_rate_limit
    user_id = user.get("user_id", f"fallback_anon_{secrets.token_hex(4)}") # Added fallback just in case
              ^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'UserResponse' object has no attribute 'get'

2025-04-26 15:37:19,361 - app.main - ERROR - Request failed: 'UserResponse' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 173, in check_rate_limit
    user_id = user.get("user_id", f"fallback_anon_{secrets.token_hex(4)}") # Added fallback just in case
              ^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'UserResponse' object has no attribute 'get'

2025-04-26 15:37:20,293 - app.main - ERROR - Request failed: 'UserResponse' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 173, in check_rate_limit
    user_id = user.get("user_id", f"fallback_anon_{secrets.token_hex(4)}") # Added fallback just in case
              ^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'UserResponse' object has no attribute 'get'

2025-04-26 16:08:09,958 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 16:08:10,608 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 16:09:28,496 - app.api.endpoints.auth - INFO - User registered successfully: ufv4jz2rpq@test.pytest.dev, ID: 680cf6db4f3f7c4f0eea
2025-04-26 16:08:12,369 - app.api.endpoints.auth - INFO - Password verified for user: ufv4jz2rpq@test.pytest.dev, User ID: 680cf6db4f3f7c4f0eea
2025-04-26 16:08:12,563 - app.api.endpoints.auth - INFO - JWT created successfully for user: ufv4jz2rpq@test.pytest.dev
2025-04-26 16:08:12,820 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 16:08:39,053 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 16:08:53,953 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 16:08:53,981 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 16:34:44,751 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 16:35:06,949 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 16:35:06,991 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 16:34:12,050 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 16:34:12,660 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 16:34:13,269 - app.api.endpoints.auth - INFO - User registered successfully: ui7lvmv7ot@fixture.pytest.dev, ID: 680cfcf50ee5623b3eb1
2025-04-26 16:34:13,574 - app.api.endpoints.auth - INFO - Password verified for user: ui7lvmv7ot@fixture.pytest.dev, User ID: 680cfcf50ee5623b3eb1
2025-04-26 16:34:13,742 - app.api.endpoints.auth - INFO - JWT created successfully for user: ui7lvmv7ot@fixture.pytest.dev
2025-04-26 16:34:14,279 - app.main - ERROR - Request failed: 'UserResponse' object is not subscriptable
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 79, in create_conversation
    return create_new_conversation(db=db, user_id=user["user_id"], is_anonymous=user.get("is_anonymous", False))
                                                  ~~~~^^^^^^^^^^^
TypeError: 'UserResponse' object is not subscriptable

2025-04-26 16:34:25,105 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 16:40:27,027 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 16:40:27,447 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 16:40:27,968 - app.api.endpoints.auth - INFO - User registered successfully: dm0gwa81ke@fixture.pytest.dev, ID: 680cfe6bb57558362442
2025-04-26 16:40:28,342 - app.api.endpoints.auth - INFO - Password verified for user: dm0gwa81ke@fixture.pytest.dev, User ID: 680cfe6bb57558362442
2025-04-26 16:40:28,482 - app.api.endpoints.auth - INFO - JWT created successfully for user: dm0gwa81ke@fixture.pytest.dev
2025-04-26 16:40:28,685 - app.core.chat_service - ERROR - Unexpected error creating conversation for user 680cfe6bb57558362442: module 'app.config.settings' has no attribute 'APPWRITE_DATABASE_ID'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 104, in create_new_conversation
    database_id=settings.APPWRITE_DATABASE_ID,
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'app.config.settings' has no attribute 'APPWRITE_DATABASE_ID'
2025-04-26 16:40:38,495 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 16:42:17,747 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 16:41:16,186 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 16:41:16,226 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 16:59:36,834 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:00:01,120 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:00:01,159 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:00:12,185 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:01:31,256 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:01:31,310 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:01:58,114 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:01:58,572 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:01:59,019 - app.api.endpoints.auth - INFO - User registered successfully: 4z7066mjf7@fixture.pytest.dev, ID: 680d0376d0a5991e113d
2025-04-26 17:01:59,522 - app.api.endpoints.auth - INFO - Password verified for user: 4z7066mjf7@fixture.pytest.dev, User ID: 680d0376d0a5991e113d
2025-04-26 17:01:59,681 - app.api.endpoints.auth - INFO - JWT created successfully for user: 4z7066mjf7@fixture.pytest.dev
2025-04-26 17:02:00,051 - app.core.chat_service - ERROR - Failed to create conversation for user 680d0376d0a5991e113d: Invalid document structure: Unknown attribute: "last_updated"
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/conversations/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 142, in create_new_conversation
    result = db.create_document(
        database_id=settings.APPWRITE_DATABASE_ID,
    ...<7 lines>...
        ]
    )
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Invalid document structure: Unknown attribute: "last_updated"
2025-04-26 17:02:11,299 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:08:41,119 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:08:13,527 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:08:13,576 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:10:35,111 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:10:35,578 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:10:36,110 - app.api.endpoints.auth - INFO - User registered successfully: 4v0wnyrzx9@fixture.pytest.dev, ID: 680d052f0fd28f2bbd6a
2025-04-26 17:10:37,156 - app.api.endpoints.auth - INFO - Password verified for user: 4v0wnyrzx9@fixture.pytest.dev, User ID: 680d052f0fd28f2bbd6a
2025-04-26 17:09:21,084 - app.api.endpoints.auth - INFO - JWT created successfully for user: 4v0wnyrzx9@fixture.pytest.dev
2025-04-26 17:09:22,474 - app.core.chat_service - INFO - Created conversation 680d0532694050975987 for user 680d052f0fd28f2bbd6a
2025-04-26 17:09:22,844 - app.main - ERROR - Request failed: 'UserResponse' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 173, in check_rate_limit
    user_id = user.get("user_id", f"fallback_anon_{secrets.token_hex(4)}") # Added fallback just in case
              ^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'UserResponse' object has no attribute 'get'

2025-04-26 17:09:36,103 - app.main - ERROR - Request failed: 'UserResponse' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 173, in check_rate_limit
    user_id = user.get("user_id", f"fallback_anon_{secrets.token_hex(4)}") # Added fallback just in case
              ^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'UserResponse' object has no attribute 'get'

2025-04-26 17:09:37,307 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:23:19,557 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:26:52,742 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:26:52,768 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:51:32,719 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:53:04,062 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:53:04,099 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:55:59,659 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:56:00,079 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:56:00,563 - app.api.endpoints.auth - INFO - User registered successfully: 4rr4nblmh9@fixture.pytest.dev, ID: 680d10201111536366bd
2025-04-26 17:56:01,054 - app.api.endpoints.auth - INFO - Password verified for user: 4rr4nblmh9@fixture.pytest.dev, User ID: 680d10201111536366bd
2025-04-26 17:56:01,244 - app.api.endpoints.auth - INFO - JWT created successfully for user: 4rr4nblmh9@fixture.pytest.dev
2025-04-26 17:56:01,325 - app.core.chat_service - INFO - Created conversation 680d102145a06a41351a for user 680d10201111536366bd
2025-04-26 17:56:01,694 - app.main - ERROR - Request failed: 'Settings' object has no attribute 'RATE_LIMIT_WINDOW_SECONDS'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 134, in check_rate_limit
    window = settings.RATE_LIMIT_WINDOW_SECONDS
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Settings' object has no attribute 'RATE_LIMIT_WINDOW_SECONDS'

2025-04-26 17:56:13,896 - app.main - ERROR - Request failed: 'Settings' object has no attribute 'RATE_LIMIT_WINDOW_SECONDS'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 134, in check_rate_limit
    window = settings.RATE_LIMIT_WINDOW_SECONDS
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Settings' object has no attribute 'RATE_LIMIT_WINDOW_SECONDS'

2025-04-26 17:56:15,495 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:56:38,578 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 17:56:54,024 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:56:54,058 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:57:03,272 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 17:57:03,689 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 17:57:04,119 - app.api.endpoints.auth - INFO - User registered successfully: 7bs7htzg30@fixture.pytest.dev, ID: 680d105fe6063960ec3a
2025-04-26 17:57:04,436 - app.api.endpoints.auth - INFO - Password verified for user: 7bs7htzg30@fixture.pytest.dev, User ID: 680d105fe6063960ec3a
2025-04-26 17:57:04,619 - app.api.endpoints.auth - INFO - JWT created successfully for user: 7bs7htzg30@fixture.pytest.dev
2025-04-26 17:57:05,002 - app.core.chat_service - INFO - Created conversation 680d1060f13e79b5179e for user 680d105fe6063960ec3a
2025-04-26 17:57:05,331 - app.main - ERROR - Request failed: 'Settings' object has no attribute 'RATE_LIMIT_WINDOW_SECONDS'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 134, in check_rate_limit
    window = settings.RATE_LIMIT_WINDOW_SECONDS
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Settings' object has no attribute 'RATE_LIMIT_WINDOW_SECONDS'

2025-04-26 17:57:17,032 - app.main - ERROR - Request failed: 'Settings' object has no attribute 'RATE_LIMIT_WINDOW_SECONDS'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/dependencies.py", line 134, in check_rate_limit
    window = settings.RATE_LIMIT_WINDOW_SECONDS
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Settings' object has no attribute 'RATE_LIMIT_WINDOW_SECONDS'

2025-04-26 17:57:18,177 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 18:12:29,320 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 18:12:50,035 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 18:12:50,067 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 18:16:03,100 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 18:16:17,946 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 18:16:17,997 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 18:18:57,761 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 18:18:58,366 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 18:18:59,045 - app.api.endpoints.auth - INFO - User registered successfully: 9r08ecdj9j@fixture.pytest.dev, ID: 680d1582cea642c571e4
2025-04-26 18:18:59,580 - app.api.endpoints.auth - INFO - Password verified for user: 9r08ecdj9j@fixture.pytest.dev, User ID: 680d1582cea642c571e4
2025-04-26 18:18:59,835 - app.api.endpoints.auth - INFO - JWT created successfully for user: 9r08ecdj9j@fixture.pytest.dev
2025-04-26 18:19:00,378 - app.core.chat_service - INFO - Created conversation 680d15843c1851c92419 for user 680d1582cea642c571e4
2025-04-26 18:19:01,415 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 18:19:01,416 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 18:19:01,429 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 18:19:05,209 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 18:19:05,211 - app.core.chat_service - ERROR - Error formatting context: 'DocumentMetadata' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 383, in generate_rag_response
    book_name = metadata.get('book_name', "Unknown book")
                ^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'DocumentMetadata' object has no attribute 'get'
2025-04-26 18:19:07,159 - app.core.retrieval - INFO - Generated embedding for query: 'What is Zakat?...'
2025-04-26 18:19:07,160 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 18:19:07,168 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 18:19:08,051 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 18:19:08,053 - app.core.chat_service - ERROR - Error formatting context: 'DocumentMetadata' object has no attribute 'get'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/chat_service.py", line 383, in generate_rag_response
    book_name = metadata.get('book_name', "Unknown book")
                ^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'DocumentMetadata' object has no attribute 'get'
2025-04-26 18:19:08,690 - app.api.endpoints.chat - ERROR - Unexpected error retrieving messages for conversation 680d15843c1851c92419: 1 validation error for Message
message_id
  Field required [type=missing, input_value={'id': '680d1584e96f52172...1c92419', 'sources': []}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 117, in get_conversation_messages
    conversation_messages.append(Message(
                                 ~~~~~~~^
        id=doc.get('$id'),
        ^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        sources=sources_list
        ^^^^^^^^^^^^^^^^^^^^
    ))
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
message_id
  Field required [type=missing, input_value={'id': '680d1584e96f52172...1c92419', 'sources': []}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-04-26 18:19:19,476 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 18:45:41,625 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 18:46:04,474 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 18:46:04,505 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 18:47:36,716 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 18:47:59,092 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 18:47:59,143 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 18:51:48,936 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:03:59,029 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:03:59,082 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:04:38,553 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:04:39,031 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:04:39,664 - app.api.endpoints.auth - INFO - User registered successfully: ydurfu0h4w@fixture.pytest.dev, ID: 680d2037205853d11c46
2025-04-26 19:04:40,076 - app.api.endpoints.auth - INFO - Password verified for user: ydurfu0h4w@fixture.pytest.dev, User ID: 680d2037205853d11c46
2025-04-26 19:04:40,275 - app.api.endpoints.auth - INFO - JWT created successfully for user: ydurfu0h4w@fixture.pytest.dev
2025-04-26 19:04:40,708 - app.core.storage - ERROR - Failed to create conversation for user 680d2037205853d11c46: Invalid document structure: Unknown attribute: "last_updated"
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/conversations/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/storage.py", line 160, in create_new_conversation
    result = db.create_document(
        database_id=settings.APPWRITE_DATABASE_ID,
    ...<7 lines>...
        ]
    )
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Invalid document structure: Unknown attribute: "last_updated"
2025-04-26 19:04:51,342 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:05:30,846 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:05:46,680 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:05:46,718 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:07:16,545 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:07:36,694 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:07:36,730 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:10:27,427 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:24:04,149 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:24:04,197 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:24:35,669 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:24:36,238 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:24:37,745 - app.api.endpoints.auth - INFO - User registered successfully: w7tdzq781h@fixture.pytest.dev, ID: 680d24e4f1a2f466ce64
2025-04-26 19:25:55,725 - app.api.endpoints.auth - INFO - Password verified for user: w7tdzq781h@fixture.pytest.dev, User ID: 680d24e4f1a2f466ce64
2025-04-26 19:24:39,972 - app.api.endpoints.auth - INFO - JWT created successfully for user: w7tdzq781h@fixture.pytest.dev
2025-04-26 19:24:41,497 - app.core.storage - ERROR - Failed to create conversation for user 680d24e4f1a2f466ce64: Invalid document structure: Unknown attribute: "last_updated"
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 115, in call
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://cloud.appwrite.io/v1/databases/arabia_db/collections/conversations/documents

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/storage.py", line 160, in create_new_conversation
    result = db.create_document(
        database_id=settings.APPWRITE_DATABASE_ID,
    ...<7 lines>...
        ]
    )
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/services/databases.py", line 913, in create_document
    return self.client.call('post', api_path, {
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
        'content-type': 'application/json',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    }, api_params)
    ^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/appwrite/client.py", line 135, in call
    raise AppwriteException(response.json()['message'], response.status_code, response.json().get('type'), response.text)
appwrite.exception.AppwriteException: Invalid document structure: Unknown attribute: "last_updated"
2025-04-26 19:24:51,227 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:36:18,606 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:36:33,969 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:36:34,025 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:38:38,492 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:38:38,929 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:37:22,519 - app.api.endpoints.auth - INFO - User registered successfully: aanimvjtyn@fixture.pytest.dev, ID: 680d27e2a09dfbb96385
2025-04-26 19:37:24,753 - app.api.endpoints.auth - INFO - Password verified for user: aanimvjtyn@fixture.pytest.dev, User ID: 680d27e2a09dfbb96385
2025-04-26 19:37:26,699 - app.api.endpoints.auth - INFO - JWT created successfully for user: aanimvjtyn@fixture.pytest.dev
2025-04-26 19:37:29,687 - app.core.storage - INFO - Attempting to create conversation conv_fe1b7595f8d049db84619d07880dbdf9 for user 680d27e2a09dfbb96385
2025-04-26 19:37:30,693 - app.main - ERROR - Request failed: name 'AppwriteException' is not defined
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 147, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/main.py", line 65, in add_process_time_header
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 153, in call_next
    raise app_exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 140, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 76, in create_conversation_endpoint
    return create_new_conversation(db=db, user_id=user.user_id, is_anonymous=user.is_anonymous)
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/storage.py", line 165, in create_new_conversation
    except AppwriteException as e:
           ^^^^^^^^^^^^^^^^^
NameError: name 'AppwriteException' is not defined

2025-04-26 19:37:43,479 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:44:12,607 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:44:29,751 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:44:29,845 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:44:35,897 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:44:36,484 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:44:37,039 - app.api.endpoints.auth - INFO - User registered successfully: 0w249v8dx0@fixture.pytest.dev, ID: 680d29945072a1ea8b0f
2025-04-26 19:44:37,023 - app.api.endpoints.auth - INFO - Password verified for user: 0w249v8dx0@fixture.pytest.dev, User ID: 680d29945072a1ea8b0f
2025-04-26 19:44:37,226 - app.api.endpoints.auth - INFO - JWT created successfully for user: 0w249v8dx0@fixture.pytest.dev
2025-04-26 19:44:37,524 - app.core.storage - INFO - Attempting to create conversation conv_78d670d27391407998c29f9e978184d5 for user 680d29945072a1ea8b0f
2025-04-26 19:44:37,730 - app.core.storage - ERROR - Failed to create conversation for user 680d29945072a1ea8b0f: Invalid `documentId` param: Parameter must contain at most 36 chars. Valid chars are a-z, A-Z, 0-9, period, hyphen, and underscore. Can't start with a special char
2025-04-26 19:44:49,455 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:47:12,665 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:47:13,101 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 19:47:14,319 - app.api.endpoints.auth - INFO - User registered successfully: nh1ol2pd18@fixture.pytest.dev, ID: 680d29e456c94c822449
2025-04-26 19:47:15,298 - app.api.endpoints.auth - INFO - Password verified for user: nh1ol2pd18@fixture.pytest.dev, User ID: 680d29e456c94c822449
2025-04-26 19:47:15,481 - app.api.endpoints.auth - INFO - JWT created successfully for user: nh1ol2pd18@fixture.pytest.dev
2025-04-26 19:47:15,709 - app.core.storage - INFO - Attempting to create conversation conv_cb26abfe2d194dfda79eff6435bf770f for user 680d29e456c94c822449
2025-04-26 19:47:15,919 - app.core.storage - ERROR - Failed to create conversation for user 680d29e456c94c822449: Invalid `documentId` param: Parameter must contain at most 36 chars. Valid chars are a-z, A-Z, 0-9, period, hyphen, and underscore. Can't start with a special char
2025-04-26 19:46:08,740 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 20:00:51,000 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 19:59:49,849 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 19:59:49,891 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 20:01:37,120 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 20:01:37,865 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 20:01:39,821 - app.api.endpoints.auth - INFO - User registered successfully: xshjv4kgvr@fixture.pytest.dev, ID: 680d2d935fea2dab5f68
2025-04-26 20:01:43,167 - app.api.endpoints.auth - INFO - Password verified for user: xshjv4kgvr@fixture.pytest.dev, User ID: 680d2d935fea2dab5f68
2025-04-26 20:01:46,008 - app.api.endpoints.auth - INFO - JWT created successfully for user: xshjv4kgvr@fixture.pytest.dev
2025-04-26 20:01:47,151 - app.core.storage - INFO - Attempting to create conversation a3ba30d57b98420c96c68db57fdc0e37 for user 680d2d935fea2dab5f68
2025-04-26 20:01:48,176 - app.core.storage - ERROR - Failed to create conversation for user 680d2d935fea2dab5f68: Invalid document structure: Unknown attribute: "is_anonymous"
2025-04-26 20:02:00,090 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 20:17:48,223 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 20:17:48,761 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 20:17:50,142 - app.api.endpoints.auth - INFO - User registered successfully: 3rk1ycegni@fixture.pytest.dev, ID: 680d315dd290b49daae5
2025-04-26 20:17:55,422 - app.api.endpoints.auth - INFO - Password verified for user: 3rk1ycegni@fixture.pytest.dev, User ID: 680d315dd290b49daae5
2025-04-26 20:17:57,055 - app.api.endpoints.auth - INFO - JWT created successfully for user: 3rk1ycegni@fixture.pytest.dev
2025-04-26 20:17:57,299 - app.core.storage - INFO - Attempting to create conversation 930635ce8a5543eb8e403fd49219e685 for user 680d315dd290b49daae5
2025-04-26 20:17:57,529 - app.core.storage - ERROR - Failed to create conversation for user 680d315dd290b49daae5: Invalid document structure: Unknown attribute: "is_anonymous"
2025-04-26 20:18:10,013 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 20:21:50,477 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 20:21:50,947 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 20:21:51,358 - app.api.endpoints.auth - INFO - User registered successfully: bnpur5e6x6@fixture.pytest.dev, ID: 680d324f299cbf6756d2
2025-04-26 20:21:51,738 - app.api.endpoints.auth - INFO - Password verified for user: bnpur5e6x6@fixture.pytest.dev, User ID: 680d324f299cbf6756d2
2025-04-26 20:21:51,873 - app.api.endpoints.auth - INFO - JWT created successfully for user: bnpur5e6x6@fixture.pytest.dev
2025-04-26 20:21:52,093 - app.core.storage - INFO - Attempting to create conversation f331c5f53aa94f0eb9410b7f73582a13 for user 680d324f299cbf6756d2
2025-04-26 20:21:52,303 - app.core.storage - ERROR - Failed to create conversation for user 680d324f299cbf6756d2: Invalid document structure: Attribute "created_at" has invalid type. Value must be a valid string and no longer than 30 chars
2025-04-26 20:22:02,874 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 20:57:38,051 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 20:56:40,066 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 20:56:40,100 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 20:59:49,502 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 20:59:50,038 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 20:59:50,736 - app.api.endpoints.auth - INFO - User registered successfully: nqqhv43ajq@fixture.pytest.dev, ID: 680d3b367c9753a594c5
2025-04-26 20:59:51,554 - app.api.endpoints.auth - INFO - Password verified for user: nqqhv43ajq@fixture.pytest.dev, User ID: 680d3b367c9753a594c5
2025-04-26 20:59:51,776 - app.api.endpoints.auth - INFO - JWT created successfully for user: nqqhv43ajq@fixture.pytest.dev
2025-04-26 20:59:52,065 - app.core.storage - INFO - Attempting to create conversation 656f85c5408a40d3a6da72d108f09df0 for user 680d3b367c9753a594c5
2025-04-26 20:59:52,255 - app.core.storage - ERROR - Failed to create conversation for user 680d3b367c9753a594c5: Invalid document structure: Attribute "created_at" has invalid type. Value must be a valid string and no longer than 30 chars
2025-04-26 21:00:03,823 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 21:07:38,955 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 21:07:59,143 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 21:07:59,182 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 21:10:19,517 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 21:10:19,936 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 21:10:21,577 - app.api.endpoints.auth - INFO - User registered successfully: f9omkfopim@fixture.pytest.dev, ID: 680d3dac84eac00b599f
2025-04-26 21:10:22,473 - app.api.endpoints.auth - INFO - Password verified for user: f9omkfopim@fixture.pytest.dev, User ID: 680d3dac84eac00b599f
2025-04-26 21:10:23,039 - app.api.endpoints.auth - INFO - JWT created successfully for user: f9omkfopim@fixture.pytest.dev
2025-04-26 21:10:23,948 - app.core.storage - INFO - Attempting to create conversation dd499d821d7a485788d25a60b90a713f for user 680d3dac84eac00b599f
2025-04-26 21:10:24,129 - app.core.storage - INFO - Successfully created conversation dd499d821d7a485788d25a60b90a713f
2025-04-26 21:10:27,609 - app.core.storage - INFO - Stored message 680d3db37efdaab14147 for user 680d3dac84eac00b599f
2025-04-26 21:10:27,609 - app.core.chat_service - INFO - Stored user message (ID: 680d3db37efdaab14147) for conversation dd499d821d7a485788d25a60b90a713f
2025-04-26 21:10:28,464 - app.core.storage - ERROR - Failed to update timestamp for conversation dd499d821d7a485788d25a60b90a713f: Invalid document structure: Unknown attribute: "last_updated"
2025-04-26 21:10:28,815 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 21:10:28,816 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 21:10:28,822 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 21:10:31,680 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 21:10:31,682 - app.core.chat_service - INFO - Retrieved 5 documents for conversation dd499d821d7a485788d25a60b90a713f
2025-04-26 21:10:31,682 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation dd499d821d7a485788d25a60b90a713f...
2025-04-26 21:10:31,683 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 21:10:32,150 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 21:10:32,150 - app.core.chat_service - INFO - Successfully used Mistral response for conversation dd499d821d7a485788d25a60b90a713f.
2025-04-26 21:10:32,151 - app.core.chat_service - INFO - LLM call finished for dd499d821d7a485788d25a60b90a713f. Model: mistral, Fallback: False. Answer length: 93
2025-04-26 21:10:32,319 - app.core.storage - INFO - Stored message 680d3db8419aa02ece54 for user ai
2025-04-26 21:10:36,847 - app.core.storage - INFO - Stored 5 sources for message 680d3db8419aa02ece54
2025-04-26 21:10:36,848 - app.core.chat_service - INFO - Stored AI message (ID: 680d3db8419aa02ece54) for conversation dd499d821d7a485788d25a60b90a713f
2025-04-26 21:10:37,547 - app.core.storage - ERROR - Failed to update timestamp for conversation dd499d821d7a485788d25a60b90a713f: Invalid document structure: Unknown attribute: "last_updated"
2025-04-26 21:10:39,306 - app.core.storage - INFO - Stored message 680d3dbf42709beefa2e for user 680d3dac84eac00b599f
2025-04-26 21:10:39,307 - app.core.chat_service - INFO - Stored user message (ID: 680d3dbf42709beefa2e) for conversation dd499d821d7a485788d25a60b90a713f
2025-04-26 21:10:39,502 - app.core.storage - ERROR - Failed to update timestamp for conversation dd499d821d7a485788d25a60b90a713f: Invalid document structure: Unknown attribute: "last_updated"
2025-04-26 21:10:41,978 - app.core.retrieval - INFO - Generated embedding for query: 'What is Zakat?...'
2025-04-26 21:10:41,978 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 21:10:41,983 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 21:10:42,656 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 21:10:42,658 - app.core.chat_service - INFO - Retrieved 5 documents for conversation dd499d821d7a485788d25a60b90a713f
2025-04-26 21:10:42,659 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation dd499d821d7a485788d25a60b90a713f...
2025-04-26 21:10:42,659 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 21:10:43,326 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 21:10:43,327 - app.core.chat_service - INFO - Successfully used Mistral response for conversation dd499d821d7a485788d25a60b90a713f.
2025-04-26 21:10:43,327 - app.core.chat_service - INFO - LLM call finished for dd499d821d7a485788d25a60b90a713f. Model: mistral, Fallback: False. Answer length: 126
2025-04-26 21:10:45,010 - app.core.storage - INFO - Stored message 680d3dc4c5b685119d8b for user ai
2025-04-26 21:10:47,152 - app.core.storage - INFO - Stored 5 sources for message 680d3dc4c5b685119d8b
2025-04-26 21:10:47,153 - app.core.chat_service - INFO - Stored AI message (ID: 680d3dc4c5b685119d8b) for conversation dd499d821d7a485788d25a60b90a713f
2025-04-26 21:10:47,827 - app.core.storage - ERROR - Failed to update timestamp for conversation dd499d821d7a485788d25a60b90a713f: Invalid document structure: Unknown attribute: "last_updated"
2025-04-26 21:10:48,769 - app.api.endpoints.chat - ERROR - Unexpected error retrieving messages for conversation dd499d821d7a485788d25a60b90a713f: 1 validation error for Message
message_id
  Field required [type=missing, input_value={'id': '680d3db37efdaab14....330216', 'sources': []}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 139, in get_conversation_messages
    message_model = Message(
        id=doc.get('$id'),
    ...<5 lines>...
        sources=[]  # Placeholder - see TODO above
    )
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
message_id
  Field required [type=missing, input_value={'id': '680d3db37efdaab14....330216', 'sources': []}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-04-26 21:10:58,514 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 21:13:58,656 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 21:13:59,124 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 21:13:59,749 - app.api.endpoints.auth - INFO - User registered successfully: bcgkmpw04m@fixture.pytest.dev, ID: 680d3e876d495dd1262f
2025-04-26 21:14:00,177 - app.api.endpoints.auth - INFO - Password verified for user: bcgkmpw04m@fixture.pytest.dev, User ID: 680d3e876d495dd1262f
2025-04-26 21:14:00,775 - app.api.endpoints.auth - INFO - JWT created successfully for user: bcgkmpw04m@fixture.pytest.dev
2025-04-26 21:14:00,973 - app.core.storage - INFO - Attempting to create conversation 5b6b84b13aa54031a9ac770d0c202add for user 680d3e876d495dd1262f
2025-04-26 21:14:01,173 - app.core.storage - INFO - Successfully created conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:03,134 - app.core.storage - INFO - Stored message 680d3e89c6cfb06e13e7 for user 680d3e876d495dd1262f
2025-04-26 21:14:03,134 - app.core.chat_service - INFO - Stored user message (ID: 680d3e89c6cfb06e13e7) for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:03,895 - app.core.storage - INFO - Timestamp updated for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:04,112 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 21:14:04,113 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 21:14:04,119 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 21:14:05,478 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 21:14:05,480 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:05,481 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 5b6b84b13aa54031a9ac770d0c202add...
2025-04-26 21:14:05,481 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 21:14:06,407 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 21:14:06,408 - app.core.chat_service - INFO - Successfully used Mistral response for conversation 5b6b84b13aa54031a9ac770d0c202add.
2025-04-26 21:14:06,409 - app.core.chat_service - INFO - LLM call finished for 5b6b84b13aa54031a9ac770d0c202add. Model: mistral, Fallback: False. Answer length: 156
2025-04-26 21:14:07,959 - app.core.storage - INFO - Stored message 680d3e8f13fc89c4780f for user ai
2025-04-26 21:14:09,850 - app.core.storage - INFO - Stored 5 sources for message 680d3e8f13fc89c4780f
2025-04-26 21:14:09,851 - app.core.chat_service - INFO - Stored AI message (ID: 680d3e8f13fc89c4780f) for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:10,743 - app.core.storage - INFO - Timestamp updated for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:14,047 - app.core.storage - INFO - Stored message 680d3e9518cb5e935f83 for user 680d3e876d495dd1262f
2025-04-26 21:14:14,047 - app.core.chat_service - INFO - Stored user message (ID: 680d3e9518cb5e935f83) for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:14,301 - app.core.storage - INFO - Timestamp updated for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:14,601 - app.core.retrieval - INFO - Generated embedding for query: 'What is Zakat?...'
2025-04-26 21:14:14,601 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 21:14:14,606 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 21:14:15,266 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 21:14:15,268 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:15,269 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 5b6b84b13aa54031a9ac770d0c202add...
2025-04-26 21:14:15,269 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 21:14:15,431 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-26 21:14:15,431 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.35 seconds (calculated)...
2025-04-26 21:14:17,297 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 21:14:17,298 - app.core.chat_service - INFO - Successfully used Mistral response for conversation 5b6b84b13aa54031a9ac770d0c202add.
2025-04-26 21:14:17,298 - app.core.chat_service - INFO - LLM call finished for 5b6b84b13aa54031a9ac770d0c202add. Model: mistral, Fallback: False. Answer length: 101
2025-04-26 21:14:17,926 - app.core.storage - INFO - Stored message 680d3e99b3e90915bee9 for user ai
2025-04-26 21:14:22,637 - app.core.storage - INFO - Stored 5 sources for message 680d3e99b3e90915bee9
2025-04-26 21:14:22,637 - app.core.chat_service - INFO - Stored AI message (ID: 680d3e99b3e90915bee9) for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:23,989 - app.core.storage - INFO - Timestamp updated for conversation 5b6b84b13aa54031a9ac770d0c202add
2025-04-26 21:14:26,209 - app.api.endpoints.chat - ERROR - Unexpected error retrieving messages for conversation 5b6b84b13aa54031a9ac770d0c202add: 1 validation error for Message
message_id
  Field required [type=missing, input_value={'id': '680d3e89c6cfb06e1....377246', 'sources': []}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 139, in get_conversation_messages
    message_model = Message(
        id=doc.get('$id'),
    ...<5 lines>...
        sources=[]  # Placeholder - see TODO above
    )
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/.venv/lib/python3.13/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
message_id
  Field required [type=missing, input_value={'id': '680d3e89c6cfb06e1....377246', 'sources': []}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-04-26 21:14:35,828 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 21:21:39,852 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 21:21:44,927 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 21:21:45,361 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 21:21:47,449 - app.api.endpoints.auth - INFO - User registered successfully: d1mgyc6mms@fixture.pytest.dev, ID: 680d405adc2302c6ba97
2025-04-26 21:21:47,853 - app.api.endpoints.auth - INFO - Password verified for user: d1mgyc6mms@fixture.pytest.dev, User ID: 680d405adc2302c6ba97
2025-04-26 21:21:51,300 - app.api.endpoints.auth - INFO - JWT created successfully for user: d1mgyc6mms@fixture.pytest.dev
2025-04-26 21:21:51,497 - app.core.storage - INFO - Attempting to create conversation 6fd9634f16c945258cbb39989b269ec9 for user 680d405adc2302c6ba97
2025-04-26 21:21:51,676 - app.core.storage - INFO - Successfully created conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:21:52,165 - app.core.storage - INFO - Stored message 680d405fe5029982d16f for user 680d405adc2302c6ba97
2025-04-26 21:21:52,166 - app.core.chat_service - INFO - Stored user message (ID: 680d405fe5029982d16f) for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:21:52,444 - app.core.storage - INFO - Timestamp updated for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:21:52,808 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 21:21:52,808 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 21:21:52,815 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 21:21:55,654 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 21:21:55,657 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:21:55,657 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 6fd9634f16c945258cbb39989b269ec9...
2025-04-26 21:21:55,658 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 21:21:56,111 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 21:21:56,112 - app.core.chat_service - INFO - Successfully used Mistral response for conversation 6fd9634f16c945258cbb39989b269ec9.
2025-04-26 21:21:56,113 - app.core.chat_service - INFO - LLM call finished for 6fd9634f16c945258cbb39989b269ec9. Model: mistral, Fallback: False. Answer length: 85
2025-04-26 21:21:56,326 - app.core.storage - INFO - Stored message 680d4064280dfb548e64 for user ai
2025-04-26 21:21:57,467 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 21:21:57,505 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 21:21:58,877 - app.core.storage - INFO - Stored 5 sources for message 680d4064280dfb548e64
2025-04-26 21:21:58,879 - app.core.chat_service - INFO - Stored AI message (ID: 680d4064280dfb548e64) for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:22:00,885 - app.core.storage - INFO - Timestamp updated for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:22:02,240 - app.core.storage - INFO - Stored message 680d406a01c60aa3a6b5 for user 680d405adc2302c6ba97
2025-04-26 21:22:02,242 - app.core.chat_service - INFO - Stored user message (ID: 680d406a01c60aa3a6b5) for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:22:02,444 - app.core.storage - INFO - Timestamp updated for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:22:02,690 - app.core.retrieval - INFO - Generated embedding for query: 'What is Zakat?...'
2025-04-26 21:22:02,691 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 21:22:02,696 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 21:22:03,468 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 21:22:03,471 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:22:03,472 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 6fd9634f16c945258cbb39989b269ec9...
2025-04-26 21:22:03,473 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 21:22:04,058 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 21:22:04,059 - app.core.chat_service - INFO - Successfully used Mistral response for conversation 6fd9634f16c945258cbb39989b269ec9.
2025-04-26 21:22:04,059 - app.core.chat_service - INFO - LLM call finished for 6fd9634f16c945258cbb39989b269ec9. Model: mistral, Fallback: False. Answer length: 122
2025-04-26 21:22:04,238 - app.core.storage - INFO - Stored message 680d406bd14a87c6f946 for user ai
2025-04-26 21:22:05,083 - app.core.storage - INFO - Stored 5 sources for message 680d406bd14a87c6f946
2025-04-26 21:22:05,084 - app.core.chat_service - INFO - Stored AI message (ID: 680d406bd14a87c6f946) for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:22:05,256 - app.core.storage - INFO - Timestamp updated for conversation 6fd9634f16c945258cbb39989b269ec9
2025-04-26 21:22:05,859 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 21:33:58,456 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 21:33:58,864 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 21:33:59,751 - app.api.endpoints.auth - INFO - User registered successfully: ntx7xouib7@fixture.pytest.dev, ID: 680d43376d31e48c47c6
2025-04-26 21:34:00,098 - app.api.endpoints.auth - INFO - Password verified for user: ntx7xouib7@fixture.pytest.dev, User ID: 680d43376d31e48c47c6
2025-04-26 21:34:05,361 - app.api.endpoints.auth - INFO - JWT created successfully for user: ntx7xouib7@fixture.pytest.dev
2025-04-26 21:34:05,591 - app.core.storage - INFO - Attempting to create conversation 3049495578ea4544abb8484f45909395 for user 680d43376d31e48c47c6
2025-04-26 21:34:05,793 - app.core.storage - INFO - Successfully created conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:07,658 - app.core.storage - INFO - Stored message 680d433f94d8f2444a28 for user 680d43376d31e48c47c6
2025-04-26 21:34:07,658 - app.core.chat_service - INFO - Stored user message (ID: 680d433f94d8f2444a28) for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:10,412 - app.core.storage - INFO - Timestamp updated for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:10,728 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 21:34:10,728 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 21:34:10,735 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 21:34:12,193 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 21:34:12,392 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 21:34:12,394 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:12,395 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 3049495578ea4544abb8484f45909395...
2025-04-26 21:34:12,396 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 21:34:13,136 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 21:34:13,137 - app.core.chat_service - INFO - Successfully used Mistral response for conversation 3049495578ea4544abb8484f45909395.
2025-04-26 21:34:13,137 - app.core.chat_service - INFO - LLM call finished for 3049495578ea4544abb8484f45909395. Model: mistral, Fallback: False. Answer length: 63
2025-04-26 21:34:13,319 - app.core.storage - INFO - Stored message 680d434541f8f0b9cd51 for user ai
2025-04-26 21:34:14,407 - app.core.storage - INFO - Stored 5 sources for message 680d434541f8f0b9cd51
2025-04-26 21:34:14,408 - app.core.chat_service - INFO - Stored AI message (ID: 680d434541f8f0b9cd51) for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:14,556 - app.core.storage - INFO - Timestamp updated for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:16,359 - app.core.storage - INFO - Stored message 680d43482c56c405584d for user 680d43376d31e48c47c6
2025-04-26 21:34:16,360 - app.core.chat_service - INFO - Stored user message (ID: 680d43482c56c405584d) for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:16,535 - app.core.storage - INFO - Timestamp updated for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:16,782 - app.core.retrieval - INFO - Generated embedding for query: 'What is Zakat?...'
2025-04-26 21:34:16,783 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 21:34:16,787 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 21:34:17,508 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 21:34:17,509 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:17,511 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 3049495578ea4544abb8484f45909395...
2025-04-26 21:34:17,511 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 21:34:18,307 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 21:34:18,308 - app.core.chat_service - INFO - Successfully used Mistral response for conversation 3049495578ea4544abb8484f45909395.
2025-04-26 21:34:18,308 - app.core.chat_service - INFO - LLM call finished for 3049495578ea4544abb8484f45909395. Model: mistral, Fallback: False. Answer length: 188
2025-04-26 21:34:18,509 - app.core.storage - INFO - Stored message 680d434a729e0395d769 for user ai
2025-04-26 21:34:20,414 - app.core.storage - INFO - Stored 5 sources for message 680d434a729e0395d769
2025-04-26 21:34:20,414 - app.core.chat_service - INFO - Stored AI message (ID: 680d434a729e0395d769) for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:20,645 - app.core.storage - INFO - Timestamp updated for conversation 3049495578ea4544abb8484f45909395
2025-04-26 21:34:21,556 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 21:34:26,286 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 21:34:26,318 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 22:57:52,196 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 22:58:07,697 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 22:58:07,731 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:01:37,661 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:15:21,402 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:15:21,443 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:16:44,216 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:17:01,866 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:17:02,824 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:17:03,327 - app.api.endpoints.auth - INFO - User registered successfully: c4uadvsim2@fixture.pytest.dev, ID: 680d5b5ec3ee650c7eac
2025-04-26 23:17:03,747 - app.api.endpoints.auth - INFO - Password verified for user: c4uadvsim2@fixture.pytest.dev, User ID: 680d5b5ec3ee650c7eac
2025-04-26 23:17:03,924 - app.api.endpoints.auth - INFO - JWT created successfully for user: c4uadvsim2@fixture.pytest.dev
2025-04-26 23:17:04,172 - app.core.storage - INFO - Attempting to create conversation 290ca01365664a7281c5e181e0cb8794 for user 680d5b5ec3ee650c7eac
2025-04-26 23:17:04,503 - app.core.storage - INFO - Successfully created conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:05,228 - app.core.storage - INFO - Stored message 680d5b60a75a14cc8906 for user 680d5b5ec3ee650c7eac
2025-04-26 23:17:05,229 - app.core.chat_service - INFO - Stored user message (ID: 680d5b60a75a14cc8906) for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:04,938 - app.core.storage - INFO - Timestamp updated for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:05,111 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:17:05,152 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:17:05,331 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 23:17:05,332 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:17:05,338 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:17:06,784 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 23:17:06,787 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:06,787 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 290ca01365664a7281c5e181e0cb8794...
2025-04-26 23:17:06,788 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:17:07,321 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:17:07,322 - app.core.chat_service - INFO - Mistral response successful for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:07,523 - app.core.storage - INFO - Stored message 680d5b633a1d71aa0970 for user ai
2025-04-26 23:17:08,597 - app.core.storage - INFO - Stored 5 sources for message 680d5b633a1d71aa0970
2025-04-26 23:17:08,602 - app.core.chat_service - INFO - Stored AI message (ID: 680d5b633a1d71aa0970) for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:08,790 - app.core.storage - INFO - Timestamp updated for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:10,326 - app.core.storage - INFO - Stored message 680d5b65c181d2d8e883 for user 680d5b5ec3ee650c7eac
2025-04-26 23:17:10,327 - app.core.chat_service - INFO - Stored user message (ID: 680d5b65c181d2d8e883) for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:10,015 - app.core.storage - INFO - Timestamp updated for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:10,258 - app.core.retrieval - INFO - Generated embedding for query: 'What is Zakat?...'
2025-04-26 23:17:10,260 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:17:10,276 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:17:11,001 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 23:17:11,004 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:11,006 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 290ca01365664a7281c5e181e0cb8794...
2025-04-26 23:17:11,006 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:17:11,558 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:17:11,558 - app.core.chat_service - INFO - Mistral response successful for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:11,775 - app.core.storage - INFO - Stored message 680d5b6787ae988e51ce for user ai
2025-04-26 23:17:12,768 - app.core.storage - INFO - Stored 5 sources for message 680d5b6787ae988e51ce
2025-04-26 23:17:12,769 - app.core.chat_service - INFO - Stored AI message (ID: 680d5b6787ae988e51ce) for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:12,957 - app.core.storage - INFO - Timestamp updated for conversation 290ca01365664a7281c5e181e0cb8794
2025-04-26 23:17:13,633 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:19:40,120 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:19:40,644 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:19:40,667 - app.api.endpoints.auth - INFO - User registered successfully: te588jgnid@fixture.pytest.dev, ID: 680d5bfc69bde57ca3f5
2025-04-26 23:19:41,085 - app.api.endpoints.auth - INFO - Password verified for user: te588jgnid@fixture.pytest.dev, User ID: 680d5bfc69bde57ca3f5
2025-04-26 23:19:41,270 - app.api.endpoints.auth - INFO - JWT created successfully for user: te588jgnid@fixture.pytest.dev
2025-04-26 23:19:41,560 - app.core.storage - INFO - Attempting to create conversation 105ad6a0e86043e0b0abfb3df2749de5 for user 680d5bfc69bde57ca3f5
2025-04-26 23:19:41,770 - app.core.storage - INFO - Successfully created conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:42,363 - app.core.storage - INFO - Stored message 680d5bfe1e92d17275de for user 680d5bfc69bde57ca3f5
2025-04-26 23:19:42,364 - app.core.chat_service - INFO - Stored user message (ID: 680d5bfe1e92d17275de) for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:42,598 - app.core.storage - INFO - Timestamp updated for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:43,023 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 23:19:43,024 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:19:43,029 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:19:45,037 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 23:19:45,039 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:45,040 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 105ad6a0e86043e0b0abfb3df2749de5...
2025-04-26 23:19:45,040 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:21:01,804 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:21:01,805 - app.core.chat_service - INFO - Mistral response successful for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:45,433 - app.core.storage - INFO - Stored message 680d5c0159742b1e9d39 for user ai
2025-04-26 23:19:46,467 - app.core.storage - INFO - Stored 5 sources for message 680d5c0159742b1e9d39
2025-04-26 23:19:46,467 - app.core.chat_service - INFO - Stored AI message (ID: 680d5c0159742b1e9d39) for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:46,683 - app.core.storage - INFO - Timestamp updated for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:48,253 - app.core.storage - INFO - Stored message 680d5c03e2fdf5d4d7ff for user 680d5bfc69bde57ca3f5
2025-04-26 23:19:48,253 - app.core.chat_service - INFO - Stored user message (ID: 680d5c03e2fdf5d4d7ff) for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:48,444 - app.core.storage - INFO - Timestamp updated for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:48,699 - app.core.retrieval - INFO - Generated embedding for query: 'What was my last message?...'
2025-04-26 23:19:48,700 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:19:48,706 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:19:49,430 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 23:19:49,432 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:49,433 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 105ad6a0e86043e0b0abfb3df2749de5...
2025-04-26 23:19:49,434 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:19:49,643 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-26 23:19:49,643 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.98 seconds (calculated)...
2025-04-26 23:19:51,608 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:19:51,609 - app.core.chat_service - INFO - Mistral response successful for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:51,798 - app.core.storage - INFO - Stored message 680d5c0795080e48a9f2 for user ai
2025-04-26 23:19:52,899 - app.core.storage - INFO - Stored 5 sources for message 680d5c0795080e48a9f2
2025-04-26 23:19:52,900 - app.core.chat_service - INFO - Stored AI message (ID: 680d5c0795080e48a9f2) for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:53,108 - app.core.storage - INFO - Timestamp updated for conversation 105ad6a0e86043e0b0abfb3df2749de5
2025-04-26 23:19:56,219 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:20:03,551 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:20:10,721 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:20:10,753 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:22:32,328 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:22:32,789 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:22:33,209 - app.api.endpoints.auth - INFO - User registered successfully: 533fft9tob@fixture.pytest.dev, ID: 680d5ca8bc65ffbd229e
2025-04-26 23:22:33,578 - app.api.endpoints.auth - INFO - Password verified for user: 533fft9tob@fixture.pytest.dev, User ID: 680d5ca8bc65ffbd229e
2025-04-26 23:22:33,777 - app.api.endpoints.auth - INFO - JWT created successfully for user: 533fft9tob@fixture.pytest.dev
2025-04-26 23:22:33,987 - app.core.storage - INFO - Attempting to create conversation 66e80f4bc30f45eea5197e4e767354ef for user 680d5ca8bc65ffbd229e
2025-04-26 23:22:34,186 - app.core.storage - INFO - Successfully created conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:34,779 - app.core.storage - INFO - Stored message 680d5caa54b54c65b9fb for user 680d5ca8bc65ffbd229e
2025-04-26 23:22:34,780 - app.core.chat_service - INFO - Stored user message (ID: 680d5caa54b54c65b9fb) for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:35,002 - app.core.storage - INFO - Timestamp updated for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:35,603 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 23:22:35,604 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:22:35,609 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:22:36,507 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 23:22:36,510 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:36,511 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 66e80f4bc30f45eea5197e4e767354ef...
2025-04-26 23:22:36,511 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:22:40,661 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:22:40,663 - app.core.chat_service - INFO - Mistral response successful for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:40,891 - app.core.storage - INFO - Stored message 680d5cb0c41d9954da27 for user ai
2025-04-26 23:22:42,136 - app.core.storage - INFO - Stored 5 sources for message 680d5cb0c41d9954da27
2025-04-26 23:22:42,137 - app.core.chat_service - INFO - Stored AI message (ID: 680d5cb0c41d9954da27) for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:42,358 - app.core.storage - INFO - Timestamp updated for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:43,984 - app.core.storage - INFO - Stored message 680d5cb39a96356943fb for user 680d5ca8bc65ffbd229e
2025-04-26 23:22:43,985 - app.core.chat_service - INFO - Stored user message (ID: 680d5cb39a96356943fb) for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:44,203 - app.core.storage - INFO - Timestamp updated for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:44,444 - app.core.retrieval - INFO - Generated embedding for query: 'What was my last message?...'
2025-04-26 23:22:44,444 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:22:44,450 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:22:45,200 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 23:22:45,202 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:45,203 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 66e80f4bc30f45eea5197e4e767354ef...
2025-04-26 23:22:45,204 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:22:45,757 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:22:45,757 - app.core.chat_service - INFO - Mistral response successful for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:45,989 - app.core.storage - INFO - Stored message 680d5cb56ccbddc383c8 for user ai
2025-04-26 23:22:46,541 - app.core.storage - INFO - Stored 5 sources for message 680d5cb56ccbddc383c8
2025-04-26 23:22:46,542 - app.core.chat_service - INFO - Stored AI message (ID: 680d5cb56ccbddc383c8) for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:46,724 - app.core.storage - INFO - Timestamp updated for conversation 66e80f4bc30f45eea5197e4e767354ef
2025-04-26 23:22:56,387 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:23:00,780 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:23:15,863 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:23:15,890 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:26:08,564 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:26:25,067 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:26:25,109 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:32:22,904 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:32:38,769 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:32:38,806 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:32:43,311 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:32:43,757 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:32:44,348 - app.api.endpoints.auth - INFO - User registered successfully: io0xt81mft@fixture.pytest.dev, ID: 680d5f0bdd38db8c38d9
2025-04-26 23:32:44,796 - app.api.endpoints.auth - INFO - Password verified for user: io0xt81mft@fixture.pytest.dev, User ID: 680d5f0bdd38db8c38d9
2025-04-26 23:32:44,972 - app.api.endpoints.auth - INFO - JWT created successfully for user: io0xt81mft@fixture.pytest.dev
2025-04-26 23:32:45,222 - app.core.storage - INFO - Attempting to create conversation 9a214d636d2d494f801bbfe660d41359 for user 680d5f0bdd38db8c38d9
2025-04-26 23:32:45,415 - app.core.storage - INFO - Successfully created conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:46,057 - app.core.storage - INFO - Stored message 680d5f0d9b719c10955c for user 680d5f0bdd38db8c38d9
2025-04-26 23:32:46,057 - app.core.chat_service - INFO - Stored user message (ID: 680d5f0d9b719c10955c) for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:46,263 - app.core.storage - INFO - Timestamp updated for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:46,595 - app.core.retrieval - INFO - Generated embedding for query: 'Tell me about the pillars of Islam....'
2025-04-26 23:32:46,596 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:32:46,602 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:32:47,589 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 23:32:47,591 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:47,592 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 9a214d636d2d494f801bbfe660d41359...
2025-04-26 23:32:47,592 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:32:48,210 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:32:48,211 - app.core.chat_service - INFO - Mistral response successful for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:48,424 - app.core.storage - INFO - Stored message 680d5f103ac821d4e8f3 for user ai
2025-04-26 23:32:49,436 - app.core.storage - INFO - Stored 5 sources for message 680d5f103ac821d4e8f3
2025-04-26 23:32:49,437 - app.core.chat_service - INFO - Stored AI message (ID: 680d5f103ac821d4e8f3) for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:49,680 - app.core.storage - INFO - Timestamp updated for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:51,260 - app.core.storage - INFO - Stored message 680d5f12c9117f6bc50a for user 680d5f0bdd38db8c38d9
2025-04-26 23:32:51,261 - app.core.chat_service - INFO - Stored user message (ID: 680d5f12c9117f6bc50a) for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:51,478 - app.core.storage - INFO - Timestamp updated for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:51,753 - app.core.retrieval - INFO - Generated embedding for query: 'What was my last message?...'
2025-04-26 23:32:51,754 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:32:51,760 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:32:51,975 - app.core.retrieval - INFO - Found 5 matches in vector store
2025-04-26 23:32:51,977 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:51,978 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 9a214d636d2d494f801bbfe660d41359...
2025-04-26 23:32:51,979 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:32:52,419 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:32:52,419 - app.core.chat_service - INFO - Mistral response successful for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:52,637 - app.core.storage - INFO - Stored message 680d5f1481624fbb5741 for user ai
2025-04-26 23:32:53,571 - app.core.storage - INFO - Stored 5 sources for message 680d5f1481624fbb5741
2025-04-26 23:32:53,572 - app.core.chat_service - INFO - Stored AI message (ID: 680d5f1481624fbb5741) for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:32:53,784 - app.core.storage - INFO - Timestamp updated for conversation 9a214d636d2d494f801bbfe660d41359
2025-04-26 23:33:02,834 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:42:55,049 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:43:14,751 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:43:14,793 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:43:43,472 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:43:44,030 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:43:44,564 - app.api.endpoints.auth - INFO - User registered successfully: 9lfw2e8b0u@fixture.pytest.dev, ID: 680d61a0045ff93a77ff
2025-04-26 23:43:45,020 - app.api.endpoints.auth - INFO - Password verified for user: 9lfw2e8b0u@fixture.pytest.dev, User ID: 680d61a0045ff93a77ff
2025-04-26 23:43:45,235 - app.api.endpoints.auth - INFO - JWT created successfully for user: 9lfw2e8b0u@fixture.pytest.dev
2025-04-26 23:43:45,526 - app.core.storage - INFO - Attempting to create conversation e616c1bcd3b0451d8c05e2d765900542 for user 680d61a0045ff93a77ff
2025-04-26 23:43:45,704 - app.core.storage - INFO - Successfully created conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:46,318 - app.core.storage - INFO - Stored message 680d61a1c02c5e55e4da for user 680d61a0045ff93a77ff
2025-04-26 23:43:46,319 - app.core.chat_service - INFO - Stored user message (ID: 680d61a1c02c5e55e4da) for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:46,064 - app.core.storage - INFO - Timestamp updated for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:46,065 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:43:46,070 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:43:47,845 - app.core.chat_service - INFO - Retrieved 5 documents for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:47,848 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation e616c1bcd3b0451d8c05e2d765900542...
2025-04-26 23:43:47,850 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:43:48,545 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:43:48,572 - app.core.chat_service - INFO - Mistral response successful for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:48,871 - app.core.storage - INFO - Stored message 680d61a487eea0654229 for user ai
2025-04-26 23:43:49,830 - app.core.storage - INFO - Stored 5 sources for message 680d61a487eea0654229
2025-04-26 23:43:49,832 - app.core.chat_service - INFO - Stored AI message (ID: 680d61a487eea0654229) for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:50,054 - app.core.storage - INFO - Timestamp updated for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:51,161 - app.core.storage - INFO - Stored message 680d61a7183920f21427 for user 680d61a0045ff93a77ff
2025-04-26 23:43:51,162 - app.core.chat_service - INFO - Stored user message (ID: 680d61a7183920f21427) for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:51,349 - app.core.storage - INFO - Timestamp updated for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:51,350 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:43:51,358 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:43:52,309 - app.core.chat_service - INFO - Retrieved 5 documents for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:52,310 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation e616c1bcd3b0451d8c05e2d765900542...
2025-04-26 23:43:52,311 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:43:52,753 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:43:52,753 - app.core.chat_service - INFO - Mistral response successful for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:52,930 - app.core.storage - INFO - Stored message 680d61a8aad02cf3d93f for user ai
2025-04-26 23:43:53,909 - app.core.storage - INFO - Stored 5 sources for message 680d61a8aad02cf3d93f
2025-04-26 23:43:53,910 - app.core.chat_service - INFO - Stored AI message (ID: 680d61a8aad02cf3d93f) for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:43:54,120 - app.core.storage - INFO - Timestamp updated for conversation e616c1bcd3b0451d8c05e2d765900542
2025-04-26 23:44:06,028 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:44:57,093 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:45:15,128 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:45:15,179 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:46:16,663 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:46:16,905 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:46:17,417 - app.api.endpoints.auth - INFO - User registered successfully: am93jhky10@fixture.pytest.dev, ID: 680d6239173486e0b1bd
2025-04-26 23:46:17,840 - app.api.endpoints.auth - INFO - Password verified for user: am93jhky10@fixture.pytest.dev, User ID: 680d6239173486e0b1bd
2025-04-26 23:46:18,031 - app.api.endpoints.auth - INFO - JWT created successfully for user: am93jhky10@fixture.pytest.dev
2025-04-26 23:46:18,236 - app.core.storage - INFO - Attempting to create conversation fe7a6e98f74d4487b7a52f32c504d138 for user 680d6239173486e0b1bd
2025-04-26 23:46:18,452 - app.core.storage - INFO - Successfully created conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:19,051 - app.core.storage - INFO - Stored message 680d623ab800aa8549bf for user 680d6239173486e0b1bd
2025-04-26 23:46:19,051 - app.core.chat_service - INFO - Stored user message (ID: 680d623ab800aa8549bf) for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:19,284 - app.core.storage - INFO - Timestamp updated for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:19,286 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:46:19,292 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:46:20,701 - app.core.chat_service - INFO - Retrieved 5 documents for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:20,702 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation fe7a6e98f74d4487b7a52f32c504d138...
2025-04-26 23:46:20,702 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:46:21,316 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:46:21,317 - app.core.chat_service - INFO - Mistral response successful for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:21,525 - app.core.storage - INFO - Stored message 680d623cf246b8b7e8ae for user ai
2025-04-26 23:46:22,107 - app.core.storage - INFO - Stored 5 sources for message 680d623cf246b8b7e8ae
2025-04-26 23:46:22,108 - app.core.chat_service - INFO - Stored AI message (ID: 680d623cf246b8b7e8ae) for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:22,366 - app.core.storage - INFO - Timestamp updated for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:23,915 - app.core.storage - INFO - Stored message 680d623f962fd537aa66 for user 680d6239173486e0b1bd
2025-04-26 23:46:23,915 - app.core.chat_service - INFO - Stored user message (ID: 680d623f962fd537aa66) for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:24,150 - app.core.storage - INFO - Timestamp updated for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:24,151 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:46:24,159 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:46:25,118 - app.core.chat_service - INFO - Retrieved 5 documents for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:25,120 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation fe7a6e98f74d4487b7a52f32c504d138...
2025-04-26 23:46:25,122 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:46:25,717 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:46:25,718 - app.core.chat_service - INFO - Mistral response successful for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:25,945 - app.core.storage - INFO - Stored message 680d62416fa455b6e6b5 for user ai
2025-04-26 23:46:26,450 - app.core.storage - INFO - Stored 5 sources for message 680d62416fa455b6e6b5
2025-04-26 23:46:26,451 - app.core.chat_service - INFO - Stored AI message (ID: 680d62416fa455b6e6b5) for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:26,657 - app.core.storage - INFO - Timestamp updated for conversation fe7a6e98f74d4487b7a52f32c504d138
2025-04-26 23:46:39,761 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:48:37,686 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:48:58,731 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:48:58,827 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:49:11,281 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:49:12,078 - app.main - INFO - Application startup: initializing services and connections
2025-04-26 23:49:12,156 - app.api.endpoints.auth - INFO - User registered successfully: ljazpio5y3@fixture.pytest.dev, ID: 680d62e7e7ac9f127eff
2025-04-26 23:49:12,565 - app.api.endpoints.auth - INFO - Password verified for user: ljazpio5y3@fixture.pytest.dev, User ID: 680d62e7e7ac9f127eff
2025-04-26 23:49:12,784 - app.api.endpoints.auth - INFO - JWT created successfully for user: ljazpio5y3@fixture.pytest.dev
2025-04-26 23:49:12,988 - app.core.storage - INFO - Attempting to create conversation 83bca362ef6341b685bf96f3ff2c383a for user 680d62e7e7ac9f127eff
2025-04-26 23:49:13,194 - app.core.storage - INFO - Successfully created conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:13,790 - app.core.storage - INFO - Stored message 680d62e99261da88d257 for user 680d62e7e7ac9f127eff
2025-04-26 23:49:13,790 - app.core.chat_service - INFO - Stored user message (ID: 680d62e99261da88d257) for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:14,007 - app.core.storage - INFO - Timestamp updated for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:14,008 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:49:14,014 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:49:15,848 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:15,849 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 83bca362ef6341b685bf96f3ff2c383a...
2025-04-26 23:49:15,850 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:49:16,446 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:49:16,447 - app.core.chat_service - INFO - Mistral response successful for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:16,657 - app.core.storage - INFO - Stored message 680d62ec32306cce38ab for user ai
2025-04-26 23:49:17,215 - app.core.storage - INFO - Stored 5 sources for message 680d62ec32306cce38ab
2025-04-26 23:49:17,216 - app.core.chat_service - INFO - Stored AI message (ID: 680d62ec32306cce38ab) for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:17,384 - app.core.storage - INFO - Timestamp updated for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:19,039 - app.core.storage - INFO - Stored message 680d62eec84d8c68abe4 for user 680d62e7e7ac9f127eff
2025-04-26 23:49:19,040 - app.core.chat_service - INFO - Stored user message (ID: 680d62eec84d8c68abe4) for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:19,218 - app.core.storage - INFO - Timestamp updated for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:19,219 - app.core.clients - INFO - Initializing Pinecone client
2025-04-26 23:49:19,225 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-26 23:49:20,103 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:20,105 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 83bca362ef6341b685bf96f3ff2c383a...
2025-04-26 23:49:20,105 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-26 23:49:20,862 - app.core.llm_service - INFO - Mistral API call successful
2025-04-26 23:49:20,871 - app.core.chat_service - INFO - Mistral response successful for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:21,089 - app.core.storage - INFO - Stored message 680d62f0a89e097b0eb3 for user ai
2025-04-26 23:49:22,163 - app.core.storage - INFO - Stored 5 sources for message 680d62f0a89e097b0eb3
2025-04-26 23:49:22,164 - app.core.chat_service - INFO - Stored AI message (ID: 680d62f0a89e097b0eb3) for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:22,366 - app.core.storage - INFO - Timestamp updated for conversation 83bca362ef6341b685bf96f3ff2c383a
2025-04-26 23:49:34,968 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:58:55,090 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-26 23:59:10,489 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-26 23:59:10,533 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 00:14:54,456 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 00:50:02,317 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 00:50:02,369 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 00:50:26,258 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 00:50:26,747 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 00:50:27,336 - app.api.endpoints.auth - INFO - User registered successfully: z3yrbqx2n6@fixture.pytest.dev, ID: 680d7142db15ef10521b
2025-04-27 00:50:27,760 - app.api.endpoints.auth - INFO - Password verified for user: z3yrbqx2n6@fixture.pytest.dev, User ID: 680d7142db15ef10521b
2025-04-27 00:50:28,012 - app.api.endpoints.auth - INFO - JWT created successfully for user: z3yrbqx2n6@fixture.pytest.dev
2025-04-27 00:50:28,270 - app.core.storage - INFO - Attempting to create conversation 0187dfe2597040a5b85c7b449c489720 for user 680d7142db15ef10521b
2025-04-27 00:50:28,567 - app.core.storage - INFO - Successfully created conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:29,189 - app.core.storage - INFO - Stored message 680d7144bf3de7170dbc for user 680d7142db15ef10521b
2025-04-27 00:50:29,189 - app.core.chat_service - INFO - Stored user message (ID: 680d7144bf3de7170dbc) for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:29,363 - app.core.storage - INFO - Timestamp updated for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:29,363 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 00:50:29,364 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 00:50:29,371 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 00:50:30,027 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 00:50:30,038 - app.core.chat_service - WARNING - No documents retrieved for query in conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:30,039 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 00:50:30,039 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 0187dfe2597040a5b85c7b449c489720...
2025-04-27 00:50:30,040 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 00:50:30,896 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 00:50:30,897 - app.core.chat_service - INFO - Mistral response successful for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:31,061 - app.core.storage - INFO - Stored message 680d7146db39b31dad5b for user ai
2025-04-27 00:50:31,062 - app.core.chat_service - INFO - Stored AI message (ID: 680d7146db39b31dad5b) for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:31,294 - app.core.storage - INFO - Timestamp updated for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:32,914 - app.core.storage - INFO - Stored message 680d71489472f9ce4735 for user 680d7142db15ef10521b
2025-04-27 00:50:32,914 - app.core.chat_service - INFO - Stored user message (ID: 680d71489472f9ce4735) for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:33,115 - app.core.storage - INFO - Timestamp updated for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:33,116 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 00:50:33,122 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 00:50:33,497 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 00:50:33,503 - app.core.chat_service - WARNING - No documents retrieved for query in conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:33,503 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 00:50:33,504 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 0187dfe2597040a5b85c7b449c489720...
2025-04-27 00:50:33,504 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 00:50:34,024 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 00:50:34,025 - app.core.chat_service - INFO - Mistral response successful for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:34,225 - app.core.storage - INFO - Stored message 680d7149c691c269a1cd for user ai
2025-04-27 00:50:34,226 - app.core.chat_service - INFO - Stored AI message (ID: 680d7149c691c269a1cd) for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:34,472 - app.core.storage - INFO - Timestamp updated for conversation 0187dfe2597040a5b85c7b449c489720
2025-04-27 00:50:46,584 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:01:02,534 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:01:33,336 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:01:33,387 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:03:06,918 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:03:22,191 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:04:38,286 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:04:09,501 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:04:09,977 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:04:10,630 - app.api.endpoints.auth - INFO - User registered successfully: 69wg52el1u@fixture.pytest.dev, ID: 680d747a0c0e539c21c9
2025-04-27 01:04:11,039 - app.api.endpoints.auth - INFO - Password verified for user: 69wg52el1u@fixture.pytest.dev, User ID: 680d747a0c0e539c21c9
2025-04-27 01:04:11,236 - app.api.endpoints.auth - INFO - JWT created successfully for user: 69wg52el1u@fixture.pytest.dev
2025-04-27 01:04:11,524 - app.core.storage - INFO - Attempting to create conversation 042e40eac0b24169adee5199427a6bc5 for user 680d747a0c0e539c21c9
2025-04-27 01:04:11,750 - app.core.storage - INFO - Successfully created conversation 042e40eac0b24169adee5199427a6bc5
2025-04-27 01:04:11,962 - app.core.storage - ERROR - Appwrite error storing message for conversation 042e40eac0b24169adee5199427a6bc5: Invalid `permissions` param: Permission "user:680d747a0c0e539c21c9" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:04:11,963 - app.core.chat_service - ERROR - Failed to store user message for conversation 042e40eac0b24169adee5199427a6bc5: 500: Failed to store message: Invalid `permissions` param: Permission "user:680d747a0c0e539c21c9" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:04:11,964 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 01:04:11,964 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:04:11,972 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:04:14,264 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 01:04:14,276 - app.core.chat_service - WARNING - No documents retrieved for query in conversation 042e40eac0b24169adee5199427a6bc5
2025-04-27 01:04:14,277 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:04:14,277 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 042e40eac0b24169adee5199427a6bc5...
2025-04-27 01:04:14,278 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:04:14,990 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:04:14,991 - app.core.chat_service - INFO - Mistral response successful for conversation 042e40eac0b24169adee5199427a6bc5
2025-04-27 01:04:15,238 - app.core.storage - ERROR - Appwrite error storing message for conversation 042e40eac0b24169adee5199427a6bc5: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:04:15,239 - app.core.chat_service - ERROR - Failed to store AI message for conversation 042e40eac0b24169adee5199427a6bc5: 500: Failed to store message: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:04:16,837 - app.core.storage - ERROR - Appwrite error storing message for conversation 042e40eac0b24169adee5199427a6bc5: Invalid `permissions` param: Permission "user:680d747a0c0e539c21c9" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:04:16,838 - app.core.chat_service - ERROR - Failed to store user message for conversation 042e40eac0b24169adee5199427a6bc5: 500: Failed to store message: Invalid `permissions` param: Permission "user:680d747a0c0e539c21c9" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:04:16,839 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:04:16,844 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:04:17,172 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 01:04:17,178 - app.core.chat_service - WARNING - No documents retrieved for query in conversation 042e40eac0b24169adee5199427a6bc5
2025-04-27 01:04:17,178 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:04:17,179 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 042e40eac0b24169adee5199427a6bc5...
2025-04-27 01:04:17,179 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:04:17,048 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:04:17,048 - app.core.chat_service - INFO - Mistral response successful for conversation 042e40eac0b24169adee5199427a6bc5
2025-04-27 01:04:17,276 - app.core.storage - ERROR - Appwrite error storing message for conversation 042e40eac0b24169adee5199427a6bc5: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:04:17,277 - app.core.chat_service - ERROR - Failed to store AI message for conversation 042e40eac0b24169adee5199427a6bc5: 500: Failed to store message: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:04:27,311 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:06:24,846 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:06:47,048 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:06:47,093 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:08:56,046 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:08:56,568 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:08:57,100 - app.api.endpoints.auth - INFO - User registered successfully: zgvn8b77uy@fixture.pytest.dev, ID: 680d759867cf51694d32
2025-04-27 01:08:57,581 - app.api.endpoints.auth - INFO - Password verified for user: zgvn8b77uy@fixture.pytest.dev, User ID: 680d759867cf51694d32
2025-04-27 01:08:57,819 - app.api.endpoints.auth - INFO - JWT created successfully for user: zgvn8b77uy@fixture.pytest.dev
2025-04-27 01:08:57,599 - app.core.storage - INFO - Attempting to create conversation a3783bca440540ce90fe20d3c6ac3471 for user 680d759867cf51694d32
2025-04-27 01:08:57,819 - app.core.storage - INFO - Successfully created conversation a3783bca440540ce90fe20d3c6ac3471
2025-04-27 01:08:58,357 - app.core.storage - ERROR - Appwrite error storing message for conversation a3783bca440540ce90fe20d3c6ac3471: Invalid `permissions` param: Permission "user:680d759867cf51694d32" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:08:58,358 - app.core.chat_service - ERROR - Failed to store user message for conversation a3783bca440540ce90fe20d3c6ac3471: 500: Failed to store message: Invalid `permissions` param: Permission "user:680d759867cf51694d32" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:08:58,359 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 01:08:58,360 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:08:58,364 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:08:59,410 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 01:08:59,422 - app.core.chat_service - WARNING - No documents retrieved for query in conversation a3783bca440540ce90fe20d3c6ac3471
2025-04-27 01:08:59,423 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:08:59,423 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation a3783bca440540ce90fe20d3c6ac3471...
2025-04-27 01:08:59,424 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:09:00,410 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:09:00,410 - app.core.chat_service - INFO - Mistral response successful for conversation a3783bca440540ce90fe20d3c6ac3471
2025-04-27 01:09:00,744 - app.core.storage - ERROR - Appwrite error storing message for conversation a3783bca440540ce90fe20d3c6ac3471: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:00,745 - app.core.chat_service - ERROR - Failed to store AI message for conversation a3783bca440540ce90fe20d3c6ac3471: 500: Failed to store message: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:02,391 - app.core.storage - ERROR - Appwrite error storing message for conversation a3783bca440540ce90fe20d3c6ac3471: Invalid `permissions` param: Permission "user:680d759867cf51694d32" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:02,392 - app.core.chat_service - ERROR - Failed to store user message for conversation a3783bca440540ce90fe20d3c6ac3471: 500: Failed to store message: Invalid `permissions` param: Permission "user:680d759867cf51694d32" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:02,394 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:09:02,424 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:09:02,693 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 01:09:02,699 - app.core.chat_service - WARNING - No documents retrieved for query in conversation a3783bca440540ce90fe20d3c6ac3471
2025-04-27 01:09:02,700 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:09:02,701 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation a3783bca440540ce90fe20d3c6ac3471...
2025-04-27 01:09:02,701 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:09:02,901 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 01:09:02,902 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.04 seconds (calculated)...
2025-04-27 01:09:03,876 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:09:03,877 - app.core.chat_service - INFO - Mistral response successful for conversation a3783bca440540ce90fe20d3c6ac3471
2025-04-27 01:09:04,128 - app.core.storage - ERROR - Appwrite error storing message for conversation a3783bca440540ce90fe20d3c6ac3471: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:04,129 - app.core.chat_service - ERROR - Failed to store AI message for conversation a3783bca440540ce90fe20d3c6ac3471: 500: Failed to store message: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:16,635 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:09:47,132 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:09:47,606 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:09:47,733 - app.api.endpoints.auth - INFO - User registered successfully: ledmmc5y55@fixture.pytest.dev, ID: 680d75cb7ae43b54a74f
2025-04-27 01:09:48,235 - app.api.endpoints.auth - INFO - Password verified for user: ledmmc5y55@fixture.pytest.dev, User ID: 680d75cb7ae43b54a74f
2025-04-27 01:09:48,778 - app.api.endpoints.auth - INFO - JWT created successfully for user: ledmmc5y55@fixture.pytest.dev
2025-04-27 01:09:49,526 - app.core.storage - INFO - Attempting to create conversation f564ad3f7d974246aafd8ee0b87bb2ed for user 680d75cb7ae43b54a74f
2025-04-27 01:09:49,939 - app.core.storage - INFO - Successfully created conversation f564ad3f7d974246aafd8ee0b87bb2ed
2025-04-27 01:09:50,729 - app.core.storage - ERROR - Appwrite error storing message for conversation f564ad3f7d974246aafd8ee0b87bb2ed: Invalid `permissions` param: Permission "user:680d75cb7ae43b54a74f" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:50,730 - app.core.chat_service - ERROR - Failed to store user message for conversation f564ad3f7d974246aafd8ee0b87bb2ed: 500: Failed to store message: Invalid `permissions` param: Permission "user:680d75cb7ae43b54a74f" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:50,731 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 01:09:50,732 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:09:50,738 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:09:52,641 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 01:09:52,652 - app.core.chat_service - WARNING - No documents retrieved for query in conversation f564ad3f7d974246aafd8ee0b87bb2ed
2025-04-27 01:09:52,652 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:09:52,653 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation f564ad3f7d974246aafd8ee0b87bb2ed...
2025-04-27 01:09:52,654 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:09:52,781 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:09:52,781 - app.core.chat_service - INFO - Mistral response successful for conversation f564ad3f7d974246aafd8ee0b87bb2ed
2025-04-27 01:09:53,044 - app.core.storage - ERROR - Appwrite error storing message for conversation f564ad3f7d974246aafd8ee0b87bb2ed: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:53,045 - app.core.chat_service - ERROR - Failed to store AI message for conversation f564ad3f7d974246aafd8ee0b87bb2ed: 500: Failed to store message: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:54,637 - app.core.storage - ERROR - Appwrite error storing message for conversation f564ad3f7d974246aafd8ee0b87bb2ed: Invalid `permissions` param: Permission "user:680d75cb7ae43b54a74f" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:54,638 - app.core.chat_service - ERROR - Failed to store user message for conversation f564ad3f7d974246aafd8ee0b87bb2ed: 500: Failed to store message: Invalid `permissions` param: Permission "user:680d75cb7ae43b54a74f" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:54,639 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:09:54,646 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:09:54,816 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 01:09:54,821 - app.core.chat_service - WARNING - No documents retrieved for query in conversation f564ad3f7d974246aafd8ee0b87bb2ed
2025-04-27 01:09:54,822 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:09:54,823 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation f564ad3f7d974246aafd8ee0b87bb2ed...
2025-04-27 01:09:54,823 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:09:55,215 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:09:55,218 - app.core.chat_service - INFO - Mistral response successful for conversation f564ad3f7d974246aafd8ee0b87bb2ed
2025-04-27 01:09:55,417 - app.core.storage - ERROR - Appwrite error storing message for conversation f564ad3f7d974246aafd8ee0b87bb2ed: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:55,418 - app.core.chat_service - ERROR - Failed to store AI message for conversation f564ad3f7d974246aafd8ee0b87bb2ed: 500: Failed to store message: Invalid `permissions` param: Permission "user:ai" is not allowed. Must be one of: read, update, delete, write.
2025-04-27 01:09:59,415 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:10:09,040 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:10:19,921 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:10:19,959 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:10:51,985 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:10:52,531 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:10:53,011 - app.api.endpoints.auth - INFO - User registered successfully: zk4r30ehyu@fixture.pytest.dev, ID: 680d760c620bedffadce
2025-04-27 01:10:53,049 - app.api.endpoints.auth - INFO - Password verified for user: zk4r30ehyu@fixture.pytest.dev, User ID: 680d760c620bedffadce
2025-04-27 01:10:53,268 - app.api.endpoints.auth - INFO - JWT created successfully for user: zk4r30ehyu@fixture.pytest.dev
2025-04-27 01:10:53,494 - app.core.storage - INFO - Attempting to create conversation abd6f3facd1f4d38b61b03ed0ea9dc7e for user 680d760c620bedffadce
2025-04-27 01:10:53,706 - app.core.storage - INFO - Successfully created conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:54,382 - app.core.storage - INFO - Stored message 680d760e36bcee0cd4e0 for user 680d760c620bedffadce
2025-04-27 01:10:54,383 - app.core.chat_service - INFO - Stored user message (ID: 680d760e36bcee0cd4e0) for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:54,601 - app.core.storage - INFO - Timestamp updated for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:54,603 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 01:10:54,604 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:10:54,609 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:10:56,258 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 01:10:56,269 - app.core.chat_service - WARNING - No documents retrieved for query in conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:56,269 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:10:56,270 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e...
2025-04-27 01:10:56,271 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:10:57,014 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:10:57,014 - app.core.chat_service - INFO - Mistral response successful for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:57,227 - app.core.storage - INFO - Stored message 680d7610cf8e11998b28 for user ai
2025-04-27 01:10:57,228 - app.core.chat_service - INFO - Stored AI message (ID: 680d7610cf8e11998b28) for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:57,424 - app.core.storage - INFO - Timestamp updated for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:59,401 - app.core.storage - INFO - Stored message 680d761327a13a0474b5 for user 680d760c620bedffadce
2025-04-27 01:10:59,401 - app.core.chat_service - INFO - Stored user message (ID: 680d761327a13a0474b5) for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:59,672 - app.core.storage - INFO - Timestamp updated for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:59,672 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:10:59,678 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:10:59,871 - app.core.retrieval.pinecone - ERROR - Error querying Pinecone vector store: 'Index' object has no attribute 'name'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/core/retrieval/pinecone.py", line 30, in retrieve
    logger.debug(f"Querying Pinecone index '{index.name}' with top_k={top_k}")
                                             ^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'name'
2025-04-27 01:10:59,875 - app.core.chat_service - WARNING - No documents retrieved for query in conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:10:59,876 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:10:59,877 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e...
2025-04-27 01:10:59,877 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:11:00,082 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 01:11:00,083 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.02 seconds (calculated)...
2025-04-27 01:11:01,530 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:11:01,531 - app.core.chat_service - INFO - Mistral response successful for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:11:01,717 - app.core.storage - INFO - Stored message 680d761557407d15d060 for user ai
2025-04-27 01:11:01,718 - app.core.chat_service - INFO - Stored AI message (ID: 680d761557407d15d060) for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:11:01,929 - app.core.storage - INFO - Timestamp updated for conversation abd6f3facd1f4d38b61b03ed0ea9dc7e
2025-04-27 01:11:12,523 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:11:49,120 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:13:20,435 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:13:20,473 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:27:52,084 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:28:12,933 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:28:13,020 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:29:13,452 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:29:14,012 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:29:14,571 - app.api.endpoints.auth - INFO - User registered successfully: l1nxogxvsg@fixture.pytest.dev, ID: 680d7a5a11bdb8539fbb
2025-04-27 01:29:15,018 - app.api.endpoints.auth - INFO - Password verified for user: l1nxogxvsg@fixture.pytest.dev, User ID: 680d7a5a11bdb8539fbb
2025-04-27 01:29:15,195 - app.api.endpoints.auth - INFO - JWT created successfully for user: l1nxogxvsg@fixture.pytest.dev
2025-04-27 01:29:15,437 - app.core.storage - INFO - Attempting to create conversation dcd121591ef44a43abfcec6d4f8dd161 for user 680d7a5a11bdb8539fbb
2025-04-27 01:29:15,781 - app.core.storage - INFO - Successfully created conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:16,026 - app.core.storage - INFO - Stored message 680d7a5bed8e6dbb1564 for user 680d7a5a11bdb8539fbb
2025-04-27 01:29:16,027 - app.core.chat_service - INFO - Stored user message (ID: 680d7a5bed8e6dbb1564) for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:16,259 - app.core.storage - INFO - Timestamp updated for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:16,259 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 01:29:16,260 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:29:16,266 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:29:18,512 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_1_0_55: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:18,513 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_2_0_341: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:18,514 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_2_0_350: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:18,515 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_9_0_207: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:18,515 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_3_0_74: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:18,518 - app.core.chat_service - WARNING - No documents retrieved for query in conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:18,520 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:29:18,521 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation dcd121591ef44a43abfcec6d4f8dd161...
2025-04-27 01:29:18,522 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:29:18,697 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 01:29:18,698 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.47 seconds (calculated)...
2025-04-27 01:29:20,798 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:29:20,820 - app.core.chat_service - INFO - Mistral response successful for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:20,990 - app.core.storage - INFO - Stored message 680d7a6088bfa4d5beb9 for user ai
2025-04-27 01:29:20,991 - app.core.chat_service - INFO - Stored AI message (ID: 680d7a6088bfa4d5beb9) for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:21,190 - app.core.storage - INFO - Timestamp updated for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:23,077 - app.core.storage - INFO - Stored message 680d7a62d3cf5cc221f1 for user 680d7a5a11bdb8539fbb
2025-04-27 01:29:23,078 - app.core.chat_service - INFO - Stored user message (ID: 680d7a62d3cf5cc221f1) for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:23,297 - app.core.storage - INFO - Timestamp updated for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:23,298 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:29:23,304 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:29:24,332 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_9_0_196: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:24,333 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_9_0_265: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:24,333 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_2_0_864: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:24,335 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_2_0_144: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:24,336 - app.core.retrieval.pinecone - ERROR - Pydantic validation failed for metadata of match ID 6315_0_9_0_234: 1 validation error for DocumentMetadata
book_id
  Input should be a valid string [type=string_type, input_value=6315.0, input_type=float]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-04-27 01:29:24,338 - app.core.chat_service - WARNING - No documents retrieved for query in conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:24,339 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 01:29:24,340 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation dcd121591ef44a43abfcec6d4f8dd161...
2025-04-27 01:29:24,341 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:29:24,873 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 01:29:24,874 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.57 seconds (calculated)...
2025-04-27 01:29:27,572 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:29:27,574 - app.core.chat_service - INFO - Mistral response successful for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:27,979 - app.core.storage - INFO - Stored message 680d7a67a5951d26920a for user ai
2025-04-27 01:29:27,979 - app.core.chat_service - INFO - Stored AI message (ID: 680d7a67a5951d26920a) for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:29:28,232 - app.core.storage - INFO - Timestamp updated for conversation dcd121591ef44a43abfcec6d4f8dd161
2025-04-27 01:30:57,867 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:29:46,190 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:30:03,653 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:30:03,687 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:37:32,126 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:37:50,072 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:37:50,138 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:37:53,861 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:37:54,338 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:37:54,834 - app.api.endpoints.auth - INFO - User registered successfully: s9liob78ik@fixture.pytest.dev, ID: 680d7c626cab52473a2c
2025-04-27 01:37:55,290 - app.api.endpoints.auth - INFO - Password verified for user: s9liob78ik@fixture.pytest.dev, User ID: 680d7c626cab52473a2c
2025-04-27 01:37:55,502 - app.api.endpoints.auth - INFO - JWT created successfully for user: s9liob78ik@fixture.pytest.dev
2025-04-27 01:37:55,761 - app.core.storage - INFO - Attempting to create conversation ab43ee1dd6454deea7941319a21c1df3 for user 680d7c626cab52473a2c
2025-04-27 01:37:55,958 - app.core.storage - INFO - Successfully created conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:37:56,668 - app.core.storage - INFO - Stored message 680d7c644343c6442a0b for user 680d7c626cab52473a2c
2025-04-27 01:37:56,669 - app.core.chat_service - INFO - Stored user message (ID: 680d7c644343c6442a0b) for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:37:56,873 - app.core.storage - INFO - Timestamp updated for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:37:56,873 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 01:37:56,874 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:37:56,880 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:37:58,248 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 01:37:58,251 - app.core.chat_service - INFO - Retrieved 5 documents for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:37:58,255 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation ab43ee1dd6454deea7941319a21c1df3...
2025-04-27 01:37:58,256 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:37:58,879 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:37:58,879 - app.core.chat_service - INFO - Mistral response successful for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:37:59,089 - app.core.storage - INFO - Stored message 680d7c66e2706cf97ea3 for user ai
2025-04-27 01:38:00,103 - app.core.storage - INFO - Stored 5 sources for message 680d7c66e2706cf97ea3
2025-04-27 01:38:00,104 - app.core.chat_service - INFO - Stored AI message (ID: 680d7c66e2706cf97ea3) for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:38:00,314 - app.core.storage - INFO - Timestamp updated for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:38:01,941 - app.core.storage - INFO - Stored message 680d7c69811406b78516 for user 680d7c626cab52473a2c
2025-04-27 01:38:01,942 - app.core.chat_service - INFO - Stored user message (ID: 680d7c69811406b78516) for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:38:02,157 - app.core.storage - INFO - Timestamp updated for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:38:02,158 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:38:02,164 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:38:03,223 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 01:38:03,225 - app.core.chat_service - INFO - Retrieved 5 documents for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:38:03,226 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation ab43ee1dd6454deea7941319a21c1df3...
2025-04-27 01:38:03,227 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:38:02,919 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 01:38:02,920 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.53 seconds (calculated)...
2025-04-27 01:38:04,897 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:38:04,898 - app.core.chat_service - INFO - Mistral response successful for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:38:05,329 - app.core.storage - INFO - Stored message 680d7c6d16fc17129ae5 for user ai
2025-04-27 01:38:06,317 - app.core.storage - INFO - Stored 5 sources for message 680d7c6d16fc17129ae5
2025-04-27 01:38:06,318 - app.core.chat_service - INFO - Stored AI message (ID: 680d7c6d16fc17129ae5) for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:38:06,522 - app.core.storage - INFO - Timestamp updated for conversation ab43ee1dd6454deea7941319a21c1df3
2025-04-27 01:38:17,170 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:53:31,133 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 01:53:47,267 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:53:47,316 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:56:33,482 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 01:56:33,971 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 01:56:34,515 - app.api.endpoints.auth - INFO - User registered successfully: tx8rlnm8fn@fixture.pytest.dev, ID: 680d80c1ed20a5a354c0
2025-04-27 01:56:35,004 - app.api.endpoints.auth - INFO - Password verified for user: tx8rlnm8fn@fixture.pytest.dev, User ID: 680d80c1ed20a5a354c0
2025-04-27 01:56:35,224 - app.api.endpoints.auth - INFO - JWT created successfully for user: tx8rlnm8fn@fixture.pytest.dev
2025-04-27 01:56:35,464 - app.core.storage - INFO - Attempting to create conversation 55da5c52cdba43d4bc0605d612bb0666 for user 680d80c1ed20a5a354c0
2025-04-27 01:56:35,637 - app.core.storage - INFO - Successfully created conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:35,795 - app.core.storage - INFO - Stored message 680d80c3b47da43244f6 for user 680d80c1ed20a5a354c0
2025-04-27 01:56:35,795 - app.core.chat_service - INFO - Stored user message (ID: 680d80c3b47da43244f6) for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:36,003 - app.core.storage - INFO - Timestamp updated for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:36,008 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 01:56:36,013 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:56:36,033 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:56:39,650 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 01:56:39,652 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:39,653 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 01:56:39,654 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 01:56:39,654 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 55da5c52cdba43d4bc0605d612bb0666...
2025-04-27 01:56:39,655 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:56:40,225 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:56:40,226 - app.core.chat_service - INFO - Mistral response successful for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:40,438 - app.core.storage - INFO - Stored message 680d80c7eaa754b51da5 for user ai
2025-04-27 01:56:41,201 - app.core.storage - INFO - Stored 5 sources for message 680d80c7eaa754b51da5
2025-04-27 01:56:41,202 - app.core.chat_service - INFO - Stored AI message (ID: 680d80c7eaa754b51da5) for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:41,429 - app.core.storage - INFO - Timestamp updated for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:43,019 - app.core.storage - INFO - Stored message 680d80cab9e333c3a2c5 for user 680d80c1ed20a5a354c0
2025-04-27 01:56:43,020 - app.core.chat_service - INFO - Stored user message (ID: 680d80cab9e333c3a2c5) for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:43,247 - app.core.storage - INFO - Timestamp updated for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:43,248 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 01:56:43,255 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 01:56:44,169 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 01:56:44,171 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:44,172 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 01:56:44,172 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 01:56:44,173 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 55da5c52cdba43d4bc0605d612bb0666...
2025-04-27 01:56:44,173 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 01:56:44,728 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 01:56:44,728 - app.core.chat_service - INFO - Mistral response successful for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:44,998 - app.core.storage - INFO - Stored message 680d80cc8911579a4322 for user ai
2025-04-27 01:56:45,970 - app.core.storage - INFO - Stored 5 sources for message 680d80cc8911579a4322
2025-04-27 01:56:45,971 - app.core.chat_service - INFO - Stored AI message (ID: 680d80cc8911579a4322) for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:46,153 - app.core.storage - INFO - Timestamp updated for conversation 55da5c52cdba43d4bc0605d612bb0666
2025-04-27 01:56:56,546 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 02:40:04,585 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 02:40:20,906 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 02:40:20,938 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 02:43:52,528 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 02:44:13,290 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 02:44:13,327 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 02:45:55,939 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 02:46:14,884 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 02:46:14,934 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 02:48:33,817 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 02:48:53,823 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 02:48:53,867 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 02:50:08,234 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 02:50:31,231 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 02:50:46,626 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 02:50:46,673 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 02:51:15,713 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 02:51:23,637 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 02:51:24,103 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 02:51:34,415 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:05:10,156 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:05:33,307 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:05:33,345 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:12:49,261 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:12:57,749 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:12:58,171 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 03:13:08,172 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:13:32,915 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:13:48,073 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:13:48,117 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:21:24,397 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:21:34,703 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:21:44,336 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:21:44,451 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 03:21:44,484 - app.core.context_formatter - WARNING - Skipping document invalid_doc_empty due to missing metadata or text.
2025-04-27 03:21:44,715 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:21:46,402 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:21:46,441 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:28:17,724 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:28:25,691 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:28:26,414 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-27 03:28:26,457 - app.core.context_formatter - WARNING - Skipping document invalid_doc_empty due to missing metadata or text.
2025-04-27 03:28:26,718 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:33:36,939 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:33:38,332 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:33:38,429 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:34:50,103 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:35:26,846 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:35:26,887 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:35:55,716 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:35:56,395 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:35:56,444 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:39:49,398 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:39:50,120 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:40:02,588 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:43:10,070 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:43:10,718 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:43:21,096 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:43:26,949 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:43:41,355 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:43:41,390 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:49:45,242 - app.api.endpoints.auth - INFO - User registered successfully: test509@example.com, ID: 680d9b48d2cbba35e5d2
2025-04-27 03:49:46,016 - app.api.endpoints.auth - INFO - Password verified for user: test509@example.com, User ID: 680d9b48d2cbba35e5d2
2025-04-27 03:49:46,232 - app.api.endpoints.auth - INFO - JWT created successfully for user: test509@example.com
2025-04-27 03:49:47,953 - app.core.storage - INFO - Attempting to create conversation afdace8a8c5246d485d68005a4ec071c for user 680d9b48d2cbba35e5d2
2025-04-27 03:49:48,251 - app.core.storage - INFO - Successfully created conversation afdace8a8c5246d485d68005a4ec071c
2025-04-27 03:49:48,264 - app.api.endpoints.chat - INFO - Created new conversation afdace8a8c5246d485d68005a4ec071c for message.
2025-04-27 03:49:48,823 - app.core.storage - INFO - Stored message 680d9b4c4734d9ea6a5b for user 680d9b48d2cbba35e5d2
2025-04-27 03:49:48,824 - app.core.chat_service - INFO - Stored user message (ID: 680d9b4c4734d9ea6a5b) for conversation afdace8a8c5246d485d68005a4ec071c
2025-04-27 03:49:48,578 - app.core.storage - INFO - Timestamp updated for conversation afdace8a8c5246d485d68005a4ec071c
2025-04-27 03:49:48,580 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 03:49:48,581 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 03:49:48,589 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 03:49:51,475 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 03:49:51,477 - app.core.chat_service - INFO - Retrieved 5 documents for conversation afdace8a8c5246d485d68005a4ec071c
2025-04-27 03:49:51,478 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 03:49:51,479 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 03:49:51,479 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation afdace8a8c5246d485d68005a4ec071c...
2025-04-27 03:49:51,480 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 03:49:53,750 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 03:49:53,751 - app.core.chat_service - INFO - Mistral response successful for conversation afdace8a8c5246d485d68005a4ec071c
2025-04-27 03:49:53,555 - app.core.storage - INFO - Stored message 680d9b5172bfcb29affe for user ai
2025-04-27 03:49:54,566 - app.core.storage - INFO - Stored 5 sources for message 680d9b5172bfcb29affe
2025-04-27 03:49:54,567 - app.core.chat_service - INFO - Stored AI message (ID: 680d9b5172bfcb29affe) for conversation afdace8a8c5246d485d68005a4ec071c
2025-04-27 03:49:54,760 - app.core.storage - INFO - Timestamp updated for conversation afdace8a8c5246d485d68005a4ec071c
2025-04-27 03:49:55,568 - app.core.storage - INFO - Attempting to create conversation 319d707a6aad4294ae22cb76c70637da for user 680d9b48d2cbba35e5d2
2025-04-27 03:49:55,804 - app.core.storage - INFO - Successfully created conversation 319d707a6aad4294ae22cb76c70637da
2025-04-27 03:49:55,805 - app.api.endpoints.chat - INFO - Created new conversation 319d707a6aad4294ae22cb76c70637da for message.
2025-04-27 03:49:56,276 - app.core.storage - INFO - Stored message 680d9b53e7167c2491cd for user 680d9b48d2cbba35e5d2
2025-04-27 03:49:56,276 - app.core.chat_service - INFO - Stored user message (ID: 680d9b53e7167c2491cd) for conversation 319d707a6aad4294ae22cb76c70637da
2025-04-27 03:49:56,536 - app.core.storage - INFO - Timestamp updated for conversation 319d707a6aad4294ae22cb76c70637da
2025-04-27 03:49:56,538 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 03:49:56,543 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 03:49:57,881 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 03:49:57,883 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 319d707a6aad4294ae22cb76c70637da
2025-04-27 03:49:57,885 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 03:49:57,887 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 03:49:57,889 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 319d707a6aad4294ae22cb76c70637da...
2025-04-27 03:49:57,889 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 03:49:58,695 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 03:49:58,695 - app.core.chat_service - INFO - Mistral response successful for conversation 319d707a6aad4294ae22cb76c70637da
2025-04-27 03:51:15,259 - app.core.storage - INFO - Stored message 680d9b5656ef8560f749 for user ai
2025-04-27 03:51:17,442 - app.core.storage - INFO - Stored 5 sources for message 680d9b5656ef8560f749
2025-04-27 03:51:17,443 - app.core.chat_service - INFO - Stored AI message (ID: 680d9b5656ef8560f749) for conversation 319d707a6aad4294ae22cb76c70637da
2025-04-27 03:51:17,691 - app.core.storage - INFO - Timestamp updated for conversation 319d707a6aad4294ae22cb76c70637da
2025-04-27 03:51:19,747 - app.core.storage - INFO - Attempting to create conversation 6ea929a26a1b4734a6241f46d7a2e4a7 for user 680d9b48d2cbba35e5d2
2025-04-27 03:51:21,626 - app.core.storage - INFO - Successfully created conversation 6ea929a26a1b4734a6241f46d7a2e4a7
2025-04-27 03:51:21,626 - app.api.endpoints.chat - INFO - Created new conversation 6ea929a26a1b4734a6241f46d7a2e4a7 for message.
2025-04-27 03:51:23,333 - app.core.storage - INFO - Stored message 680d9b5db4464afa8cfa for user 680d9b48d2cbba35e5d2
2025-04-27 03:51:23,334 - app.core.chat_service - INFO - Stored user message (ID: 680d9b5db4464afa8cfa) for conversation 6ea929a26a1b4734a6241f46d7a2e4a7
2025-04-27 03:51:23,953 - app.core.storage - INFO - Timestamp updated for conversation 6ea929a26a1b4734a6241f46d7a2e4a7
2025-04-27 03:51:23,955 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 03:51:23,964 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 03:51:26,840 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 03:51:26,842 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 6ea929a26a1b4734a6241f46d7a2e4a7
2025-04-27 03:51:26,843 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 03:51:26,843 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 03:51:26,844 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 6ea929a26a1b4734a6241f46d7a2e4a7...
2025-04-27 03:51:26,845 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 03:51:27,657 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 03:51:27,658 - app.core.chat_service - INFO - Mistral response successful for conversation 6ea929a26a1b4734a6241f46d7a2e4a7
2025-04-27 03:51:30,240 - app.core.storage - INFO - Stored message 680d9b653e327dfa3333 for user ai
2025-04-27 03:50:17,171 - app.core.storage - INFO - Stored 5 sources for message 680d9b653e327dfa3333
2025-04-27 03:50:17,171 - app.core.chat_service - INFO - Stored AI message (ID: 680d9b653e327dfa3333) for conversation 6ea929a26a1b4734a6241f46d7a2e4a7
2025-04-27 03:50:17,721 - app.core.storage - INFO - Timestamp updated for conversation 6ea929a26a1b4734a6241f46d7a2e4a7
2025-04-27 03:52:47,962 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:52:48,410 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:52:48,485 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:52:38,835 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:52:39,280 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:52:41,061 - app.api.endpoints.auth - INFO - User registered successfully: 3peq43src6@test.pytest.dev, ID: 680d9bf78ed5a4075eb3
2025-04-27 03:52:43,646 - app.api.endpoints.auth - INFO - Password verified for user: 3peq43src6@test.pytest.dev, User ID: 680d9bf78ed5a4075eb3
2025-04-27 03:52:47,902 - app.api.endpoints.auth - INFO - JWT created successfully for user: 3peq43src6@test.pytest.dev
2025-04-27 03:52:50,621 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 03:58:22,360 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 03:58:23,542 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 03:58:23,596 - app.api.endpoints.auth - INFO - Password verified for user: e2e_test@example.com, User ID: e2e_test_user_id
2025-04-27 03:58:23,596 - app.api.endpoints.auth - INFO - JWT created successfully for user: e2e_test@example.com
2025-04-27 03:58:24,032 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 03:58:24,034 - app.core.storage - INFO - Attempting to create conversation 45f52f445a4f4691b6e767fca0cc1f59 for user anon_141e5998e14d2ee8
2025-04-27 03:58:24,255 - app.core.storage - INFO - Successfully created conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:58:24,427 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 03:58:24,430 - app.core.chat_service - INFO - Stored user message (ID: anon_bec2d08e2474406d9fd3dff123a894d8) for conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:58:24,431 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 03:58:24,431 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 03:58:24,439 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 03:58:26,339 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 03:58:26,341 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:58:26,341 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 03:58:26,342 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 03:58:26,342 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 45f52f445a4f4691b6e767fca0cc1f59...
2025-04-27 03:58:26,343 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 03:58:27,080 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 03:58:27,081 - app.core.chat_service - INFO - Mistral response successful for conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:58:27,081 - app.core.chat_service - INFO - Stored AI message (ID: anon_fc362b6fb4164870bbfbc7257d6576e0) for conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:58:28,308 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 03:58:28,309 - app.core.chat_service - INFO - Stored user message (ID: anon_286f158091f44fc18640a66d507e8cb3) for conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:58:28,310 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 03:58:28,316 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 03:58:29,158 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 03:58:29,160 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:58:29,161 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 03:58:29,161 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 03:58:29,162 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 45f52f445a4f4691b6e767fca0cc1f59...
2025-04-27 03:58:29,162 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 03:59:46,050 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 03:59:46,051 - app.core.chat_service - INFO - Mistral response successful for conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:59:46,051 - app.core.chat_service - INFO - Stored AI message (ID: anon_3fedf021053341ceb6a14fb4745d09f0) for conversation 45f52f445a4f4691b6e767fca0cc1f59
2025-04-27 03:58:29,992 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 03:59:56,359 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:00:10,400 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:00:27,194 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:00:27,235 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:01:12,622 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:01:27,266 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:01:28,131 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:01:28,169 - app.api.endpoints.auth - INFO - Password verified for user: e2e_test@example.com, User ID: e2e_test_user_id
2025-04-27 04:01:28,170 - app.api.endpoints.auth - INFO - JWT created successfully for user: e2e_test@example.com
2025-04-27 04:01:36,994 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:01:37,029 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:01:41,553 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:03:02,884 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:03:26,761 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:03:26,838 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:04:34,077 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:04:34,848 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:04:34,946 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:05:01,248 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:05:01,719 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:05:01,795 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:05:10,288 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:05:26,458 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:05:26,507 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:08:01,565 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:08:02,204 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:08:02,294 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:06:59,399 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:07:31,201 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:07:31,246 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:08:18,865 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:08:19,323 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:08:19,406 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:09:04,362 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:09:21,290 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:09:21,339 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:09:43,728 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:09:44,203 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:09:44,274 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:10:26,236 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:10:26,727 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:10:26,798 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:10:59,964 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:11:17,437 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:11:17,476 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:11:22,415 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:11:22,886 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:11:22,945 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:12:25,391 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:12:25,836 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:12:25,876 - app.api.endpoints.auth - INFO - Password verified for user: e2e_test@example.com, User ID: e2e_test_user_id
2025-04-27 04:12:25,877 - app.api.endpoints.auth - INFO - JWT created successfully for user: e2e_test@example.com
2025-04-27 04:12:26,716 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 04:12:26,718 - app.core.storage - INFO - Attempting to create conversation 7b45d811ecd044ecb69f50314ab669cc for user anon_02d927cef254b780
2025-04-27 04:12:27,619 - app.core.storage - INFO - Successfully created conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:27,905 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 04:12:27,908 - app.core.chat_service - INFO - Stored user message (ID: anon_0770143399a64c6aa4424f8f2d3a80e0) for conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:27,908 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 04:12:27,909 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 04:12:27,914 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 04:12:36,866 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 04:12:36,868 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:36,869 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 04:12:36,870 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 04:12:36,870 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 7b45d811ecd044ecb69f50314ab669cc...
2025-04-27 04:12:36,870 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 04:12:37,356 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 04:12:37,357 - app.core.chat_service - INFO - Mistral response successful for conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:37,357 - app.core.chat_service - INFO - Stored AI message (ID: anon_ca306b4cb6a041b197c3638dd3e11ef1) for conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:38,526 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 04:12:38,527 - app.core.chat_service - INFO - Stored user message (ID: anon_791d9ee712a04641a38b4ec057d0544b) for conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:38,527 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 04:12:38,532 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 04:12:40,273 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 04:12:40,283 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:40,291 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 04:12:40,299 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 04:12:40,299 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 7b45d811ecd044ecb69f50314ab669cc...
2025-04-27 04:12:40,300 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 04:12:42,378 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 04:12:42,378 - app.core.chat_service - INFO - Mistral response successful for conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:42,379 - app.core.chat_service - INFO - Stored AI message (ID: anon_63815759cafb40ac83d6a26a390e95be) for conversation 7b45d811ecd044ecb69f50314ab669cc
2025-04-27 04:12:42,644 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 04:12:48,254 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:12:52,746 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:13:03,364 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:13:03,403 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:15:44,857 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:15:45,602 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:15:45,642 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-27 04:15:45,642 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-27 04:15:59,451 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:16:06,425 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:17:41,221 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:17:41,255 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:17:50,830 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:17:51,307 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:17:51,351 - app.api.endpoints.auth - INFO - Password verified for user: e2e_test@example.com, User ID: e2e_test_user_id
2025-04-27 04:17:51,351 - app.api.endpoints.auth - INFO - JWT created successfully for user: e2e_test@example.com
2025-04-27 04:17:52,009 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 04:17:52,010 - app.core.storage - INFO - Attempting to create conversation c56f0fe7712c41c1b213c703a9d7da4f for user anon_7d90b9351119643a
2025-04-27 04:17:52,500 - app.core.storage - INFO - Successfully created conversation c56f0fe7712c41c1b213c703a9d7da4f
2025-04-27 04:17:52,682 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 04:17:52,685 - app.core.chat_service - INFO - Stored user message (ID: anon_c2ef1bfb14b64fd8a09a6bbde154e305) for conversation c56f0fe7712c41c1b213c703a9d7da4f
2025-04-27 04:17:52,685 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 04:17:52,686 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 04:17:52,691 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 04:16:40,417 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 04:16:40,418 - app.core.chat_service - INFO - Retrieved 5 documents for conversation c56f0fe7712c41c1b213c703a9d7da4f
2025-04-27 04:16:40,419 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 04:16:40,420 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 04:16:40,420 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation c56f0fe7712c41c1b213c703a9d7da4f...
2025-04-27 04:16:40,421 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 04:16:41,727 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 04:16:41,728 - app.core.chat_service - INFO - Mistral response successful for conversation c56f0fe7712c41c1b213c703a9d7da4f
2025-04-27 04:16:41,728 - app.core.chat_service - INFO - Stored AI message (ID: anon_5ddbbf22b01e44a6bc9db6997ce381f8) for conversation c56f0fe7712c41c1b213c703a9d7da4f
2025-04-27 04:16:51,593 - app.api.auth_utils - ERROR - Appwrite token validation error: Failed to verify JWT. Invalid token: Incomplete segments (Code: 401, Type: user_jwt_invalid)
2025-04-27 04:16:51,806 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:20:48,325 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:20:49,096 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:20:49,168 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-27 04:20:49,169 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-27 04:21:01,413 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:21:18,641 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:21:35,772 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:21:35,802 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:28:11,427 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:28:11,931 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:28:11,991 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-27 04:28:11,992 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-27 04:28:22,619 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 04:29:58,527 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 04:29:58,982 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 04:29:59,601 - app.api.endpoints.auth - INFO - User registered successfully: wptb44t5xv@test.pytest.dev, ID: 680da4b71a561bbbe948
2025-04-27 04:30:00,488 - app.api.endpoints.auth - INFO - Password verified for user: wptb44t5xv@test.pytest.dev, User ID: 680da4b71a561bbbe948
2025-04-27 04:30:00,672 - app.api.endpoints.auth - INFO - JWT created successfully for user: wptb44t5xv@test.pytest.dev
2025-04-27 04:30:00,952 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 22:43:03,922 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 22:43:04,037 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 22:43:46,828 - app.api.endpoints.rag_query - INFO - Received RAG query: hi...
2025-04-27 22:43:46,829 - app.core.rag - INFO - Processing RAG query: hi...
2025-04-27 22:43:46,829 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 22:43:46,830 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:43:46,842 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:43:48,287 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:43:48,290 - app.core.rag - INFO - Reranking results (placeholder)
2025-04-27 22:43:48,291 - app.core.rag - ERROR - Error generating LLM response: 'Chat' object is not callable
2025-04-27 22:43:48,292 - app.core.rag - INFO - RAG response generated successfully
2025-04-27 22:44:16,399 - app.api.endpoints.rag_query - INFO - Received RAG query: wht is this...
2025-04-27 22:44:16,407 - app.core.rag - INFO - Processing RAG query: wht is this...
2025-04-27 22:44:16,409 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:44:16,522 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:44:17,162 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:44:17,164 - app.core.rag - INFO - Reranking results (placeholder)
2025-04-27 22:44:17,164 - app.core.rag - ERROR - Error generating LLM response: 'Chat' object is not callable
2025-04-27 22:44:17,165 - app.core.rag - INFO - RAG response generated successfully
2025-04-27 22:44:49,975 - app.api.endpoints.rag_query - INFO - Received RAG query: hi...
2025-04-27 22:44:49,994 - app.core.rag - INFO - Processing RAG query: hi...
2025-04-27 22:44:49,998 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:44:50,014 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:44:51,249 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:44:51,251 - app.core.rag - INFO - Reranking results (placeholder)
2025-04-27 22:44:51,256 - app.core.rag - ERROR - Error generating LLM response: 'Chat' object is not callable
2025-04-27 22:44:51,257 - app.core.rag - INFO - RAG response generated successfully
2025-04-27 22:44:56,781 - app.api.endpoints.rag_query - INFO - Received RAG query: hi...
2025-04-27 22:44:56,801 - app.core.rag - INFO - Processing RAG query: hi...
2025-04-27 22:44:56,820 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:44:56,880 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:44:57,567 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:44:57,569 - app.core.rag - INFO - Reranking results (placeholder)
2025-04-27 22:44:57,571 - app.core.rag - ERROR - Error generating LLM response: 'Chat' object is not callable
2025-04-27 22:44:57,572 - app.core.rag - INFO - RAG response generated successfully
2025-04-27 22:45:04,284 - app.api.endpoints.rag_query - INFO - Received RAG query: hi...
2025-04-27 22:45:04,294 - app.core.rag - INFO - Processing RAG query: hi...
2025-04-27 22:45:04,295 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:45:04,298 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:45:05,477 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:45:05,479 - app.core.rag - INFO - Reranking results (placeholder)
2025-04-27 22:45:05,480 - app.core.rag - ERROR - Error generating LLM response: 'Chat' object is not callable
2025-04-27 22:45:05,480 - app.core.rag - INFO - RAG response generated successfully
2025-04-27 22:45:40,431 - app.api.endpoints.rag_query - INFO - Received RAG query: hi...
2025-04-27 22:45:40,432 - app.core.rag - INFO - Processing RAG query: hi...
2025-04-27 22:45:40,433 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:45:40,461 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:45:41,686 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:45:41,688 - app.core.rag - INFO - Reranking results (placeholder)
2025-04-27 22:45:41,689 - app.core.rag - ERROR - Error generating LLM response: 'Chat' object is not callable
2025-04-27 22:45:41,689 - app.core.rag - INFO - RAG response generated successfully
2025-04-27 22:45:58,896 - app.api.endpoints.rag_query - INFO - Received RAG query: hi...
2025-04-27 22:45:58,907 - app.core.rag - INFO - Processing RAG query: hi...
2025-04-27 22:45:58,909 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:45:58,919 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:46:00,525 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:46:00,528 - app.core.rag - INFO - Reranking results (placeholder)
2025-04-27 22:46:00,529 - app.core.rag - ERROR - Error generating LLM response: 'Chat' object is not callable
2025-04-27 22:46:00,530 - app.core.rag - INFO - RAG response generated successfully
2025-04-27 22:47:01,154 - app.api.endpoints.auth - INFO - User registered successfully: test7731@example.com, ID: 680ea5d48d3af1f44f6b
2025-04-27 22:47:01,813 - app.api.endpoints.auth - INFO - Password verified for user: test7731@example.com, User ID: 680ea5d48d3af1f44f6b
2025-04-27 22:47:01,978 - app.api.endpoints.auth - INFO - JWT created successfully for user: test7731@example.com
2025-04-27 22:47:03,269 - app.core.storage - INFO - Attempting to create conversation 411f92001cc04538b0797b15322bc303 for user 680ea5d48d3af1f44f6b
2025-04-27 22:47:03,473 - app.core.storage - INFO - Successfully created conversation 411f92001cc04538b0797b15322bc303
2025-04-27 22:47:03,474 - app.api.endpoints.chat - INFO - Created new conversation 411f92001cc04538b0797b15322bc303 for message.
2025-04-27 22:47:03,816 - app.core.storage - INFO - Stored message 680ea5d79d5da7357193 for user 680ea5d48d3af1f44f6b
2025-04-27 22:47:03,817 - app.core.chat_service - INFO - Stored user message (ID: 680ea5d79d5da7357193) for conversation 411f92001cc04538b0797b15322bc303
2025-04-27 22:47:04,016 - app.core.storage - INFO - Timestamp updated for conversation 411f92001cc04538b0797b15322bc303
2025-04-27 22:47:04,017 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:47:04,022 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:47:05,031 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:47:05,033 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 411f92001cc04538b0797b15322bc303
2025-04-27 22:47:05,034 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:47:05,034 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:47:05,035 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 411f92001cc04538b0797b15322bc303...
2025-04-27 22:47:05,036 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:47:06,003 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:47:06,004 - app.core.chat_service - INFO - Mistral response successful for conversation 411f92001cc04538b0797b15322bc303
2025-04-27 22:47:06,189 - app.core.storage - INFO - Stored message 680ea5d9c2ea0500fa8d for user ai
2025-04-27 22:47:07,108 - app.core.storage - INFO - Stored 5 sources for message 680ea5d9c2ea0500fa8d
2025-04-27 22:47:07,110 - app.core.chat_service - INFO - Stored AI message (ID: 680ea5d9c2ea0500fa8d) for conversation 411f92001cc04538b0797b15322bc303
2025-04-27 22:47:07,362 - app.core.storage - INFO - Timestamp updated for conversation 411f92001cc04538b0797b15322bc303
2025-04-27 22:47:07,700 - app.core.storage - INFO - Attempting to create conversation cb93562a37ab4edfbbf8a196d6eb5997 for user 680ea5d48d3af1f44f6b
2025-04-27 22:47:07,910 - app.core.storage - INFO - Successfully created conversation cb93562a37ab4edfbbf8a196d6eb5997
2025-04-27 22:47:07,910 - app.api.endpoints.chat - INFO - Created new conversation cb93562a37ab4edfbbf8a196d6eb5997 for message.
2025-04-27 22:47:08,254 - app.core.storage - INFO - Stored message 680ea5dc1e1a6cbbf55f for user 680ea5d48d3af1f44f6b
2025-04-27 22:47:08,254 - app.core.chat_service - INFO - Stored user message (ID: 680ea5dc1e1a6cbbf55f) for conversation cb93562a37ab4edfbbf8a196d6eb5997
2025-04-27 22:47:08,458 - app.core.storage - INFO - Timestamp updated for conversation cb93562a37ab4edfbbf8a196d6eb5997
2025-04-27 22:47:08,459 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:47:08,464 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:47:09,357 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:47:09,359 - app.core.chat_service - INFO - Retrieved 5 documents for conversation cb93562a37ab4edfbbf8a196d6eb5997
2025-04-27 22:47:09,360 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:47:09,361 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:47:09,361 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation cb93562a37ab4edfbbf8a196d6eb5997...
2025-04-27 22:47:09,362 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:47:10,446 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:47:10,447 - app.core.chat_service - INFO - Mistral response successful for conversation cb93562a37ab4edfbbf8a196d6eb5997
2025-04-27 22:47:10,648 - app.core.storage - INFO - Stored message 680ea5de47eb658b14c4 for user ai
2025-04-27 22:47:11,570 - app.core.storage - INFO - Stored 5 sources for message 680ea5de47eb658b14c4
2025-04-27 22:47:11,573 - app.core.chat_service - INFO - Stored AI message (ID: 680ea5de47eb658b14c4) for conversation cb93562a37ab4edfbbf8a196d6eb5997
2025-04-27 22:47:11,772 - app.core.storage - INFO - Timestamp updated for conversation cb93562a37ab4edfbbf8a196d6eb5997
2025-04-27 22:47:12,570 - app.core.storage - INFO - Attempting to create conversation f101a5e746844acf816acc3dd595d2f3 for user 680ea5d48d3af1f44f6b
2025-04-27 22:47:12,757 - app.core.storage - INFO - Successfully created conversation f101a5e746844acf816acc3dd595d2f3
2025-04-27 22:47:12,758 - app.api.endpoints.chat - INFO - Created new conversation f101a5e746844acf816acc3dd595d2f3 for message.
2025-04-27 22:47:12,625 - app.core.storage - INFO - Stored message 680ea5e085c5b4684378 for user 680ea5d48d3af1f44f6b
2025-04-27 22:47:12,626 - app.core.chat_service - INFO - Stored user message (ID: 680ea5e085c5b4684378) for conversation f101a5e746844acf816acc3dd595d2f3
2025-04-27 22:47:12,833 - app.core.storage - INFO - Timestamp updated for conversation f101a5e746844acf816acc3dd595d2f3
2025-04-27 22:47:12,836 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:47:12,843 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:47:13,742 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:47:13,744 - app.core.chat_service - INFO - Retrieved 5 documents for conversation f101a5e746844acf816acc3dd595d2f3
2025-04-27 22:47:13,745 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:47:13,746 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:47:13,746 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation f101a5e746844acf816acc3dd595d2f3...
2025-04-27 22:47:13,747 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:47:14,575 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:47:14,576 - app.core.chat_service - INFO - Mistral response successful for conversation f101a5e746844acf816acc3dd595d2f3
2025-04-27 22:47:14,752 - app.core.storage - INFO - Stored message 680ea5e2796899283a5c for user ai
2025-04-27 22:47:15,698 - app.core.storage - INFO - Stored 5 sources for message 680ea5e2796899283a5c
2025-04-27 22:47:15,699 - app.core.chat_service - INFO - Stored AI message (ID: 680ea5e2796899283a5c) for conversation f101a5e746844acf816acc3dd595d2f3
2025-04-27 22:47:15,890 - app.core.storage - INFO - Timestamp updated for conversation f101a5e746844acf816acc3dd595d2f3
2025-04-27 22:50:29,875 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 22:50:47,076 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 22:50:47,111 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 22:50:47,534 - app.api.endpoints.auth - INFO - User registered successfully: test17911@example.com, ID: 680ea6b6e072d9ede734
2025-04-27 22:50:48,204 - app.api.endpoints.auth - INFO - Password verified for user: test17911@example.com, User ID: 680ea6b6e072d9ede734
2025-04-27 22:52:04,770 - app.api.endpoints.auth - INFO - JWT created successfully for user: test17911@example.com
2025-04-27 22:50:49,000 - app.core.storage - INFO - Attempting to create conversation 344c5974d4ab4a20aef29b24525931a8 for user 680ea6b6e072d9ede734
2025-04-27 22:50:49,181 - app.core.storage - INFO - Successfully created conversation 344c5974d4ab4a20aef29b24525931a8
2025-04-27 22:50:49,181 - app.api.endpoints.chat - INFO - Created new conversation 344c5974d4ab4a20aef29b24525931a8 for message.
2025-04-27 22:50:49,541 - app.core.storage - INFO - Stored message 680ea6b95564db63d3f6 for user 680ea6b6e072d9ede734
2025-04-27 22:50:49,541 - app.core.chat_service - INFO - Stored user message (ID: 680ea6b95564db63d3f6) for conversation 344c5974d4ab4a20aef29b24525931a8
2025-04-27 22:50:49,720 - app.core.storage - INFO - Timestamp updated for conversation 344c5974d4ab4a20aef29b24525931a8
2025-04-27 22:50:49,721 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 22:50:49,722 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:50:49,725 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:50:52,027 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:50:52,029 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 344c5974d4ab4a20aef29b24525931a8
2025-04-27 22:50:52,031 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:50:52,031 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:50:52,032 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 344c5974d4ab4a20aef29b24525931a8...
2025-04-27 22:50:52,033 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:50:52,198 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 22:50:52,199 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.26 seconds (calculated)...
2025-04-27 22:50:53,606 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:50:53,607 - app.core.chat_service - INFO - Mistral response successful for conversation 344c5974d4ab4a20aef29b24525931a8
2025-04-27 22:50:53,818 - app.core.storage - INFO - Stored message 680ea6bda7ae24205e21 for user ai
2025-04-27 22:50:54,740 - app.core.storage - INFO - Stored 5 sources for message 680ea6bda7ae24205e21
2025-04-27 22:50:54,740 - app.core.chat_service - INFO - Stored AI message (ID: 680ea6bda7ae24205e21) for conversation 344c5974d4ab4a20aef29b24525931a8
2025-04-27 22:50:54,929 - app.core.storage - INFO - Timestamp updated for conversation 344c5974d4ab4a20aef29b24525931a8
2025-04-27 22:50:55,764 - app.core.storage - INFO - Attempting to create conversation 3eea95ca0bc74482b2295ae493caa1d2 for user 680ea6b6e072d9ede734
2025-04-27 22:50:55,945 - app.core.storage - INFO - Successfully created conversation 3eea95ca0bc74482b2295ae493caa1d2
2025-04-27 22:50:55,945 - app.api.endpoints.chat - INFO - Created new conversation 3eea95ca0bc74482b2295ae493caa1d2 for message.
2025-04-27 22:50:56,286 - app.core.storage - INFO - Stored message 680ea6bfe4995837094b for user 680ea6b6e072d9ede734
2025-04-27 22:50:56,287 - app.core.chat_service - INFO - Stored user message (ID: 680ea6bfe4995837094b) for conversation 3eea95ca0bc74482b2295ae493caa1d2
2025-04-27 22:50:56,461 - app.core.storage - INFO - Timestamp updated for conversation 3eea95ca0bc74482b2295ae493caa1d2
2025-04-27 22:50:56,462 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:50:56,465 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:50:57,649 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:50:57,651 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3eea95ca0bc74482b2295ae493caa1d2
2025-04-27 22:50:57,652 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:50:57,653 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:50:57,653 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 3eea95ca0bc74482b2295ae493caa1d2...
2025-04-27 22:50:57,653 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:50:57,817 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 22:50:57,818 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.16 seconds (calculated)...
2025-04-27 22:50:59,213 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:50:59,213 - app.core.chat_service - INFO - Mistral response successful for conversation 3eea95ca0bc74482b2295ae493caa1d2
2025-04-27 22:50:59,388 - app.core.storage - INFO - Stored message 680ea6c33586977646aa for user ai
2025-04-27 22:51:00,308 - app.core.storage - INFO - Stored 5 sources for message 680ea6c33586977646aa
2025-04-27 22:51:00,309 - app.core.chat_service - INFO - Stored AI message (ID: 680ea6c33586977646aa) for conversation 3eea95ca0bc74482b2295ae493caa1d2
2025-04-27 22:51:00,490 - app.core.storage - INFO - Timestamp updated for conversation 3eea95ca0bc74482b2295ae493caa1d2
2025-04-27 22:51:01,261 - app.core.storage - INFO - Attempting to create conversation 2a1723929daf44da9fcb8103cd22de9e for user 680ea6b6e072d9ede734
2025-04-27 22:51:01,453 - app.core.storage - INFO - Successfully created conversation 2a1723929daf44da9fcb8103cd22de9e
2025-04-27 22:51:01,455 - app.api.endpoints.chat - INFO - Created new conversation 2a1723929daf44da9fcb8103cd22de9e for message.
2025-04-27 22:51:01,816 - app.core.storage - INFO - Stored message 680ea6c566599a387f82 for user 680ea6b6e072d9ede734
2025-04-27 22:51:01,816 - app.core.chat_service - INFO - Stored user message (ID: 680ea6c566599a387f82) for conversation 2a1723929daf44da9fcb8103cd22de9e
2025-04-27 22:51:01,989 - app.core.storage - INFO - Timestamp updated for conversation 2a1723929daf44da9fcb8103cd22de9e
2025-04-27 22:51:01,990 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:51:01,993 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:51:03,089 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:51:03,091 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 2a1723929daf44da9fcb8103cd22de9e
2025-04-27 22:51:03,094 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:51:03,095 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:51:03,096 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 2a1723929daf44da9fcb8103cd22de9e...
2025-04-27 22:51:03,096 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:51:03,262 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 22:51:03,262 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.20 seconds (calculated)...
2025-04-27 22:51:04,591 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:51:04,591 - app.core.chat_service - INFO - Mistral response successful for conversation 2a1723929daf44da9fcb8103cd22de9e
2025-04-27 22:51:04,765 - app.core.storage - INFO - Stored message 680ea6c884eb080677c1 for user ai
2025-04-27 22:51:05,693 - app.core.storage - INFO - Stored 5 sources for message 680ea6c884eb080677c1
2025-04-27 22:51:05,693 - app.core.chat_service - INFO - Stored AI message (ID: 680ea6c884eb080677c1) for conversation 2a1723929daf44da9fcb8103cd22de9e
2025-04-27 22:51:05,871 - app.core.storage - INFO - Timestamp updated for conversation 2a1723929daf44da9fcb8103cd22de9e
2025-04-27 22:52:59,781 - app.api.endpoints.auth - INFO - User registered successfully: test4096@example.com, ID: 680ea73b726b4a77d7df
2025-04-27 22:53:00,440 - app.api.endpoints.auth - INFO - Password verified for user: test4096@example.com, User ID: 680ea73b726b4a77d7df
2025-04-27 22:53:00,613 - app.api.endpoints.auth - INFO - JWT created successfully for user: test4096@example.com
2025-04-27 22:53:02,510 - app.core.storage - INFO - Stored message 680ea73e0dd645717cd7 for user 680ea73b726b4a77d7df
2025-04-27 22:53:02,525 - app.core.chat_service - INFO - Stored user message (ID: 680ea73e0dd645717cd7) for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:02,742 - app.core.storage - INFO - Timestamp updated for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:02,745 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:53:02,772 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:53:03,462 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:53:03,464 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:03,465 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:53:03,465 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:53:03,466 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 8e0685fc2e7a4eb49631f99395beeb2c...
2025-04-27 22:53:03,467 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:53:05,404 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:53:05,405 - app.core.chat_service - INFO - Mistral response successful for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:05,592 - app.core.storage - INFO - Stored message 680ea74150c62f57f149 for user ai
2025-04-27 22:53:06,560 - app.core.storage - INFO - Stored 5 sources for message 680ea74150c62f57f149
2025-04-27 22:53:06,560 - app.core.chat_service - INFO - Stored AI message (ID: 680ea74150c62f57f149) for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:06,740 - app.core.storage - INFO - Timestamp updated for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:07,421 - app.api.endpoints.chat - WARNING - User 680ea73b726b4a77d7df attempted to access conversation 8e0685fc2e7a4eb49631f99395beeb2c owned by 680ea720e1658ca5c171
2025-04-27 22:53:08,289 - app.core.storage - INFO - Stored message 680ea743c261b1ecac79 for user 680ea73b726b4a77d7df
2025-04-27 22:53:08,289 - app.core.chat_service - INFO - Stored user message (ID: 680ea743c261b1ecac79) for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:08,463 - app.core.storage - INFO - Timestamp updated for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:08,464 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:53:08,467 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:53:09,006 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:53:09,008 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:09,009 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:53:09,010 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:53:09,010 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 8e0685fc2e7a4eb49631f99395beeb2c...
2025-04-27 22:53:09,011 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:53:09,950 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:53:09,951 - app.core.chat_service - INFO - Mistral response successful for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:10,173 - app.core.storage - INFO - Stored message 680ea745eb25b8177928 for user ai
2025-04-27 22:53:11,133 - app.core.storage - INFO - Stored 5 sources for message 680ea745eb25b8177928
2025-04-27 22:53:11,133 - app.core.chat_service - INFO - Stored AI message (ID: 680ea745eb25b8177928) for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:11,347 - app.core.storage - INFO - Timestamp updated for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:11,982 - app.api.endpoints.chat - WARNING - User 680ea73b726b4a77d7df attempted to access conversation 8e0685fc2e7a4eb49631f99395beeb2c owned by 680ea720e1658ca5c171
2025-04-27 22:53:12,832 - app.core.storage - INFO - Stored message 680ea7485f98a5add334 for user 680ea73b726b4a77d7df
2025-04-27 22:53:12,833 - app.core.chat_service - INFO - Stored user message (ID: 680ea7485f98a5add334) for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:13,028 - app.core.storage - INFO - Timestamp updated for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:13,029 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:53:13,031 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:53:13,465 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:53:13,467 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:13,469 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:53:13,470 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:53:13,470 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 8e0685fc2e7a4eb49631f99395beeb2c...
2025-04-27 22:53:13,471 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:53:13,746 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 22:53:13,749 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.39 seconds (calculated)...
2025-04-27 22:53:16,272 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:53:16,273 - app.core.chat_service - INFO - Mistral response successful for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:16,480 - app.core.storage - INFO - Stored message 680ea74c25b60a6e8add for user ai
2025-04-27 22:53:17,374 - app.core.storage - INFO - Stored 5 sources for message 680ea74c25b60a6e8add
2025-04-27 22:53:17,375 - app.core.chat_service - INFO - Stored AI message (ID: 680ea74c25b60a6e8add) for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:17,553 - app.core.storage - INFO - Timestamp updated for conversation 8e0685fc2e7a4eb49631f99395beeb2c
2025-04-27 22:53:18,197 - app.api.endpoints.chat - WARNING - User 680ea73b726b4a77d7df attempted to access conversation 8e0685fc2e7a4eb49631f99395beeb2c owned by 680ea720e1658ca5c171
2025-04-27 22:53:52,957 - app.api.endpoints.auth - INFO - User registered successfully: test25489@example.com, ID: 680ea77053afd7d2a10a
2025-04-27 22:53:53,590 - app.api.endpoints.auth - INFO - Password verified for user: test25489@example.com, User ID: 680ea77053afd7d2a10a
2025-04-27 22:53:53,744 - app.api.endpoints.auth - INFO - JWT created successfully for user: test25489@example.com
2025-04-27 22:53:54,447 - app.core.storage - INFO - Attempting to create conversation 3fcfa0dbac0d4d3492ab39deb8a5da64 for user 680ea77053afd7d2a10a
2025-04-27 22:53:54,626 - app.core.storage - INFO - Successfully created conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:53:56,277 - app.core.storage - INFO - Stored message 680ea773ec545a3e120d for user 680ea77053afd7d2a10a
2025-04-27 22:53:56,277 - app.core.chat_service - INFO - Stored user message (ID: 680ea773ec545a3e120d) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:53:56,468 - app.core.storage - INFO - Timestamp updated for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:53:56,470 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:53:56,473 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:53:57,532 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:53:57,534 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:53:57,535 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:53:57,537 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:53:57,537 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64...
2025-04-27 22:53:57,538 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:53:57,723 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 22:53:57,723 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.89 seconds (calculated)...
2025-04-27 22:54:01,001 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:54:01,002 - app.core.chat_service - INFO - Mistral response successful for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:01,214 - app.core.storage - INFO - Stored message 680ea778e12d46182ad9 for user ai
2025-04-27 22:54:02,379 - app.core.storage - INFO - Stored 5 sources for message 680ea778e12d46182ad9
2025-04-27 22:54:02,380 - app.core.chat_service - INFO - Stored AI message (ID: 680ea778e12d46182ad9) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:02,567 - app.core.storage - INFO - Timestamp updated for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:03,862 - app.core.storage - INFO - Stored message 680ea77bbdb7fcd3aee5 for user 680ea77053afd7d2a10a
2025-04-27 22:54:03,863 - app.core.chat_service - INFO - Stored user message (ID: 680ea77bbdb7fcd3aee5) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:04,060 - app.core.storage - INFO - Timestamp updated for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:04,061 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:54:04,063 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:54:05,220 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:54:05,222 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:05,223 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:54:05,224 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:54:05,224 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64...
2025-04-27 22:54:05,225 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:54:06,322 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:54:06,322 - app.core.chat_service - INFO - Mistral response successful for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:06,505 - app.core.storage - INFO - Stored message 680ea77e2bc487b566e2 for user ai
2025-04-27 22:54:07,573 - app.core.storage - INFO - Stored 5 sources for message 680ea77e2bc487b566e2
2025-04-27 22:54:07,573 - app.core.chat_service - INFO - Stored AI message (ID: 680ea77e2bc487b566e2) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:07,767 - app.core.storage - INFO - Timestamp updated for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:08,979 - app.core.storage - INFO - Stored message 680ea780d8cd7f2d8b60 for user 680ea77053afd7d2a10a
2025-04-27 22:54:08,980 - app.core.chat_service - INFO - Stored user message (ID: 680ea780d8cd7f2d8b60) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:09,178 - app.core.storage - INFO - Timestamp updated for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:09,179 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:54:09,182 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:54:10,160 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:54:10,162 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:10,164 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 22:54:10,165 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 22:54:10,165 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64...
2025-04-27 22:54:10,167 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 22:54:10,362 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 22:54:10,363 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.21 seconds (calculated)...
2025-04-27 22:54:12,461 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 22:54:12,462 - app.core.chat_service - INFO - Mistral response successful for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:13,708 - app.core.storage - INFO - Stored message 680ea7852c6215bc759e for user ai
2025-04-27 22:54:14,246 - app.core.storage - INFO - Stored 5 sources for message 680ea7852c6215bc759e
2025-04-27 22:54:14,246 - app.core.chat_service - INFO - Stored AI message (ID: 680ea7852c6215bc759e) for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:54:14,432 - app.core.storage - INFO - Timestamp updated for conversation 3fcfa0dbac0d4d3492ab39deb8a5da64
2025-04-27 22:55:07,176 - app.api.endpoints.rag_query - INFO - Received RAG query: hi...
2025-04-27 22:55:07,187 - app.core.rag - INFO - Processing RAG query: hi...
2025-04-27 22:55:07,188 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 22:55:07,226 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 22:55:08,444 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 22:55:08,446 - app.core.rag - INFO - Reranking results (placeholder)
2025-04-27 22:55:08,447 - app.core.rag - ERROR - Error generating LLM response: 'Chat' object is not callable
2025-04-27 22:55:08,448 - app.core.rag - INFO - RAG response generated successfully
2025-04-27 22:59:49,320 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 23:00:07,532 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 23:00:07,578 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 23:02:52,238 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-27 23:25:24,628 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-27 23:25:24,704 - app.main - INFO - Application startup: initializing services and connections
2025-04-27 23:26:25,852 - app.api.endpoints.auth - INFO - User registered successfully: test11653@example.com, ID: 680eaf114889265470f1
2025-04-27 23:26:26,537 - app.api.endpoints.auth - INFO - Password verified for user: test11653@example.com, User ID: 680eaf114889265470f1
2025-04-27 23:26:26,690 - app.api.endpoints.auth - INFO - JWT created successfully for user: test11653@example.com
2025-04-27 23:26:27,394 - app.core.storage - INFO - Attempting to create conversation 4cb0841788104271902da7133149e206 for user 680eaf114889265470f1
2025-04-27 23:26:27,577 - app.core.storage - INFO - Successfully created conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:29,054 - app.core.storage - INFO - Stored message 680eaf14ca741760c0d0 for user 680eaf114889265470f1
2025-04-27 23:26:29,058 - app.core.chat_service - INFO - Stored user message (ID: 680eaf14ca741760c0d0) for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:29,248 - app.core.storage - INFO - Timestamp updated for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:29,248 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-27 23:26:29,249 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 23:26:29,253 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 23:26:31,571 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 23:26:31,573 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:31,574 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 23:26:31,575 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 23:26:31,575 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 4cb0841788104271902da7133149e206...
2025-04-27 23:26:31,576 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 23:26:33,213 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 23:26:33,214 - app.core.chat_service - INFO - Mistral response successful for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:33,382 - app.core.storage - INFO - Stored message 680eaf193571d7793cbb for user ai
2025-04-27 23:26:34,279 - app.core.storage - INFO - Stored 5 sources for message 680eaf193571d7793cbb
2025-04-27 23:26:34,280 - app.core.chat_service - INFO - Stored AI message (ID: 680eaf193571d7793cbb) for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:34,483 - app.core.storage - INFO - Timestamp updated for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:35,531 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eaf193571d7793cbb: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf195e716b...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1984d1de...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf19aa6af7...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf19d4491a...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1a0897a5...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:26:36,381 - app.core.storage - INFO - Stored message 680eaf1be4974b623192 for user 680eaf114889265470f1
2025-04-27 23:26:36,382 - app.core.chat_service - INFO - Stored user message (ID: 680eaf1be4974b623192) for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:36,570 - app.core.storage - INFO - Timestamp updated for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:36,571 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 23:26:36,574 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 23:26:37,245 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 23:26:37,248 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:37,249 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 23:26:37,250 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 23:26:37,250 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 4cb0841788104271902da7133149e206...
2025-04-27 23:26:37,251 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 23:26:37,510 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-27 23:26:37,511 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.43 seconds (calculated)...
2025-04-27 23:26:39,585 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 23:26:39,586 - app.core.chat_service - INFO - Mistral response successful for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:39,770 - app.core.storage - INFO - Stored message 680eaf1f742bc087856a for user ai
2025-04-27 23:26:40,659 - app.core.storage - INFO - Stored 5 sources for message 680eaf1f742bc087856a
2025-04-27 23:26:40,660 - app.core.chat_service - INFO - Stored AI message (ID: 680eaf1f742bc087856a) for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:40,852 - app.core.storage - INFO - Timestamp updated for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:41,850 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eaf193571d7793cbb: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf195e716b...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1984d1de...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf19aa6af7...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf19d4491a...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1a0897a5...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:26:41,851 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eaf1f742bc087856a: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1fa062a3...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1fc56691...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1fe9c1fa...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf201a9308...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf204425d4..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:26:42,178 - app.core.storage - INFO - Stored message 680eaf221d0d05076650 for user 680eaf114889265470f1
2025-04-27 23:26:42,179 - app.core.chat_service - INFO - Stored user message (ID: 680eaf221d0d05076650) for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:42,351 - app.core.storage - INFO - Timestamp updated for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:42,352 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 23:26:42,355 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 23:26:43,372 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 23:26:43,374 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:43,375 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 23:26:43,376 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 23:26:43,376 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 4cb0841788104271902da7133149e206...
2025-04-27 23:26:43,377 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 23:26:44,129 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 23:26:44,130 - app.core.chat_service - INFO - Mistral response successful for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:44,301 - app.core.storage - INFO - Stored message 680eaf240be328fcf9ed for user ai
2025-04-27 23:26:45,273 - app.core.storage - INFO - Stored 5 sources for message 680eaf240be328fcf9ed
2025-04-27 23:26:45,273 - app.core.chat_service - INFO - Stored AI message (ID: 680eaf240be328fcf9ed) for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:45,455 - app.core.storage - INFO - Timestamp updated for conversation 4cb0841788104271902da7133149e206
2025-04-27 23:26:46,599 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eaf193571d7793cbb: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf195e716b...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1984d1de...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf19aa6af7...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf19d4491a...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1a0897a5...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:26:46,600 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eaf1f742bc087856a: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1fa062a3...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1fc56691...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf1fe9c1fa...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf201a9308...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf204425d4..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:26:46,601 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eaf240be328fcf9ed: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf24340ab3...5_0_2_0_510', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf24602106...5_0_2_0_205', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf248a60fe...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf24b94118...315_0_3_1_5', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eaf24e2dd26...5_0_5_0_124', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:44:04,169 - app.api.endpoints.auth - INFO - User registered successfully: test29425@example.com, ID: 680eb333b6736fd0cc27
2025-04-27 23:44:05,156 - app.api.endpoints.auth - INFO - Password verified for user: test29425@example.com, User ID: 680eb333b6736fd0cc27
2025-04-27 23:44:05,370 - app.api.endpoints.auth - INFO - JWT created successfully for user: test29425@example.com
2025-04-27 23:44:07,527 - app.core.storage - INFO - Attempting to create conversation 7e1128882fc34940b39d8c180d69e750 for user 680eb333b6736fd0cc27
2025-04-27 23:44:07,745 - app.core.storage - INFO - Successfully created conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:09,260 - app.core.storage - INFO - Stored message 680eb339066632bc9fa7 for user 680eb333b6736fd0cc27
2025-04-27 23:44:09,262 - app.core.chat_service - INFO - Stored user message (ID: 680eb339066632bc9fa7) for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:09,496 - app.core.storage - INFO - Timestamp updated for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:09,497 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 23:44:09,554 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 23:44:11,420 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 23:44:11,422 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:11,434 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 23:44:11,436 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 23:44:11,442 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 7e1128882fc34940b39d8c180d69e750...
2025-04-27 23:44:11,443 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 23:44:12,273 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 23:44:12,278 - app.core.chat_service - INFO - Mistral response successful for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:12,465 - app.core.storage - INFO - Stored message 680eb33be5a66f701916 for user ai
2025-04-27 23:44:12,955 - app.core.storage - INFO - Stored 5 sources for message 680eb33be5a66f701916
2025-04-27 23:44:12,957 - app.core.chat_service - INFO - Stored AI message (ID: 680eb33be5a66f701916) for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:13,159 - app.core.storage - INFO - Timestamp updated for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:14,448 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eb33be5a66f701916: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c246a26...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c50759f...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c7c5e26...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33ca6083b...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33ccd0f45...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:44:15,396 - app.core.storage - INFO - Stored message 680eb33f0ba694f8e56b for user 680eb333b6736fd0cc27
2025-04-27 23:44:15,397 - app.core.chat_service - INFO - Stored user message (ID: 680eb33f0ba694f8e56b) for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:15,600 - app.core.storage - INFO - Timestamp updated for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:15,730 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 23:44:15,848 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 23:44:17,137 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 23:44:17,139 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:17,140 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 23:44:17,140 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 23:44:17,140 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 7e1128882fc34940b39d8c180d69e750...
2025-04-27 23:44:17,141 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 23:44:17,438 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 23:44:17,439 - app.core.chat_service - INFO - Mistral response successful for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:17,629 - app.core.storage - INFO - Stored message 680eb341843adb34f84b for user ai
2025-04-27 23:44:18,568 - app.core.storage - INFO - Stored 5 sources for message 680eb341843adb34f84b
2025-04-27 23:44:18,569 - app.core.chat_service - INFO - Stored AI message (ID: 680eb341843adb34f84b) for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:18,775 - app.core.storage - INFO - Timestamp updated for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:20,995 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eb33be5a66f701916: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c246a26...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c50759f...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c7c5e26...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33ca6083b...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33ccd0f45...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:44:20,999 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eb341843adb34f84b: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb341aa337a...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb341d2e9e6...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb3420e5b7d...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb34237d2b1...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb3426055d4..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:44:21,862 - app.core.storage - INFO - Stored message 680eb3455c541049fc38 for user 680eb333b6736fd0cc27
2025-04-27 23:44:21,863 - app.core.chat_service - INFO - Stored user message (ID: 680eb3455c541049fc38) for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:22,066 - app.core.storage - INFO - Timestamp updated for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:22,066 - app.core.clients - INFO - Initializing Pinecone client
2025-04-27 23:44:22,070 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-27 23:44:22,561 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-27 23:44:22,564 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:22,570 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-27 23:44:22,572 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-27 23:44:22,574 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 7e1128882fc34940b39d8c180d69e750...
2025-04-27 23:44:22,576 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-27 23:44:23,416 - app.core.llm_service - INFO - Mistral API call successful
2025-04-27 23:44:23,417 - app.core.chat_service - INFO - Mistral response successful for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:23,598 - app.core.storage - INFO - Stored message 680eb347650d93fb68af for user ai
2025-04-27 23:44:24,550 - app.core.storage - INFO - Stored 5 sources for message 680eb347650d93fb68af
2025-04-27 23:44:24,551 - app.core.chat_service - INFO - Stored AI message (ID: 680eb347650d93fb68af) for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:24,772 - app.core.storage - INFO - Timestamp updated for conversation 7e1128882fc34940b39d8c180d69e750
2025-04-27 23:44:25,834 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eb33be5a66f701916: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c246a26...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c50759f...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33c7c5e26...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33ca6083b...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb33ccd0f45...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:44:25,835 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eb341843adb34f84b: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb341aa337a...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb341d2e9e6...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb3420e5b7d...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb34237d2b1...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb3426055d4..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-27 23:44:25,836 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680eb347650d93fb68af: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb34790b588...5_0_2_0_510', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb347b8c228...5_0_2_0_205', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb347e83c2d...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb3481bc470...315_0_3_1_5', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680eb3484752ae...5_0_5_0_124', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:18:53,777 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 00:19:11,327 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 00:19:11,370 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 00:20:12,654 - app.api.endpoints.auth - INFO - User registered successfully: test30049@example.com, ID: 680ebbac236062f70cab
2025-04-28 00:20:13,424 - app.api.endpoints.auth - INFO - Password verified for user: test30049@example.com, User ID: 680ebbac236062f70cab
2025-04-28 00:20:13,580 - app.api.endpoints.auth - INFO - JWT created successfully for user: test30049@example.com
2025-04-28 00:20:14,745 - app.core.storage - INFO - Attempting to create conversation 0a25719846504b4b9844994ed81180d5 for user 680ebbac236062f70cab
2025-04-28 00:20:14,925 - app.core.storage - INFO - Successfully created conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:16,342 - app.core.storage - INFO - Stored message 680ebbb016c5592955f5 for user 680ebbac236062f70cab
2025-04-28 00:20:16,342 - app.core.chat_service - INFO - Stored user message (ID: 680ebbb016c5592955f5) for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:16,539 - app.core.storage - INFO - Timestamp updated for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:16,539 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-28 00:20:16,540 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 00:20:16,545 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 00:20:18,437 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 00:20:18,439 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:18,440 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 00:20:18,441 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 00:20:18,443 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 0a25719846504b4b9844994ed81180d5...
2025-04-28 00:20:18,447 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 00:20:19,723 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 00:20:19,729 - app.core.chat_service - INFO - Mistral response successful for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:19,997 - app.core.storage - INFO - Stored message 680ebbb3d8d3a27b2e7c for user ai
2025-04-28 00:20:20,964 - app.core.storage - INFO - Stored 5 sources for message 680ebbb3d8d3a27b2e7c
2025-04-28 00:20:20,965 - app.core.chat_service - INFO - Stored AI message (ID: 680ebbb3d8d3a27b2e7c) for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:21,143 - app.core.storage - INFO - Timestamp updated for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:22,201 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebbb3d8d3a27b2e7c: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb40e477b...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb43807e6...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb46def00...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb49470c4...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb4b985d9...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:20:23,181 - app.core.storage - INFO - Stored message 680ebbb6bf5ecba42465 for user 680ebbac236062f70cab
2025-04-28 00:20:23,182 - app.core.chat_service - INFO - Stored user message (ID: 680ebbb6bf5ecba42465) for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:23,390 - app.core.storage - INFO - Timestamp updated for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:23,391 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 00:20:23,394 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 00:20:24,342 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 00:20:24,343 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:24,344 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 00:20:24,345 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 00:20:24,345 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 0a25719846504b4b9844994ed81180d5...
2025-04-28 00:20:24,346 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 00:20:24,656 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 00:20:24,656 - app.core.chat_service - INFO - Mistral response successful for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:24,920 - app.core.storage - INFO - Stored message 680ebbb8c7b6edd619b2 for user ai
2025-04-28 00:20:25,881 - app.core.storage - INFO - Stored 5 sources for message 680ebbb8c7b6edd619b2
2025-04-28 00:20:25,882 - app.core.chat_service - INFO - Stored AI message (ID: 680ebbb8c7b6edd619b2) for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:26,063 - app.core.storage - INFO - Timestamp updated for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:27,080 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebbb3d8d3a27b2e7c: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb40e477b...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb43807e6...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb46def00...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb49470c4...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb4b985d9...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:20:27,081 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebbb8c7b6edd619b2: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb8f209f9...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb934b6b0...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb95d165d...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb9804861...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb9a78a6b..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:20:27,914 - app.core.storage - INFO - Stored message 680ebbbb858b9f7c3a76 for user 680ebbac236062f70cab
2025-04-28 00:20:27,915 - app.core.chat_service - INFO - Stored user message (ID: 680ebbbb858b9f7c3a76) for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:28,093 - app.core.storage - INFO - Timestamp updated for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:28,094 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 00:20:28,098 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 00:20:29,185 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 00:20:29,186 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:29,187 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 00:20:29,188 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 00:20:29,188 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 0a25719846504b4b9844994ed81180d5...
2025-04-28 00:20:29,189 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 00:20:29,582 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 00:20:29,582 - app.core.chat_service - INFO - Mistral response successful for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:29,751 - app.core.storage - INFO - Stored message 680ebbbda4bf67444aa8 for user ai
2025-04-28 00:20:30,633 - app.core.storage - INFO - Stored 5 sources for message 680ebbbda4bf67444aa8
2025-04-28 00:20:30,633 - app.core.chat_service - INFO - Stored AI message (ID: 680ebbbda4bf67444aa8) for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:30,823 - app.core.storage - INFO - Timestamp updated for conversation 0a25719846504b4b9844994ed81180d5
2025-04-28 00:20:31,827 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebbb3d8d3a27b2e7c: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb40e477b...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb43807e6...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb46def00...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb49470c4...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb4b985d9...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:20:31,828 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebbb8c7b6edd619b2: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb8f209f9...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb934b6b0...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb95d165d...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb9804861...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbb9a78a6b..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:20:31,829 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebbbda4bf67444aa8: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbbdca7c91...5_0_2_0_510', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbbdefd323...5_0_2_0_205', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbbe23fb94...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbbe49f695...315_0_3_1_5', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebbbe728e4e...5_0_5_0_124', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:20:38,416 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 00:20:53,217 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 00:20:53,262 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 00:21:44,557 - app.api.endpoints.auth - INFO - User registered successfully: test6507@example.com, ID: 680ebc07dca58027f77c
2025-04-28 00:21:44,710 - app.api.endpoints.auth - INFO - Password verified for user: test6507@example.com, User ID: 680ebc07dca58027f77c
2025-04-28 00:21:44,871 - app.api.endpoints.auth - INFO - JWT created successfully for user: test6507@example.com
2025-04-28 00:21:45,948 - app.core.storage - INFO - Attempting to create conversation ad134d9a44a6488f84d5da068e5c2250 for user 680ebc07dca58027f77c
2025-04-28 00:21:46,115 - app.core.storage - INFO - Successfully created conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:47,570 - app.core.storage - INFO - Stored message 680ebc0b31b18abfc6b9 for user 680ebc07dca58027f77c
2025-04-28 00:21:47,571 - app.core.chat_service - INFO - Stored user message (ID: 680ebc0b31b18abfc6b9) for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:47,742 - app.core.storage - INFO - Timestamp updated for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:47,743 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-28 00:21:47,744 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 00:21:47,746 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 00:21:49,160 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 00:21:49,162 - app.core.chat_service - INFO - Retrieved 5 documents for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:49,163 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 00:21:49,163 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 00:21:49,164 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation ad134d9a44a6488f84d5da068e5c2250...
2025-04-28 00:21:49,165 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 00:21:49,913 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 00:21:49,914 - app.core.chat_service - INFO - Mistral response successful for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:50,086 - app.core.storage - INFO - Stored message 680ebc0def9c474a23b6 for user ai
2025-04-28 00:21:51,031 - app.core.storage - INFO - Stored 5 sources for message 680ebc0def9c474a23b6
2025-04-28 00:21:51,033 - app.core.chat_service - INFO - Stored AI message (ID: 680ebc0def9c474a23b6) for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:51,208 - app.core.storage - INFO - Timestamp updated for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:52,246 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebc0def9c474a23b6: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e210d73...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e537d31...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e7c85b0...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0ea64861...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0ecf3786...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:21:53,108 - app.core.storage - INFO - Stored message 680ebc10af7358abd517 for user 680ebc07dca58027f77c
2025-04-28 00:21:53,110 - app.core.chat_service - INFO - Stored user message (ID: 680ebc10af7358abd517) for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:53,309 - app.core.storage - INFO - Timestamp updated for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:53,309 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 00:21:53,312 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 00:21:54,306 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 00:21:54,308 - app.core.chat_service - INFO - Retrieved 5 documents for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:54,309 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 00:21:54,310 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 00:21:54,310 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation ad134d9a44a6488f84d5da068e5c2250...
2025-04-28 00:21:54,311 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 00:21:54,470 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-28 00:21:54,471 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.99 seconds (calculated)...
2025-04-28 00:21:56,708 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 00:21:56,708 - app.core.chat_service - INFO - Mistral response successful for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:56,895 - app.core.storage - INFO - Stored message 680ebc1498444fd185c3 for user ai
2025-04-28 00:21:57,771 - app.core.storage - INFO - Stored 5 sources for message 680ebc1498444fd185c3
2025-04-28 00:21:57,772 - app.core.chat_service - INFO - Stored AI message (ID: 680ebc1498444fd185c3) for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:57,947 - app.core.storage - INFO - Timestamp updated for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:21:59,549 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebc0def9c474a23b6: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e210d73...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e537d31...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e7c85b0...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0ea64861...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0ecf3786...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:21:59,550 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebc1498444fd185c3: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc14c061f6...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc14e58a06...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc1519515a...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc15414d32...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc15692342..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:22:00,430 - app.core.storage - INFO - Stored message 680ebc184879d34447ff for user 680ebc07dca58027f77c
2025-04-28 00:22:00,431 - app.core.chat_service - INFO - Stored user message (ID: 680ebc184879d34447ff) for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:22:00,629 - app.core.storage - INFO - Timestamp updated for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:22:00,630 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 00:22:00,633 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 00:22:01,586 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 00:22:01,588 - app.core.chat_service - INFO - Retrieved 5 documents for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:22:01,589 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 00:22:01,590 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 00:22:01,590 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation ad134d9a44a6488f84d5da068e5c2250...
2025-04-28 00:22:01,591 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 00:22:02,566 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 00:22:02,567 - app.core.chat_service - INFO - Mistral response successful for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:22:02,756 - app.core.storage - INFO - Stored message 680ebc1a65505aaa14f2 for user ai
2025-04-28 00:22:03,667 - app.core.storage - INFO - Stored 5 sources for message 680ebc1a65505aaa14f2
2025-04-28 00:22:03,668 - app.core.chat_service - INFO - Stored AI message (ID: 680ebc1a65505aaa14f2) for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:22:03,847 - app.core.storage - INFO - Timestamp updated for conversation ad134d9a44a6488f84d5da068e5c2250
2025-04-28 00:22:04,854 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebc0def9c474a23b6: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e210d73...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e537d31...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0e7c85b0...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0ea64861...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc0ecf3786...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:22:04,855 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebc1498444fd185c3: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc14c061f6...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc14e58a06...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc1519515a...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc15414d32...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc15692342..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:22:04,856 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680ebc1a65505aaa14f2: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc1a8f2c2a...5_0_2_0_510', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc1ab725c3...5_0_2_0_205', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc1ade900b...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc1b1135e2...315_0_3_1_5', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680ebc1b38f543...5_0_5_0_124', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 00:34:09,840 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 00:34:10,413 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 00:34:10,455 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-28 00:34:10,456 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-28 00:34:21,620 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 14:51:08,147 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 14:51:08,221 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 14:51:43,807 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 14:51:44,439 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 14:51:44,498 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-28 14:51:44,499 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-28 14:51:56,464 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 15:50:39,341 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 15:50:39,907 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 15:50:39,961 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-28 15:50:39,962 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-28 15:50:39,969 - app.core.storage - INFO - Attempting to create conversation a8b68ff947b64f549c4327cce37eed2a for user mock_conftest_user_id
2025-04-28 15:50:40,275 - app.core.storage - INFO - Successfully created conversation a8b68ff947b64f549c4327cce37eed2a
2025-04-28 15:50:51,449 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 15:51:08,491 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 15:51:26,031 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 15:51:26,073 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 15:51:34,900 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 15:51:35,575 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 15:51:35,626 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-28 15:51:35,629 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-28 15:51:35,636 - app.core.storage - INFO - Attempting to create conversation 9ae02729b523462698afc93d8c44cd08 for user mock_conftest_user_id
2025-04-28 15:51:35,853 - app.core.storage - INFO - Successfully created conversation 9ae02729b523462698afc93d8c44cd08
2025-04-28 15:51:45,916 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 16:01:08,720 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 16:01:25,217 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 16:01:25,256 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 16:03:00,049 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 16:03:14,413 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 16:03:14,462 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 16:06:01,548 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 16:06:02,093 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 16:06:02,136 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-28 16:06:02,137 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-28 16:06:02,143 - app.core.storage - INFO - Attempting to create conversation 859e9f620e0a4fab8ad36ac225aebb81 for user mock_conftest_user_id
2025-04-28 16:06:02,450 - app.core.storage - INFO - Successfully created conversation 859e9f620e0a4fab8ad36ac225aebb81
2025-04-28 16:06:12,214 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 16:06:14,146 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 16:06:29,062 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 16:06:29,097 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 16:09:12,013 - app.api.endpoints.auth - INFO - User registered successfully: test15352@example.com, ID: 680f9a1767836c76596d
2025-04-28 16:09:12,740 - app.api.endpoints.auth - INFO - Password verified for user: test15352@example.com, User ID: 680f9a1767836c76596d
2025-04-28 16:09:12,914 - app.api.endpoints.auth - INFO - JWT created successfully for user: test15352@example.com
2025-04-28 16:09:15,153 - app.core.storage - INFO - Attempting to create conversation c18369e9509040f88726d9a26e487d4f for user 680f9a1767836c76596d
2025-04-28 16:09:15,358 - app.core.storage - INFO - Successfully created conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:17,409 - app.core.storage - INFO - Stored message 680f9a1d0e877d2d5ea9 for user 680f9a1767836c76596d
2025-04-28 16:09:17,411 - app.core.chat_service - INFO - Stored user message (ID: 680f9a1d0e877d2d5ea9) for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:17,652 - app.core.storage - INFO - Timestamp updated for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:17,658 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-28 16:09:17,659 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 16:09:17,665 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 16:09:19,523 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 16:09:19,525 - app.core.chat_service - INFO - Retrieved 5 documents for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:19,526 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 16:09:19,527 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 16:09:19,527 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation c18369e9509040f88726d9a26e487d4f...
2025-04-28 16:09:19,528 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 16:09:21,105 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 16:09:21,106 - app.core.chat_service - INFO - Mistral response successful for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:21,287 - app.core.storage - INFO - Stored message 680f9a210a9cd9c9ae34 for user ai
2025-04-28 16:09:22,231 - app.core.storage - INFO - Stored 5 sources for message 680f9a210a9cd9c9ae34
2025-04-28 16:09:22,232 - app.core.chat_service - INFO - Stored AI message (ID: 680f9a210a9cd9c9ae34) for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:22,488 - app.core.storage - INFO - Timestamp updated for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:23,571 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680f9a210a9cd9c9ae34: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21368546...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a2163f60e...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a218b4486...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21b46c19...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21dd2162...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 16:10:42,044 - app.core.storage - INFO - Stored message 680f9a2411a80567d7a9 for user 680f9a1767836c76596d
2025-04-28 16:10:42,045 - app.core.chat_service - INFO - Stored user message (ID: 680f9a2411a80567d7a9) for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:24,336 - app.core.storage - INFO - Timestamp updated for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:24,337 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 16:09:24,340 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 16:09:25,376 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 16:09:25,378 - app.core.chat_service - INFO - Retrieved 5 documents for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:25,380 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 16:09:25,382 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 16:09:25,382 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation c18369e9509040f88726d9a26e487d4f...
2025-04-28 16:09:25,383 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 16:09:27,699 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 16:09:27,700 - app.core.chat_service - INFO - Mistral response successful for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:27,882 - app.core.storage - INFO - Stored message 680f9a2778cbdb462769 for user ai
2025-04-28 16:09:28,852 - app.core.storage - INFO - Stored 5 sources for message 680f9a2778cbdb462769
2025-04-28 16:09:28,853 - app.core.chat_service - INFO - Stored AI message (ID: 680f9a2778cbdb462769) for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:29,049 - app.core.storage - INFO - Timestamp updated for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:29,649 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680f9a210a9cd9c9ae34: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21368546...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a2163f60e...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a218b4486...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21b46c19...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21dd2162...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 16:09:29,654 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680f9a2778cbdb462769: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a27a4e9cd...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a27cca413...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a2805a243...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a2837b927...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a285def82..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 16:09:30,556 - app.core.storage - INFO - Stored message 680f9a2a5d74c572e2cc for user 680f9a1767836c76596d
2025-04-28 16:09:30,557 - app.core.chat_service - INFO - Stored user message (ID: 680f9a2a5d74c572e2cc) for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:30,741 - app.core.storage - INFO - Timestamp updated for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:30,742 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 16:09:30,746 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 16:09:31,949 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 16:09:31,951 - app.core.chat_service - INFO - Retrieved 5 documents for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:31,952 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 16:09:31,952 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 16:09:31,953 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation c18369e9509040f88726d9a26e487d4f...
2025-04-28 16:09:31,953 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 16:09:32,134 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-28 16:09:32,135 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.45 seconds (calculated)...
2025-04-28 16:09:36,342 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 16:09:36,343 - app.core.chat_service - INFO - Mistral response successful for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:36,524 - app.core.storage - INFO - Stored message 680f9a303f60f8ac4b5b for user ai
2025-04-28 16:09:37,532 - app.core.storage - INFO - Stored 5 sources for message 680f9a303f60f8ac4b5b
2025-04-28 16:09:37,533 - app.core.chat_service - INFO - Stored AI message (ID: 680f9a303f60f8ac4b5b) for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:37,730 - app.core.storage - INFO - Timestamp updated for conversation c18369e9509040f88726d9a26e487d4f
2025-04-28 16:09:38,772 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680f9a210a9cd9c9ae34: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21368546...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a2163f60e...5_0_2_0_264', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a218b4486...5_0_2_0_263', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21b46c19...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a21dd2162...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 16:09:38,775 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680f9a2778cbdb462769: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a27a4e9cd...5_0_2_0_758', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a27cca413...5_0_3_0_151', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a2805a243...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a2837b927...5_0_2_0_281', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a285def82..._0_2_0_1029', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 16:09:38,776 - app.api.endpoints.chat - ERROR - Pydantic validation failed for Appwrite message doc ID 680f9a303f60f8ac4b5b: 5 validation errors for Message
sources.0
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a306fd24a...5_0_2_0_510', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.1
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a30a26077...5_0_2_0_205', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.2
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a30cd6a7f...5_0_2_0_676', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.3
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a31046b1c...315_0_3_1_5', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
sources.4
  Input should be a valid dictionary [type=dict_type, input_value=Source(id='680f9a312b32e7...5_0_5_0_124', score=0.0), input_type=Source]
    For further information visit https://errors.pydantic.dev/2.10/v/dict_type
2025-04-28 16:10:59,237 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 16:11:14,583 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 16:11:14,647 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 16:12:03,256 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 16:12:04,231 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 16:12:04,297 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-28 16:12:04,301 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-28 16:12:04,309 - app.core.storage - INFO - Attempting to create conversation 6ec530574f8047d2b6b5e04f0453a914 for user mock_conftest_user_id
2025-04-28 16:12:04,596 - app.core.storage - INFO - Successfully created conversation 6ec530574f8047d2b6b5e04f0453a914
2025-04-28 16:12:32,421 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 16:48:04,762 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 19:50:27,767 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 19:50:27,824 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 19:50:28,513 - app.api.endpoints.auth - INFO - User registered successfully: test20494@example.com, ID: 680fcdf41d45556fea83
2025-04-28 19:50:49,691 - app.api.endpoints.auth - INFO - User registered successfully: test18695@example.com, ID: 680fce0932961d9a4437
2025-04-28 19:50:50,500 - app.api.endpoints.auth - INFO - Password verified for user: test18695@example.com, User ID: 680fce0932961d9a4437
2025-04-28 19:50:50,762 - app.api.endpoints.auth - INFO - JWT created successfully for user: test18695@example.com
2025-04-28 19:50:52,642 - app.core.storage - INFO - Attempting to create conversation 485627a6012846efaf404969f7602062 for user 680fce0932961d9a4437
2025-04-28 19:50:52,835 - app.core.storage - INFO - Successfully created conversation 485627a6012846efaf404969f7602062
2025-04-28 19:50:53,777 - app.api.endpoints.chat - ERROR - Error in send_message endpoint for user 680fce0932961d9a4437: generate_rag_response() got an unexpected keyword argument 'user'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 48, in send_message
    result = await generate_rag_response(
                   ~~~~~~~~~~~~~~~~~~~~~^
        db=db,
        ^^^^^^
    ...<2 lines>...
        conversation_id=payload.conversation_id
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: generate_rag_response() got an unexpected keyword argument 'user'
2025-04-28 19:50:56,332 - app.api.endpoints.chat - ERROR - Error in send_message endpoint for user 680fce0932961d9a4437: generate_rag_response() got an unexpected keyword argument 'user'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 48, in send_message
    result = await generate_rag_response(
                   ~~~~~~~~~~~~~~~~~~~~~^
        db=db,
        ^^^^^^
    ...<2 lines>...
        conversation_id=payload.conversation_id
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: generate_rag_response() got an unexpected keyword argument 'user'
2025-04-28 19:50:57,522 - app.api.endpoints.chat - ERROR - Error in send_message endpoint for user 680fce0932961d9a4437: generate_rag_response() got an unexpected keyword argument 'user'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 48, in send_message
    result = await generate_rag_response(
                   ~~~~~~~~~~~~~~~~~~~~~^
        db=db,
        ^^^^^^
    ...<2 lines>...
        conversation_id=payload.conversation_id
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: generate_rag_response() got an unexpected keyword argument 'user'
2025-04-28 19:52:04,257 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 19:52:20,697 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 19:52:20,737 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 19:52:21,657 - app.api.endpoints.auth - INFO - User registered successfully: test20569@example.com, ID: 680fce64d8a98d68c572
2025-04-28 19:52:22,919 - app.api.endpoints.auth - INFO - Password verified for user: test20569@example.com, User ID: 680fce64d8a98d68c572
2025-04-28 19:52:23,085 - app.api.endpoints.auth - INFO - JWT created successfully for user: test20569@example.com
2025-04-28 19:52:24,185 - app.core.storage - INFO - Attempting to create conversation 56fad03dbebe420baf758b046425f5e9 for user 680fce64d8a98d68c572
2025-04-28 19:52:24,364 - app.core.storage - INFO - Successfully created conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:25,718 - app.core.storage - INFO - Stored message 680fce695ca1dceb2c57 for user 680fce64d8a98d68c572
2025-04-28 19:52:25,719 - app.core.chat_service - INFO - Stored user message (ID: 680fce695ca1dceb2c57) for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:25,927 - app.core.storage - INFO - Timestamp updated for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:25,928 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-28 19:52:25,929 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 19:52:25,934 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 19:52:27,769 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 19:52:27,775 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:27,781 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 19:52:27,843 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 19:52:27,860 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 56fad03dbebe420baf758b046425f5e9...
2025-04-28 19:52:27,874 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 19:52:30,052 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 19:52:30,053 - app.core.chat_service - INFO - Mistral response successful for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:30,259 - app.core.storage - INFO - Stored message 680fce6de7bbe59cb03d for user ai
2025-04-28 19:52:34,156 - app.core.storage - INFO - Stored 5 sources for message 680fce6de7bbe59cb03d
2025-04-28 19:52:34,158 - app.core.chat_service - INFO - Stored AI message (ID: 680fce6de7bbe59cb03d) for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:34,428 - app.core.storage - INFO - Timestamp updated for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:36,903 - app.core.storage - INFO - Stored message 680fce7470d9ecc75a6e for user 680fce64d8a98d68c572
2025-04-28 19:52:36,903 - app.core.chat_service - INFO - Stored user message (ID: 680fce7470d9ecc75a6e) for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:37,108 - app.core.storage - INFO - Timestamp updated for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:37,109 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 19:52:37,112 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 19:52:38,035 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 19:52:38,036 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:38,038 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 19:52:38,038 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 19:52:38,039 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 56fad03dbebe420baf758b046425f5e9...
2025-04-28 19:52:38,039 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 19:52:39,382 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 19:52:39,382 - app.core.chat_service - INFO - Mistral response successful for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:39,574 - app.core.storage - INFO - Stored message 680fce774fd49693cab0 for user ai
2025-04-28 19:52:41,104 - app.core.storage - INFO - Stored 5 sources for message 680fce774fd49693cab0
2025-04-28 19:52:41,105 - app.core.chat_service - INFO - Stored AI message (ID: 680fce774fd49693cab0) for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:41,332 - app.core.storage - INFO - Timestamp updated for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:43,175 - app.core.storage - INFO - Stored message 680fce7b06ca4898de18 for user 680fce64d8a98d68c572
2025-04-28 19:52:43,176 - app.core.chat_service - INFO - Stored user message (ID: 680fce7b06ca4898de18) for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:43,389 - app.core.storage - INFO - Timestamp updated for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:43,389 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 19:52:43,393 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 19:52:44,436 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 19:52:44,439 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:44,442 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 19:52:44,444 - app.core.chat_service - INFO - Verification: 'content' key FOUND in final_sources.
2025-04-28 19:52:44,445 - app.core.chat_service - INFO - Attempting LLM call (Mistral first) for conversation 56fad03dbebe420baf758b046425f5e9...
2025-04-28 19:52:44,446 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 19:52:44,647 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-28 19:52:44,649 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.37 seconds (calculated)...
2025-04-28 19:52:46,848 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 19:52:46,853 - app.core.chat_service - INFO - Mistral response successful for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:47,055 - app.core.storage - INFO - Stored message 680fce7e95e2f149d9cc for user ai
2025-04-28 19:52:50,863 - app.core.storage - INFO - Stored 5 sources for message 680fce7e95e2f149d9cc
2025-04-28 19:52:50,863 - app.core.chat_service - INFO - Stored AI message (ID: 680fce7e95e2f149d9cc) for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 19:52:51,436 - app.core.storage - INFO - Timestamp updated for conversation 56fad03dbebe420baf758b046425f5e9
2025-04-28 20:02:22,483 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-28 20:01:23,237 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-28 20:01:23,293 - app.main - INFO - Application startup: initializing services and connections
2025-04-28 20:13:04,806 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_8e4e056a717b4631993f9cf160c80b29
2025-04-28 20:13:04,811 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-28 20:13:04,811 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 20:13:04,822 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 20:13:07,312 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 20:13:07,314 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_8e4e056a717b4631993f9cf160c80b29
2025-04-28 20:13:07,316 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 20:13:07,318 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-28 20:13:07,320 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 20:13:08,257 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 20:13:08,258 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_8e4e056a717b4631993f9cf160c80b29
2025-04-28 20:13:29,906 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_d0b822b836924dca9f1c6f6d3dee9cb0
2025-04-28 20:13:29,907 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 20:13:29,919 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 20:13:31,121 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 20:13:31,126 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_d0b822b836924dca9f1c6f6d3dee9cb0
2025-04-28 20:13:31,130 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 20:13:31,132 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-28 20:13:31,133 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 20:13:31,638 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 20:13:31,639 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_d0b822b836924dca9f1c6f6d3dee9cb0
2025-04-28 20:14:39,445 - app.api.endpoints.auth - INFO - User registered successfully: test28125@example.com, ID: 680fd39ef2c60def69b4
2025-04-28 20:14:40,239 - app.api.endpoints.auth - INFO - Password verified for user: test28125@example.com, User ID: 680fd39ef2c60def69b4
2025-04-28 20:14:40,411 - app.api.endpoints.auth - INFO - JWT created successfully for user: test28125@example.com
2025-04-28 20:14:42,209 - app.core.storage - INFO - Attempting to create conversation 3f530e55ddbd41a39254b3a81af734ca for user 680fd39ef2c60def69b4
2025-04-28 20:14:42,154 - app.core.storage - INFO - Successfully created conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:44,001 - app.core.storage - INFO - Stored message 680fd3a3ac6aababd296 for user 680fd39ef2c60def69b4
2025-04-28 20:14:44,002 - app.core.chat_service - INFO - Stored user message (ID: 680fd3a3ac6aababd296) for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:44,213 - app.core.storage - INFO - Timestamp updated for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:44,214 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 20:14:44,219 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 20:14:45,506 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 20:14:45,509 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:45,511 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 20:14:45,513 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-28 20:14:45,516 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 20:14:45,701 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-28 20:14:45,703 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.19 seconds (calculated)...
2025-04-28 20:14:48,300 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 20:14:48,300 - app.core.chat_service - INFO - Mistral response successful for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:48,487 - app.core.storage - INFO - Stored message 680fd3a846c605067c73 for user ai
2025-04-28 20:14:49,735 - app.core.storage - INFO - Stored 5 sources for message 680fd3a846c605067c73
2025-04-28 20:14:49,752 - app.core.chat_service - INFO - Stored AI message (ID: 680fd3a846c605067c73) for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:50,047 - app.core.storage - INFO - Timestamp updated for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:52,025 - app.core.storage - INFO - Stored message 680fd3ab7d38b72f3f79 for user 680fd39ef2c60def69b4
2025-04-28 20:14:52,026 - app.core.chat_service - INFO - Stored user message (ID: 680fd3ab7d38b72f3f79) for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:52,017 - app.core.storage - INFO - Timestamp updated for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:52,026 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 20:14:52,081 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 20:14:53,312 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 20:14:53,316 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:53,318 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 20:14:53,320 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-28 20:14:53,321 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 20:14:54,184 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 20:14:54,185 - app.core.chat_service - INFO - Mistral response successful for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:54,480 - app.core.storage - INFO - Stored message 680fd3ae2d662e1f52ba for user ai
2025-04-28 20:14:56,245 - app.core.storage - INFO - Stored 5 sources for message 680fd3ae2d662e1f52ba
2025-04-28 20:14:56,247 - app.core.chat_service - INFO - Stored AI message (ID: 680fd3ae2d662e1f52ba) for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:56,470 - app.core.storage - INFO - Timestamp updated for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:58,247 - app.core.storage - INFO - Stored message 680fd3b211d3a47ed0ea for user 680fd39ef2c60def69b4
2025-04-28 20:14:58,248 - app.core.chat_service - INFO - Stored user message (ID: 680fd3b211d3a47ed0ea) for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:58,459 - app.core.storage - INFO - Timestamp updated for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:58,465 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 20:14:58,477 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 20:14:59,644 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 20:14:59,649 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:14:59,650 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 20:14:59,651 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-28 20:14:59,652 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 20:15:00,473 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 20:15:00,473 - app.core.chat_service - INFO - Mistral response successful for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:15:00,680 - app.core.storage - INFO - Stored message 680fd3b444bd9faa2578 for user ai
2025-04-28 20:15:01,749 - app.core.storage - INFO - Stored 5 sources for message 680fd3b444bd9faa2578
2025-04-28 20:15:01,749 - app.core.chat_service - INFO - Stored AI message (ID: 680fd3b444bd9faa2578) for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 20:15:01,941 - app.core.storage - INFO - Timestamp updated for conversation 3f530e55ddbd41a39254b3a81af734ca
2025-04-28 21:50:31,499 - app.api.endpoints.auth - INFO - User registered successfully: test7253@example.com, ID: 680fe9c962437b5b160c
2025-04-28 21:50:32,723 - app.api.endpoints.auth - INFO - Password verified for user: test7253@example.com, User ID: 680fe9c962437b5b160c
2025-04-28 21:50:32,882 - app.api.endpoints.auth - INFO - JWT created successfully for user: test7253@example.com
2025-04-28 21:50:34,622 - app.core.storage - INFO - Attempting to create conversation 50336c7beeda4c85bc18e1198899f2ef for user 680fe9c962437b5b160c
2025-04-28 21:50:34,837 - app.core.storage - INFO - Successfully created conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:50:36,167 - app.core.storage - INFO - Stored message 680fe9ce58850127f55c for user 680fe9c962437b5b160c
2025-04-28 21:50:36,167 - app.core.chat_service - INFO - Stored user message (ID: 680fe9ce58850127f55c) for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:50:36,339 - app.core.storage - INFO - Timestamp updated for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:50:36,341 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 21:50:36,376 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 21:50:39,005 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 21:50:39,006 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:50:39,008 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 21:50:39,009 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-28 21:50:39,009 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 21:50:40,852 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 21:50:40,853 - app.core.chat_service - INFO - Mistral response successful for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:50:41,053 - app.core.storage - INFO - Stored message 680fe9d33af6ab91fbf5 for user ai
2025-04-28 21:50:41,925 - app.core.storage - INFO - Stored 5 sources for message 680fe9d33af6ab91fbf5
2025-04-28 21:50:41,926 - app.core.chat_service - INFO - Stored AI message (ID: 680fe9d33af6ab91fbf5) for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:50:42,108 - app.core.storage - INFO - Timestamp updated for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:26,006 - app.core.storage - INFO - Stored message 680fe9d5e9aeb437442c for user 680fe9c962437b5b160c
2025-04-28 21:49:26,006 - app.core.chat_service - INFO - Stored user message (ID: 680fe9d5e9aeb437442c) for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:26,203 - app.core.storage - INFO - Timestamp updated for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:26,203 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 21:49:26,206 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 21:49:27,224 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 21:49:27,226 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:27,227 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 21:49:27,228 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-28 21:49:27,228 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 21:49:27,943 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 21:49:27,945 - app.core.chat_service - INFO - Mistral response successful for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:28,118 - app.core.storage - INFO - Stored message 680fe9d81448aa2c7bd1 for user ai
2025-04-28 21:49:28,949 - app.core.storage - INFO - Stored 5 sources for message 680fe9d81448aa2c7bd1
2025-04-28 21:49:28,949 - app.core.chat_service - INFO - Stored AI message (ID: 680fe9d81448aa2c7bd1) for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:29,121 - app.core.storage - INFO - Timestamp updated for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:30,866 - app.core.storage - INFO - Stored message 680fe9dac951a4c49e19 for user 680fe9c962437b5b160c
2025-04-28 21:49:30,866 - app.core.chat_service - INFO - Stored user message (ID: 680fe9dac951a4c49e19) for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:31,040 - app.core.storage - INFO - Timestamp updated for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:31,040 - app.core.clients - INFO - Initializing Pinecone client
2025-04-28 21:49:31,044 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-28 21:49:32,083 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-28 21:49:32,085 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:32,086 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-28 21:49:32,087 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-28 21:49:32,087 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-28 21:49:32,851 - app.core.llm_service - INFO - Mistral API call successful
2025-04-28 21:49:32,852 - app.core.chat_service - INFO - Mistral response successful for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:33,034 - app.core.storage - INFO - Stored message 680fe9dcf2d8edf98cd9 for user ai
2025-04-28 21:49:33,952 - app.core.storage - INFO - Stored 5 sources for message 680fe9dcf2d8edf98cd9
2025-04-28 21:49:33,952 - app.core.chat_service - INFO - Stored AI message (ID: 680fe9dcf2d8edf98cd9) for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-28 21:49:34,142 - app.core.storage - INFO - Timestamp updated for conversation 50336c7beeda4c85bc18e1198899f2ef
2025-04-29 01:40:31,144 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 01:40:31,251 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 01:40:49,650 - app.api.endpoints.auth - INFO - User registered successfully: test8070@example.com, ID: 681020116b6b40114f68
2025-04-29 01:40:50,463 - app.api.endpoints.auth - INFO - Password verified for user: test8070@example.com, User ID: 681020116b6b40114f68
2025-04-29 01:40:50,657 - app.api.endpoints.auth - INFO - JWT created successfully for user: test8070@example.com
2025-04-29 01:40:52,616 - app.core.storage - INFO - Attempting to create conversation f5ca0f23ad1d4496a80c74728286d74c for user 681020116b6b40114f68
2025-04-29 01:40:52,899 - app.core.storage - INFO - Successfully created conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:40:54,577 - app.core.storage - INFO - Stored message 681020167e2670567c8f for user 681020116b6b40114f68
2025-04-29 01:40:54,578 - app.core.chat_service - INFO - Stored user message (ID: 681020167e2670567c8f) for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:40:54,833 - app.core.storage - INFO - Timestamp updated for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:40:54,835 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-29 01:40:54,836 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 01:40:54,851 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 01:40:57,248 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 01:40:57,249 - app.core.chat_service - INFO - Retrieved 5 documents for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:40:57,250 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 01:40:57,251 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 01:40:57,251 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 01:40:59,191 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 01:40:59,192 - app.core.chat_service - INFO - Mistral response successful for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:40:59,508 - app.core.storage - INFO - Stored message 6810201b668b2c0098d0 for user ai
2025-04-29 01:41:01,389 - app.core.storage - INFO - Stored 5 sources for message 6810201b668b2c0098d0
2025-04-29 01:41:01,389 - app.core.chat_service - INFO - Stored AI message (ID: 6810201b668b2c0098d0) for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:01,685 - app.core.storage - INFO - Timestamp updated for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:03,890 - app.core.storage - INFO - Stored message 6810201fccf4b03681c5 for user 681020116b6b40114f68
2025-04-29 01:41:03,896 - app.core.chat_service - INFO - Stored user message (ID: 6810201fccf4b03681c5) for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:04,117 - app.core.storage - INFO - Timestamp updated for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:04,122 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 01:41:04,130 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 01:41:05,201 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 01:41:05,203 - app.core.chat_service - INFO - Retrieved 5 documents for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:05,205 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 01:41:05,206 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 01:41:05,207 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 01:41:07,378 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 01:41:07,379 - app.core.chat_service - INFO - Mistral response successful for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:07,595 - app.core.storage - INFO - Stored message 68102023842c0905b91f for user ai
2025-04-29 01:41:08,721 - app.core.storage - INFO - Stored 5 sources for message 68102023842c0905b91f
2025-04-29 01:41:08,721 - app.core.chat_service - INFO - Stored AI message (ID: 68102023842c0905b91f) for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:08,979 - app.core.storage - INFO - Timestamp updated for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:11,113 - app.core.storage - INFO - Stored message 681020270e43792f8ba5 for user 681020116b6b40114f68
2025-04-29 01:41:11,114 - app.core.chat_service - INFO - Stored user message (ID: 681020270e43792f8ba5) for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:11,376 - app.core.storage - INFO - Timestamp updated for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:11,384 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 01:41:11,400 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 01:41:12,651 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 01:41:12,653 - app.core.chat_service - INFO - Retrieved 5 documents for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:12,654 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 01:41:12,654 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 01:41:12,655 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 01:41:13,380 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 01:41:13,381 - app.core.chat_service - INFO - Mistral response successful for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:13,614 - app.core.storage - INFO - Stored message 6810202989c764bda4af for user ai
2025-04-29 01:41:14,838 - app.core.storage - INFO - Stored 5 sources for message 6810202989c764bda4af
2025-04-29 01:41:14,840 - app.core.chat_service - INFO - Stored AI message (ID: 6810202989c764bda4af) for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:41:15,085 - app.core.storage - INFO - Timestamp updated for conversation f5ca0f23ad1d4496a80c74728286d74c
2025-04-29 01:42:52,050 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 01:42:52,507 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 01:42:52,545 - app.api.endpoints.auth - INFO - Password verified for user: conftest_test@example.com, User ID: mock_conftest_user_id
2025-04-29 01:42:52,546 - app.api.endpoints.auth - INFO - JWT created successfully for user: conftest_test@example.com
2025-04-29 01:42:52,557 - app.core.storage - INFO - Attempting to create conversation 7f692400277d49fc92b099eb59156c81 for user mock_conftest_user_id
2025-04-29 01:42:52,777 - app.core.storage - INFO - Successfully created conversation 7f692400277d49fc92b099eb59156c81
2025-04-29 01:43:02,765 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-29 01:44:03,938 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_5a9b4270aced479e9ca7e9646a8fbaf4
2025-04-29 01:44:03,939 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 01:44:03,943 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 01:44:06,501 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 01:44:06,506 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_5a9b4270aced479e9ca7e9646a8fbaf4
2025-04-29 01:44:06,507 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 01:44:06,508 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 01:44:06,508 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 01:44:06,766 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 01:44:06,767 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.79 seconds (calculated)...
2025-04-29 01:44:09,104 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 01:44:09,105 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_5a9b4270aced479e9ca7e9646a8fbaf4
2025-04-29 02:50:02,608 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 02:50:02,669 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 03:16:28,002 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-29 03:17:46,479 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 03:17:46,539 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 03:20:21,614 - app.api.endpoints.auth - INFO - User registered successfully: test15279@example.com, ID: 681037655a99cd59aaff
2025-04-29 03:20:22,513 - app.api.endpoints.auth - INFO - Password verified for user: test15279@example.com, User ID: 681037655a99cd59aaff
2025-04-29 03:20:22,767 - app.api.endpoints.auth - INFO - JWT created successfully for user: test15279@example.com
2025-04-29 03:20:24,421 - app.core.storage - INFO - Attempting to create conversation adf6461ddec44c7cae3d7c82262ec779 for user 681037655a99cd59aaff
2025-04-29 03:20:24,628 - app.core.storage - INFO - Successfully created conversation adf6461ddec44c7cae3d7c82262ec779
2025-04-29 03:20:26,227 - app.api.endpoints.chat - ERROR - Error processing message in conversation adf6461ddec44c7cae3d7c82262ec779: generate_rag_response() got an unexpected keyword argument 'query'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 47, in send_message
    rag_response_data = await generate_rag_response(
                              ~~~~~~~~~~~~~~~~~~~~~^
        db=db,
        ^^^^^^
    ...<3 lines>...
        is_anonymous=is_anonymous
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: generate_rag_response() got an unexpected keyword argument 'query'
2025-04-29 03:20:27,789 - app.api.endpoints.chat - ERROR - Error processing message in conversation adf6461ddec44c7cae3d7c82262ec779: generate_rag_response() got an unexpected keyword argument 'query'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 47, in send_message
    rag_response_data = await generate_rag_response(
                              ~~~~~~~~~~~~~~~~~~~~~^
        db=db,
        ^^^^^^
    ...<3 lines>...
        is_anonymous=is_anonymous
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: generate_rag_response() got an unexpected keyword argument 'query'
2025-04-29 03:20:29,451 - app.api.endpoints.chat - ERROR - Error processing message in conversation adf6461ddec44c7cae3d7c82262ec779: generate_rag_response() got an unexpected keyword argument 'query'
Traceback (most recent call last):
  File "/mnt/c/Users/walid/vs code testing/arabia/project_root/app/api/endpoints/chat.py", line 47, in send_message
    rag_response_data = await generate_rag_response(
                              ~~~~~~~~~~~~~~~~~~~~~^
        db=db,
        ^^^^^^
    ...<3 lines>...
        is_anonymous=is_anonymous
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: generate_rag_response() got an unexpected keyword argument 'query'
2025-04-29 03:22:09,928 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-29 03:43:16,938 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 03:43:17,008 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 03:43:28,932 - app.api.endpoints.auth - INFO - User registered successfully: test31473@example.com, ID: 68103cd0a56d671d7313
2025-04-29 03:43:30,013 - app.api.endpoints.auth - INFO - Password verified for user: test31473@example.com, User ID: 68103cd0a56d671d7313
2025-04-29 03:43:30,214 - app.api.endpoints.auth - INFO - JWT created successfully for user: test31473@example.com
2025-04-29 03:43:31,960 - app.core.storage - INFO - Attempting to create conversation 37cacd54202047ef89ab8e823461e4ba for user 68103cd0a56d671d7313
2025-04-29 03:43:32,193 - app.core.storage - INFO - Successfully created conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:33,699 - app.core.storage - INFO - Stored message 68103cd59df535d16c5b for user 68103cd0a56d671d7313
2025-04-29 03:43:33,700 - app.core.chat_service - INFO - Stored user message (ID: 68103cd59df535d16c5b) for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:33,967 - app.core.storage - INFO - Timestamp updated for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:33,968 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-29 03:43:33,969 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:43:33,973 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:43:36,560 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:43:36,563 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:36,564 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:43:36,565 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:43:36,566 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:43:39,138 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:43:39,147 - app.core.chat_service - INFO - Mistral response successful for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:39,365 - app.core.storage - INFO - Stored message 68103cdb4c5b3caf01cf for user ai
2025-04-29 03:43:40,536 - app.core.storage - INFO - Stored 5 sources for message 68103cdb4c5b3caf01cf
2025-04-29 03:43:40,537 - app.core.chat_service - INFO - Stored AI message (ID: 68103cdb4c5b3caf01cf) for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:40,811 - app.core.storage - INFO - Timestamp updated for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:49,360 - app.core.storage - INFO - Stored message 68103ce54b05d974780f for user 68103cd0a56d671d7313
2025-04-29 03:43:49,360 - app.core.chat_service - INFO - Stored user message (ID: 68103ce54b05d974780f) for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:49,585 - app.core.storage - INFO - Timestamp updated for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:49,586 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:43:49,590 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:43:50,625 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:43:50,627 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:50,628 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:43:50,629 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:43:50,629 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:43:52,060 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:43:52,066 - app.core.chat_service - INFO - Mistral response successful for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:52,275 - app.core.storage - INFO - Stored message 68103ce836409516ae86 for user ai
2025-04-29 03:43:53,424 - app.core.storage - INFO - Stored 5 sources for message 68103ce836409516ae86
2025-04-29 03:43:53,424 - app.core.chat_service - INFO - Stored AI message (ID: 68103ce836409516ae86) for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:53,627 - app.core.storage - INFO - Timestamp updated for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:55,483 - app.core.storage - INFO - Stored message 68103ceb6938bc6e901f for user 68103cd0a56d671d7313
2025-04-29 03:43:55,484 - app.core.chat_service - INFO - Stored user message (ID: 68103ceb6938bc6e901f) for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:55,698 - app.core.storage - INFO - Timestamp updated for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:55,699 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:43:55,703 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:45:14,427 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:45:14,429 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:45:14,430 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:45:14,431 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:45:14,431 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:43:57,693 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:43:57,694 - app.core.chat_service - INFO - Mistral response successful for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:57,940 - app.core.storage - INFO - Stored message 68103ceddae4c82a7465 for user ai
2025-04-29 03:43:59,110 - app.core.storage - INFO - Stored 5 sources for message 68103ceddae4c82a7465
2025-04-29 03:43:59,112 - app.core.chat_service - INFO - Stored AI message (ID: 68103ceddae4c82a7465) for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:43:59,338 - app.core.storage - INFO - Timestamp updated for conversation 37cacd54202047ef89ab8e823461e4ba
2025-04-29 03:45:46,563 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_33fe88b1f4af4390a65a71b5275b9fd5
2025-04-29 03:45:46,564 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:45:46,567 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:45:47,901 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:45:47,903 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_33fe88b1f4af4390a65a71b5275b9fd5
2025-04-29 03:45:47,905 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:45:47,905 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:45:47,906 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:45:48,420 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:45:48,423 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_33fe88b1f4af4390a65a71b5275b9fd5
2025-04-29 03:46:35,240 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_b67329edb03d44f7916f1148e6989d05
2025-04-29 03:46:35,242 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:46:35,247 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:46:36,330 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:46:36,332 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_b67329edb03d44f7916f1148e6989d05
2025-04-29 03:46:36,333 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:46:36,334 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:46:36,335 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:46:36,599 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 03:46:36,601 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.56 seconds (calculated)...
2025-04-29 03:46:38,410 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:46:38,410 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_b67329edb03d44f7916f1148e6989d05
2025-04-29 03:46:38,743 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_62146889155e47f08fd50f11ca2c9aa3
2025-04-29 03:46:38,743 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:46:38,747 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:46:39,835 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:46:39,837 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_62146889155e47f08fd50f11ca2c9aa3
2025-04-29 03:46:39,838 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:46:39,839 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:46:39,840 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:46:40,472 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:46:40,483 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_62146889155e47f08fd50f11ca2c9aa3
2025-04-29 03:46:40,898 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_fcc5a88c1e1b4b58a6380d7f4bc53315
2025-04-29 03:46:40,899 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:46:40,919 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:46:42,197 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:46:42,201 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_fcc5a88c1e1b4b58a6380d7f4bc53315
2025-04-29 03:46:42,220 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:46:42,226 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:46:42,231 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:46:42,800 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:46:42,826 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_fcc5a88c1e1b4b58a6380d7f4bc53315
2025-04-29 03:47:50,121 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_60f4eecb54774e9c9f56bbf9f6e71fc6
2025-04-29 03:47:50,121 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:47:50,125 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:47:51,186 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:47:51,188 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_60f4eecb54774e9c9f56bbf9f6e71fc6
2025-04-29 03:47:51,189 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:47:51,190 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:47:51,191 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:47:51,693 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:47:51,694 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_60f4eecb54774e9c9f56bbf9f6e71fc6
2025-04-29 03:47:52,013 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_9d1a32df380046cc94058470888185eb
2025-04-29 03:47:52,015 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:47:52,026 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:47:52,137 - app.core.embeddings - ERROR - Error generating embedding: API error occurred: Status 429
{"message":"Requests rate limit exceeded"}
2025-04-29 03:47:52,138 - app.core.retrieval.pinecone - ERROR - Failed to generate query embedding for retrieval.
2025-04-29 03:47:52,139 - app.core.chat_service - WARNING - No documents retrieved for query in conversation anon_conv_9d1a32df380046cc94058470888185eb
2025-04-29 03:47:52,139 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-29 03:47:52,140 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 0
2025-04-29 03:47:52,140 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:47:52,141 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:47:52,389 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 03:47:52,389 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.66 seconds (calculated)...
2025-04-29 03:47:54,644 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:47:54,646 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_9d1a32df380046cc94058470888185eb
2025-04-29 03:47:54,978 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_0c5f212427644cb7a64d317a4ce5986c
2025-04-29 03:47:54,979 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:47:54,982 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:47:55,865 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:47:55,867 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_0c5f212427644cb7a64d317a4ce5986c
2025-04-29 03:47:55,868 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:47:55,871 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:47:55,872 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:47:56,554 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:47:56,555 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_0c5f212427644cb7a64d317a4ce5986c
2025-04-29 03:51:01,553 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-29 03:57:01,184 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 03:57:01,237 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 03:58:27,180 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_6de439e92eb946f9a089d36a0e4b1cfc
2025-04-29 03:58:27,181 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-29 03:58:27,184 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:58:27,191 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:57:12,606 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:57:12,610 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_6de439e92eb946f9a089d36a0e4b1cfc
2025-04-29 03:57:12,618 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:57:12,620 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:57:12,623 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:57:12,846 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 03:57:12,847 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.31 seconds (calculated)...
2025-04-29 03:58:32,182 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:58:32,182 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_6de439e92eb946f9a089d36a0e4b1cfc
2025-04-29 03:57:23,732 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_e7cf0d13c4414e20beffe196ec568037
2025-04-29 03:57:23,732 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:57:23,736 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:57:25,435 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:57:25,437 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_e7cf0d13c4414e20beffe196ec568037
2025-04-29 03:57:25,438 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:57:25,439 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:57:25,440 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:57:26,439 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:57:26,440 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_e7cf0d13c4414e20beffe196ec568037
2025-04-29 03:57:49,322 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_cc7b99d5784247ca908d46e0c3b0389b
2025-04-29 03:57:49,323 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:57:49,326 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:57:50,296 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:57:50,298 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_cc7b99d5784247ca908d46e0c3b0389b
2025-04-29 03:57:50,299 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:57:50,299 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:57:50,300 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:57:50,494 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 03:57:50,495 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.51 seconds (calculated)...
2025-04-29 03:57:52,529 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:57:52,529 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_cc7b99d5784247ca908d46e0c3b0389b
2025-04-29 03:57:52,822 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_fa826cf60cb142b7801bab8b730f7898
2025-04-29 03:57:52,822 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:57:52,825 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:57:53,737 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:57:53,739 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_fa826cf60cb142b7801bab8b730f7898
2025-04-29 03:57:53,740 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:57:53,740 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:57:53,741 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:57:54,077 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:57:54,078 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_fa826cf60cb142b7801bab8b730f7898
2025-04-29 03:57:54,351 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_200c1c73290b45b1a89467f8023ae72f
2025-04-29 03:57:54,351 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:57:54,354 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:57:55,181 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:57:55,183 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_200c1c73290b45b1a89467f8023ae72f
2025-04-29 03:57:55,184 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:57:55,185 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:57:55,186 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:57:55,542 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 03:57:55,542 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.25 seconds (calculated)...
2025-04-29 03:57:57,517 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:57:57,518 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_200c1c73290b45b1a89467f8023ae72f
2025-04-29 03:58:39,627 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_8f596e49805e46319fd92605377c6969
2025-04-29 03:58:39,628 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:58:39,632 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:58:40,865 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 03:58:40,867 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_8f596e49805e46319fd92605377c6969
2025-04-29 03:58:40,868 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 03:58:40,869 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:58:40,870 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:58:41,658 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:58:41,659 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_8f596e49805e46319fd92605377c6969
2025-04-29 03:58:41,953 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_b959197cdfb84552b36ed223dbec68c5
2025-04-29 03:58:41,954 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:58:41,956 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:58:42,054 - app.core.embeddings - ERROR - Error generating embedding: API error occurred: Status 429
{"message":"Requests rate limit exceeded"}
2025-04-29 03:58:42,054 - app.core.retrieval.pinecone - ERROR - Failed to generate query embedding for retrieval.
2025-04-29 03:58:42,055 - app.core.chat_service - WARNING - No documents retrieved for query in conversation anon_conv_b959197cdfb84552b36ed223dbec68c5
2025-04-29 03:58:42,055 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-29 03:58:42,056 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 0
2025-04-29 03:58:42,056 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:58:42,056 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:58:42,519 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:58:42,520 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_b959197cdfb84552b36ed223dbec68c5
2025-04-29 03:58:42,795 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_af80aa9099c34e40ad0a932b0d208e6f
2025-04-29 03:58:42,796 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 03:58:42,801 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 03:58:42,901 - app.core.embeddings - ERROR - Error generating embedding: API error occurred: Status 429
{"message":"Requests rate limit exceeded"}
2025-04-29 03:58:42,902 - app.core.retrieval.pinecone - ERROR - Failed to generate query embedding for retrieval.
2025-04-29 03:58:42,903 - app.core.chat_service - WARNING - No documents retrieved for query in conversation anon_conv_af80aa9099c34e40ad0a932b0d208e6f
2025-04-29 03:58:42,903 - app.core.context_formatter - WARNING - No documents provided for context formatting.
2025-04-29 03:58:42,904 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 0
2025-04-29 03:58:42,904 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 03:58:42,904 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 03:58:43,162 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 03:58:43,162 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.47 seconds (calculated)...
2025-04-29 03:58:45,352 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 03:58:45,352 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_af80aa9099c34e40ad0a932b0d208e6f
2025-04-29 04:11:52,973 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_7d69a5a1713e42ae8b6702563562c922
2025-04-29 04:11:52,988 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:13:10,719 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:13:22,624 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:13:22,626 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_7d69a5a1713e42ae8b6702563562c922
2025-04-29 04:13:22,628 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:13:22,629 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:13:22,630 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:13:23,936 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:13:23,937 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_7d69a5a1713e42ae8b6702563562c922
2025-04-29 04:13:24,240 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_16fd628ad9ea40719e2d39eb3fb7fffb
2025-04-29 04:13:24,241 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:13:24,243 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:13:26,967 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:13:26,969 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_16fd628ad9ea40719e2d39eb3fb7fffb
2025-04-29 04:13:26,970 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:13:26,970 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:13:26,971 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:13:27,983 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:13:27,984 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_16fd628ad9ea40719e2d39eb3fb7fffb
2025-04-29 04:13:28,278 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_acabdd6356a1494daa4d9878ee4d48ae
2025-04-29 04:13:28,278 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:13:28,281 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:12:15,220 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:12:15,224 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_acabdd6356a1494daa4d9878ee4d48ae
2025-04-29 04:12:15,227 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:12:15,233 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:12:15,234 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:12:17,012 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:12:17,012 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_acabdd6356a1494daa4d9878ee4d48ae
2025-04-29 04:12:32,409 - app.api.endpoints.auth - INFO - User registered successfully: test3774@example.com, ID: 681043a01ede0838d84d
2025-04-29 04:12:33,692 - app.api.endpoints.auth - INFO - Password verified for user: test3774@example.com, User ID: 681043a01ede0838d84d
2025-04-29 04:12:34,992 - app.api.endpoints.auth - INFO - JWT created successfully for user: test3774@example.com
2025-04-29 04:12:36,715 - app.core.storage - INFO - Attempting to create conversation b400672c45ec44eebdba5e527700d1e9 for user 681043a01ede0838d84d
2025-04-29 04:12:37,747 - app.core.storage - INFO - Successfully created conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:41,901 - app.core.storage - INFO - Stored message 681043a9c62213891330 for user 681043a01ede0838d84d
2025-04-29 04:12:41,902 - app.core.chat_service - INFO - Stored user message (ID: 681043a9c62213891330) for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:42,425 - app.core.storage - INFO - Timestamp updated for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:42,429 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:12:42,434 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:12:45,104 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:12:45,106 - app.core.chat_service - INFO - Retrieved 5 documents for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:45,107 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:12:45,108 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:12:45,109 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:12:47,141 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:12:47,141 - app.core.chat_service - INFO - Mistral response successful for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:47,531 - app.core.storage - INFO - Stored message 681043af67d46a52ac54 for user ai
2025-04-29 04:12:49,718 - app.core.storage - INFO - Stored 5 sources for message 681043af67d46a52ac54
2025-04-29 04:12:49,718 - app.core.chat_service - INFO - Stored AI message (ID: 681043af67d46a52ac54) for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:50,337 - app.core.storage - INFO - Timestamp updated for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:53,596 - app.core.storage - INFO - Stored message 681043b585c5c39cc52c for user 681043a01ede0838d84d
2025-04-29 04:12:53,597 - app.core.chat_service - INFO - Stored user message (ID: 681043b585c5c39cc52c) for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:54,023 - app.core.storage - INFO - Timestamp updated for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:54,023 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:12:54,026 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:12:56,412 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:12:56,419 - app.core.chat_service - INFO - Retrieved 5 documents for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:56,423 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:12:56,425 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:12:56,427 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:12:57,446 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:12:57,447 - app.core.chat_service - INFO - Mistral response successful for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:12:57,806 - app.core.storage - INFO - Stored message 681043b9afcd0bed6326 for user ai
2025-04-29 04:14:24,969 - app.core.storage - INFO - Stored 5 sources for message 681043b9afcd0bed6326
2025-04-29 04:14:24,969 - app.core.chat_service - INFO - Stored AI message (ID: 681043b9afcd0bed6326) for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:14:25,545 - app.core.storage - INFO - Timestamp updated for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:14:39,899 - app.core.storage - INFO - Stored message 681043d2433e31bcabda for user 681043a01ede0838d84d
2025-04-29 04:14:39,900 - app.core.chat_service - INFO - Stored user message (ID: 681043d2433e31bcabda) for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:14:40,095 - app.core.storage - INFO - Timestamp updated for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:14:40,096 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:14:40,100 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:14:41,239 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:14:41,241 - app.core.chat_service - INFO - Retrieved 5 documents for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:14:41,241 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:14:41,242 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:14:41,243 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:14:42,018 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:14:42,019 - app.core.chat_service - INFO - Mistral response successful for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:14:42,242 - app.core.storage - INFO - Stored message 681043d493f9d1c68009 for user ai
2025-04-29 04:14:43,361 - app.core.storage - INFO - Stored 5 sources for message 681043d493f9d1c68009
2025-04-29 04:14:43,362 - app.core.chat_service - INFO - Stored AI message (ID: 681043d493f9d1c68009) for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:14:43,603 - app.core.storage - INFO - Timestamp updated for conversation b400672c45ec44eebdba5e527700d1e9
2025-04-29 04:15:34,171 - app.api.endpoints.auth - INFO - User registered successfully: test7888@example.com, ID: 68104455e3f13b898f75
2025-04-29 04:15:34,954 - app.api.endpoints.auth - INFO - Password verified for user: test7888@example.com, User ID: 68104455e3f13b898f75
2025-04-29 04:15:35,176 - app.api.endpoints.auth - INFO - JWT created successfully for user: test7888@example.com
2025-04-29 04:15:36,401 - app.core.storage - INFO - Attempting to create conversation e4213bc2fd764c0b958127eb3afb2f79 for user 68104455e3f13b898f75
2025-04-29 04:15:36,657 - app.core.storage - INFO - Successfully created conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:38,631 - app.core.storage - INFO - Stored message 6810445a2bf2a1f68567 for user 68104455e3f13b898f75
2025-04-29 04:15:38,633 - app.core.chat_service - INFO - Stored user message (ID: 6810445a2bf2a1f68567) for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:38,873 - app.core.storage - INFO - Timestamp updated for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:38,873 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:15:38,876 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:15:39,602 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:15:39,604 - app.core.chat_service - INFO - Retrieved 5 documents for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:39,605 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:15:39,606 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:15:39,606 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:15:41,611 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:15:41,612 - app.core.chat_service - INFO - Mistral response successful for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:41,853 - app.core.storage - INFO - Stored message 6810445d83df1c63d65c for user ai
2025-04-29 04:15:43,415 - app.core.storage - INFO - Stored 5 sources for message 6810445d83df1c63d65c
2025-04-29 04:15:43,417 - app.core.chat_service - INFO - Stored AI message (ID: 6810445d83df1c63d65c) for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:43,637 - app.core.storage - INFO - Timestamp updated for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:45,138 - app.core.storage - INFO - Stored message 68104460ebfe5de6a96c for user 68104455e3f13b898f75
2025-04-29 04:15:45,139 - app.core.chat_service - INFO - Stored user message (ID: 68104460ebfe5de6a96c) for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:45,373 - app.core.storage - INFO - Timestamp updated for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:45,373 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:15:45,388 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:15:46,473 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:15:46,475 - app.core.chat_service - INFO - Retrieved 5 documents for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:46,476 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:15:46,477 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:15:46,477 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:15:47,814 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:15:47,814 - app.core.chat_service - INFO - Mistral response successful for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:48,034 - app.core.storage - INFO - Stored message 681044639b33957cc5ba for user ai
2025-04-29 04:15:48,891 - app.core.storage - INFO - Stored 5 sources for message 681044639b33957cc5ba
2025-04-29 04:15:48,892 - app.core.chat_service - INFO - Stored AI message (ID: 681044639b33957cc5ba) for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:49,120 - app.core.storage - INFO - Timestamp updated for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:51,072 - app.core.storage - INFO - Stored message 68104466cbc46cf25940 for user 68104455e3f13b898f75
2025-04-29 04:15:51,072 - app.core.chat_service - INFO - Stored user message (ID: 68104466cbc46cf25940) for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:51,295 - app.core.storage - INFO - Timestamp updated for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:51,315 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:15:51,345 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:15:52,420 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:15:52,421 - app.core.chat_service - INFO - Retrieved 5 documents for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:52,422 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:15:52,424 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:15:52,425 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:15:53,234 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:15:53,234 - app.core.chat_service - INFO - Mistral response successful for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:53,459 - app.core.storage - INFO - Stored message 68104469069dbe19fbe7 for user ai
2025-04-29 04:15:54,181 - app.core.storage - INFO - Stored 5 sources for message 68104469069dbe19fbe7
2025-04-29 04:15:54,181 - app.core.chat_service - INFO - Stored AI message (ID: 68104469069dbe19fbe7) for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:15:54,404 - app.core.storage - INFO - Timestamp updated for conversation e4213bc2fd764c0b958127eb3afb2f79
2025-04-29 04:16:14,349 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-29 04:16:40,504 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 04:16:40,592 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 04:18:09,973 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-29 04:18:26,118 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 04:18:26,189 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 04:18:45,641 - app.api.endpoints.auth - INFO - User registered successfully: test2974@example.com, ID: 681045154a1704c875e2
2025-04-29 04:18:46,549 - app.api.endpoints.auth - INFO - Password verified for user: test2974@example.com, User ID: 681045154a1704c875e2
2025-04-29 04:18:46,919 - app.api.endpoints.auth - INFO - JWT created successfully for user: test2974@example.com
2025-04-29 04:18:48,255 - app.core.storage - INFO - Attempting to create conversation 90fa621ffcd84a29b19535b1befb5154 for user 681045154a1704c875e2
2025-04-29 04:18:48,611 - app.core.storage - INFO - Successfully created conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:18:50,667 - app.core.storage - INFO - Stored message 6810451a83857a4a5672 for user 681045154a1704c875e2
2025-04-29 04:18:50,668 - app.core.chat_service - INFO - Stored user message (ID: 6810451a83857a4a5672) for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:18:51,502 - app.core.storage - INFO - Timestamp updated for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:18:51,503 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-29 04:18:51,504 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:18:51,507 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:18:56,451 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:18:56,452 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:18:56,453 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:18:56,454 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:18:56,454 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:18:59,092 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:18:59,093 - app.core.chat_service - INFO - Mistral response successful for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:18:59,580 - app.core.storage - INFO - Stored message 681045236ecceaec6d6f for user ai
2025-04-29 04:19:02,456 - app.core.storage - INFO - Stored 5 sources for message 681045236ecceaec6d6f
2025-04-29 04:19:02,456 - app.core.chat_service - INFO - Stored AI message (ID: 681045236ecceaec6d6f) for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:02,941 - app.core.storage - INFO - Timestamp updated for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:05,419 - app.core.storage - INFO - Stored message 681045295b01316481a6 for user 681045154a1704c875e2
2025-04-29 04:19:05,421 - app.core.chat_service - INFO - Stored user message (ID: 681045295b01316481a6) for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:05,669 - app.core.storage - INFO - Timestamp updated for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:05,670 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:19:05,673 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:19:06,792 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:19:06,794 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:06,795 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:19:06,796 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:19:06,796 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:19:09,285 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:19:09,286 - app.core.chat_service - INFO - Mistral response successful for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:09,642 - app.core.storage - INFO - Stored message 6810452d7b89848b1ced for user ai
2025-04-29 04:19:11,520 - app.core.storage - INFO - Stored 5 sources for message 6810452d7b89848b1ced
2025-04-29 04:19:11,520 - app.core.chat_service - INFO - Stored AI message (ID: 6810452d7b89848b1ced) for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:11,759 - app.core.storage - INFO - Timestamp updated for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:13,602 - app.core.storage - INFO - Stored message 681045317cb6a1bcebdf for user 681045154a1704c875e2
2025-04-29 04:19:13,602 - app.core.chat_service - INFO - Stored user message (ID: 681045317cb6a1bcebdf) for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:13,999 - app.core.storage - INFO - Timestamp updated for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:13,999 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:19:14,003 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:19:15,290 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:19:15,293 - app.core.chat_service - INFO - Retrieved 5 documents for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:15,293 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:19:15,294 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:19:15,294 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:19:16,884 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:19:16,886 - app.core.chat_service - INFO - Mistral response successful for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:17,105 - app.core.storage - INFO - Stored message 681045350b07f87cf762 for user ai
2025-04-29 04:19:18,166 - app.core.storage - INFO - Stored 5 sources for message 681045350b07f87cf762
2025-04-29 04:19:18,167 - app.core.chat_service - INFO - Stored AI message (ID: 681045350b07f87cf762) for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:19:18,399 - app.core.storage - INFO - Timestamp updated for conversation 90fa621ffcd84a29b19535b1befb5154
2025-04-29 04:21:49,748 - app.api.endpoints.auth - INFO - User registered successfully: test12246@example.com, ID: 681045cd86a1717bccbf
2025-04-29 04:21:50,402 - app.api.endpoints.auth - INFO - Password verified for user: test12246@example.com, User ID: 681045cd86a1717bccbf
2025-04-29 04:21:50,587 - app.api.endpoints.auth - INFO - JWT created successfully for user: test12246@example.com
2025-04-29 04:21:51,714 - app.core.storage - INFO - Attempting to create conversation f82452b392464f10b1643cf44eb20d24 for user 681045cd86a1717bccbf
2025-04-29 04:21:51,930 - app.core.storage - INFO - Successfully created conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:21:53,280 - app.core.storage - INFO - Stored message 681045d1384649641992 for user 681045cd86a1717bccbf
2025-04-29 04:21:53,281 - app.core.chat_service - INFO - Stored user message (ID: 681045d1384649641992) for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:21:53,554 - app.core.storage - INFO - Timestamp updated for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:21:53,555 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:21:53,570 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:21:54,767 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:21:54,769 - app.core.chat_service - INFO - Retrieved 5 documents for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:21:54,770 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:21:54,770 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:21:54,771 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:21:59,028 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:21:59,028 - app.core.chat_service - INFO - Mistral response successful for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:21:59,276 - app.core.storage - INFO - Stored message 681045d735c3edc185ad for user ai
2025-04-29 04:22:00,536 - app.core.storage - INFO - Stored 5 sources for message 681045d735c3edc185ad
2025-04-29 04:22:00,536 - app.core.chat_service - INFO - Stored AI message (ID: 681045d735c3edc185ad) for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:00,848 - app.core.storage - INFO - Timestamp updated for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:02,739 - app.core.storage - INFO - Stored message 681045da9e262b452de0 for user 681045cd86a1717bccbf
2025-04-29 04:22:02,739 - app.core.chat_service - INFO - Stored user message (ID: 681045da9e262b452de0) for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:02,963 - app.core.storage - INFO - Timestamp updated for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:02,963 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:22:02,966 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:22:04,131 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:22:04,136 - app.core.chat_service - INFO - Retrieved 5 documents for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:04,138 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:22:04,140 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:22:04,141 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:22:05,685 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:22:05,686 - app.core.chat_service - INFO - Mistral response successful for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:05,959 - app.core.storage - INFO - Stored message 681045ddcd56b8457c57 for user ai
2025-04-29 04:22:07,641 - app.core.storage - INFO - Stored 5 sources for message 681045ddcd56b8457c57
2025-04-29 04:22:07,642 - app.core.chat_service - INFO - Stored AI message (ID: 681045ddcd56b8457c57) for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:07,960 - app.core.storage - INFO - Timestamp updated for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:09,736 - app.core.storage - INFO - Stored message 681045e1a753a1515c55 for user 681045cd86a1717bccbf
2025-04-29 04:22:09,737 - app.core.chat_service - INFO - Stored user message (ID: 681045e1a753a1515c55) for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:09,939 - app.core.storage - INFO - Timestamp updated for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:09,940 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:22:09,943 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:22:10,935 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:22:10,938 - app.core.chat_service - INFO - Retrieved 5 documents for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:10,939 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:22:10,940 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:22:10,940 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:22:12,509 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:22:12,510 - app.core.chat_service - INFO - Mistral response successful for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:12,710 - app.core.storage - INFO - Stored message 681045e4a09f2c81d84f for user ai
2025-04-29 04:22:13,868 - app.core.storage - INFO - Stored 5 sources for message 681045e4a09f2c81d84f
2025-04-29 04:22:13,868 - app.core.chat_service - INFO - Stored AI message (ID: 681045e4a09f2c81d84f) for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:14,098 - app.core.storage - INFO - Timestamp updated for conversation f82452b392464f10b1643cf44eb20d24
2025-04-29 04:22:47,705 - app.main - INFO - Application shutdown: cleaning up resources
2025-04-29 04:23:04,639 - app.main - INFO - Configuring CORS with allowed origins: ['https://maktaba-shamela-ai.vercel.app', 'http://localhost:3000']
2025-04-29 04:23:04,681 - app.main - INFO - Application startup: initializing services and connections
2025-04-29 04:23:04,727 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_1bab97fc01824cc0a3b15c8a36851ec0
2025-04-29 04:23:04,728 - app.core.retrieval - INFO - Initializing retriever with provider: pinecone
2025-04-29 04:23:04,729 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:23:04,732 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:23:07,905 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:23:07,907 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_1bab97fc01824cc0a3b15c8a36851ec0
2025-04-29 04:23:07,907 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:23:07,908 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:23:07,908 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:23:11,300 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:23:11,300 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_1bab97fc01824cc0a3b15c8a36851ec0
2025-04-29 04:23:11,584 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_4ad62c8a13a94f4c90800befdaee3475
2025-04-29 04:23:11,584 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:23:11,586 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:23:12,738 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:23:12,740 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_4ad62c8a13a94f4c90800befdaee3475
2025-04-29 04:23:12,741 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:23:12,742 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:23:12,742 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:23:13,017 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 04:23:13,018 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.32 seconds (calculated)...
2025-04-29 04:23:15,108 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:23:15,109 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_4ad62c8a13a94f4c90800befdaee3475
2025-04-29 04:23:15,408 - app.api.endpoints.chat - INFO - Using temporary anonymous conversation ID: anon_conv_f935499af01b456b9bb418523ae24ed9
2025-04-29 04:23:15,409 - app.core.clients - INFO - Initializing Pinecone client
2025-04-29 04:23:15,411 - app.core.clients - INFO - Getting Pinecone index: shamela
2025-04-29 04:23:16,230 - app.core.retrieval.pinecone - INFO - Successfully processed 5 documents after validation.
2025-04-29 04:23:16,234 - app.core.chat_service - INFO - Retrieved 5 documents for conversation anon_conv_f935499af01b456b9bb418523ae24ed9
2025-04-29 04:23:16,236 - app.core.chat_service - INFO - Context formatted. Number of sources extracted: 5
2025-04-29 04:23:16,236 - app.core.chat_service - INFO - Attempting LLM call...
2025-04-29 04:23:16,238 - app.core.llm_service - INFO - Calling Mistral API (max attempts: 3)
2025-04-29 04:23:16,548 - app.core.llm_service - WARNING - Mistral Response Body (non-200, status 429): {"message":"Requests rate limit exceeded"}
2025-04-29 04:23:16,548 - app.core.llm_service - WARNING - Rate limit (429) hit. Retrying in 1.98 seconds (calculated)...
2025-04-29 04:23:22,235 - app.core.llm_service - INFO - Mistral API call successful
2025-04-29 04:23:22,235 - app.core.chat_service - INFO - Mistral response successful for conversation anon_conv_f935499af01b456b9bb418523ae24ed9
